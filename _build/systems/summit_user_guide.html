<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Summit User Guide &mdash; OLCF User Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_style.css?v=678fb11e" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_core.css?v=f5b60a78" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/needstable.css?v=5e1b6797" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_links.css?v=2150a916" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_toggle.css?v=5c6620df" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/modern.css?v=803738c0" />
      <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme_overrides.css?v=b034643a" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://docs.olcf.ornl.govsystems/summit_user_guide.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/design-tabs.js?v=36754332"></script>
        <script src="../_static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
        <script src="../_static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
        <script src="../_static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
        <script src="../_static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
        <script src="../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=dca66431"></script>
        <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
        <script src="../_static/activate_datatables.js?v=e38ccb97"></script>
        <script src="../_static/js/custom.js?v=f5206ae7"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Citadel User Guide" href="citadel_user_guide.html" />
    <link rel="prev" title="Frontier User Guide" href="frontier_user_guide.html" />

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #efefef" >

          
          
          <a href="../index.html">
            
              <img src="../_static/olcf_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../support/index.html">Contact &amp; Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../support/index.html#olcf-user-assistance-center">OLCF User Assistance Center</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support/index.html#authentication-support">Authentication Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support/index.html#olcf-office-hours">OLCF Office Hours</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support/index.html#communication-to-users">Communication to Users</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../accounts/index.html">Accounts and Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../accounts/accounts_and_projects.html">Request a New Allocation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../accounts/accounts_and_projects.html#what-are-the-differences-between-project-types">What are the differences between project types?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/accounts_and_projects.html#what-happens-after-a-project-request-is-approved">What happens after a project request is approved?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/accounts_and_projects.html#guidance-on-frontier-allocation-requests">Guidance on Frontier Allocation Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../accounts/accounts_and_projects.html#applying-for-a-user-account">Applying for a user account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accounts/accounts_and_projects.html#checking-the-status-of-your-application">Checking the status of your application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accounts/accounts_and_projects.html#get-access-to-additional-projects">Get access to additional projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accounts/frequently_asked_questions.html">Frequently Asked Questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../accounts/frequently_asked_questions.html#how-do-i-apply-for-an-account">How do I apply for an account?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/frequently_asked_questions.html#what-is-the-status-of-my-application">What is the status of my application?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/frequently_asked_questions.html#how-should-i-acknowledge-the-olcf-in-my-publications-and-presentations">How should I acknowledge the OLCF in my publications and presentations?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/frequently_asked_questions.html#what-is-a-subproject">What is a subproject?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/frequently_asked_questions.html#i-no-longer-need-my-account-who-should-i-inform-and-what-should-i-do-with-my-olcf-issued-rsa-securid-token">I no longer need my account. Who should I inform and what should I do with my OLCF issued RSA SecurID token?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/frequently_asked_questions.html#my-securid-token-is-broken-expired-what-should-i-do">My SecurID token is broken/expired. What should I do?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/frequently_asked_questions.html#getting-help">Getting Help</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/frequently_asked_questions.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../accounts/documents_and_forms.html">Documents and Forms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../accounts/documents_and_forms.html#forms-for-requesting-a-project-allocation">Forms for Requesting a Project Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/documents_and_forms.html#forms-for-requesting-an-account">Forms for Requesting an Account</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/documents_and_forms.html#forms-to-request-changes-to-computers-jobs-or-accounts">Forms to Request Changes to Computers, Jobs, or Accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/documents_and_forms.html#report-templates">Report Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/documents_and_forms.html#miscellaneous-forms">Miscellaneous Forms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../accounts/olcf_policy_guide.html">OLCF Policy Guides</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#olcf-acknowledgement">OLCF Acknowledgement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#software-requests">Software Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#special-requests-and-policy-exemptions">Special Requests and Policy Exemptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#computing-policy">Computing Policy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#computer-use">Computer Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#data-use">Data Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#software-use">Software Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#user-accountability">User Accountability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#data-management-policy">Data Management Policy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#data-retention-purge-quotas">Data Retention, Purge, &amp; Quotas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#data-prohibitions-safeguards">Data Prohibitions &amp; Safeguards</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#software">Software</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#security-policy">Security Policy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#scope">Scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#personal-use">Personal Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#accessing-olcf-computational-resources">Accessing OLCF Computational Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#data-management">Data Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#sensitive-data">Sensitive Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#data-transfer">Data Transfer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#incite-allocation-under-utilization-policy">INCITE Allocation Under-utilization Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#project-reporting-policy">Project Reporting Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#non-proprietary-institutional-user-agreement-policy">Non-proprietary Institutional User Agreement Policy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#access">Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#rules-and-regulations">Rules and Regulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#safety-and-health">Safety and Health</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#intent-to-publish">Intent to Publish</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#export-control">Export Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#intellectual-property">Intellectual Property</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#hipaa-itar-project-rules-of-behavior-policy">HIPAA/ITAR Project Rules of Behavior Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounts/olcf_policy_guide.html#user-managed-software-ums-policy">User-Managed Software (UMS) Policy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#purpose">Purpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../accounts/olcf_policy_guide.html#policies">Policies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../accounts/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accounts/index.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../connecting/index.html">Connecting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../connecting/index.html#connecting-for-the-first-time">Connecting for the first time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connecting/index.html#activating-a-new-securid-fob">Activating a new SecurID fob</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connecting/index.html#pins-passcodes-and-tokencodes">PINs, Passcodes, and Tokencodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connecting/index.html#x11-forwarding">X11 Forwarding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connecting/index.html#id2">Systems Available to All Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connecting/index.html#olcf-system-hostnames">OLCF System Hostnames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connecting/index.html#starting-a-tmux-session">Starting a Tmux Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connecting/index.html#checking-system-availability">Checking System Availability</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Systems</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2024_olcf_system_changes.html">2024 Notable System Changes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="2024_olcf_system_changes.html#hpss-decommission-and-kronos-availability">HPSS Decommission and Kronos Availability</a><ul>
<li class="toctree-l4"><a class="reference internal" href="2024_olcf_system_changes.html#late-july-2024-kronos-available">Late July 2024 - Kronos available</a></li>
<li class="toctree-l4"><a class="reference internal" href="2024_olcf_system_changes.html#august-30-2024-hpss-becomes-read-only">August 30, 2024 - HPSS becomes read-only</a></li>
<li class="toctree-l4"><a class="reference internal" href="2024_olcf_system_changes.html#january-31-2025-hpss-decommissioned">January 31, 2025 - HPSS decommissioned</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="2024_olcf_system_changes.html#summit-and-alpine2-decommissions">Summit and Alpine2 Decommissions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="2024_olcf_system_changes.html#november-15-2024-summit-decommissioned">November 15, 2024 - Summit decommissioned</a></li>
<li class="toctree-l4"><a class="reference internal" href="2024_olcf_system_changes.html#november-19-2024-alpine2-read-only">November 19, 2024 - Alpine2 read-only</a></li>
<li class="toctree-l4"><a class="reference internal" href="2024_olcf_system_changes.html#january-31-2025-alpine2-decommissioned">January 31, 2025 - Alpine2 decommissioned</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="frontier_user_guide.html">Frontier User Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#system-overview">System Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#frontier-compute-nodes">Frontier Compute Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#node-types">Node Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#system-interconnect">System Interconnect</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#file-systems">File Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#operating-system">Operating System</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#gpus">GPUs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#connecting">Connecting</a></li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#data-and-storage">Data and Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#transition-from-alpine-to-orion">Transition from Alpine to Orion</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#lfs-setstripe-wrapper">LFS setstripe wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#nfs-filesystem">NFS Filesystem</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#lustre-filesystem">Lustre Filesystem</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#kronos-archival-storage">Kronos Archival Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#nvme">NVMe</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#nvme-usage">NVMe Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#using-globus-to-move-data-to-and-from-orion">Using Globus to Move Data to and from Orion</a></li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#amd-gpus">AMD GPUs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#amd-vs-nvidia-terminology">AMD vs NVIDIA Terminology</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#blocks-workgroups-threads-work-items-grids-wavefronts">Blocks (workgroups), Threads (work items), Grids, Wavefronts</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#the-compute-unit">The Compute Unit</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#hip">HIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#things-to-remember-when-programming-for-amd-gpus">Things To Remember When Programming for AMD GPUs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#programming-environment">Programming Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#environment-modules-lmod">Environment Modules (Lmod)</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#compilers">Compilers</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#mpi">MPI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#compiling">Compiling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id4">Compilers</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id7">MPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#openmp">OpenMP</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#openmp-gpu-offload">OpenMP GPU Offload</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#openacc">OpenACC</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id9">HIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#hip-openmp-cpu-threading">HIP + OpenMP CPU Threading</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#sycl">SYCL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#running-jobs">Running Jobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#login-vs-compute-nodes">Login vs Compute Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#simplified-node-layout">Simplified Node Layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#slurm">Slurm</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#batch-scripts">Batch Scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#interactive-jobs">Interactive Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#common-slurm-options">Common Slurm Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#slurm-environment-variables">Slurm Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#job-states">Job States</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#job-reason-codes">Job Reason Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#scheduling-policy">Scheduling Policy</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#job-dependencies">Job Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#monitoring-and-modifying-batch-jobs">Monitoring and Modifying Batch Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#srun">Srun</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#process-and-thread-mapping-examples">Process and Thread Mapping Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#ensemble-jobs">Ensemble Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#tips-for-launching-at-scale">Tips for Launching at Scale</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#software">Software</a></li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#debugging">Debugging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#linaro-ddt">Linaro DDT</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#gdb">GDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#valgrind4hpc">Valgrind4hpc</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#omnitrace">Omnitrace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#profiling-applications">Profiling Applications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#getting-started-with-the-hpe-performance-analysis-tools-pat">Getting Started with the HPE Performance Analysis Tools (PAT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#getting-started-with-hpctoolkit">Getting Started with HPCToolkit</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#getting-started-with-the-rocm-profiler">Getting Started with the ROCm Profiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#roofline-profiling-with-the-rocm-profiler">Roofline Profiling with the ROCm Profiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#omniperf">Omniperf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#tips-and-tricks">Tips and Tricks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#using-reduced-precision-fp16-and-bf16-datatypes">Using reduced precision (FP16 and BF16 datatypes)</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#enabling-gpu-page-migration">Enabling GPU Page Migration</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#floating-point-fp-atomic-operations-and-coarse-fine-grained-memory-allocations">Floating-Point (FP) Atomic Operations and Coarse/Fine Grained Memory Allocations</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#performance-considerations-for-lds-fp-atomicadd">Performance considerations for LDS FP atomicAdd()</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#library-considerations-with-atomic-operations">Library considerations with atomic operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#system-updates">System Updates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id17">2024-09-03</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id18">2024-08-20</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id19">2024-07-16</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id20">2024-04-17</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id21">2024-03-19</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id22">2024-01-23</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id23">2023-12-05</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id24">2023-10-03</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id25">2023-09-19</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id26">2023-07-18</a></li>
<li class="toctree-l4"><a class="reference internal" href="frontier_user_guide.html#id27">2023-05-09</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frontier_user_guide.html#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Summit User Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#summit-documentation-resources">Summit Documentation Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-overview">System Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#summit-nodes">Summit Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#node-types">Node Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="#system-interconnect">System Interconnect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-systems">File Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operating-system">Operating System</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hardware-threads">Hardware Threads</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gpus">GPUs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#connecting">Connecting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-and-storage">Data and Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#software">Software</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shell-programming-environments">Shell &amp; Programming Environments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#default-shell">Default Shell</a></li>
<li class="toctree-l4"><a class="reference internal" href="#environment-management-with-lmod">Environment Management with Lmod</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#compiling">Compiling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#compilers">Compilers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linking-in-libraries">Linking in Libraries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#running-jobs">Running Jobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#login-launch-and-compute-nodes">Login, Launch, and Compute Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#batch-scripts">Batch Scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interactive-jobs">Interactive Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#common-bsub-options">Common bsub Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="#batch-environment-variables">Batch Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#job-states">Job States</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scheduling-policy">Scheduling Policy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#job-dependencies">Job Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#job-launcher-jsrun">Job Launcher (jsrun)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#launching-a-job-with-jsrun">Launching a Job with jsrun</a></li>
<li class="toctree-l4"><a class="reference internal" href="#jsrun-examples">Jsrun Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-multithreading-in-a-job">Using Multithreading in a Job</a></li>
<li class="toctree-l4"><a class="reference internal" href="#launching-multiple-jsruns">Launching Multiple Jsruns</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cuda-aware-mpi">CUDA-Aware MPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#monitoring-jobs">Monitoring Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interacting-with-jobs">Interacting With Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-lsf-commands">Other LSF Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pbs-torque-moab-to-lsf-translation">PBS/Torque/MOAB-to-LSF Translation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#easy-mode-vs-expert-mode">Easy Mode vs. Expert Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#system-service-core-isolation">System Service Core Isolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#job-accounting-on-summit">Job Accounting on Summit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-notes">Other Notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#debugging">Debugging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#linaro-ddt">Linaro DDT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gdb">GDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="#valgrind">Valgrind</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#optimizing-and-profiling">Optimizing and Profiling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#profiling-gpu-code-with-nvidia-developer-tools">Profiling GPU Code with NVIDIA Developer Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="#score-p">Score-P</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vampir">Vampir</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hpctoolkit">HPCToolkit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvidia-tesla-v100">NVIDIA V100 GPUs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nvidia-v100-sm">NVIDIA V100 SM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hbm2">HBM2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nvidia-nvlink">NVIDIA NVLink</a></li>
<li class="toctree-l4"><a class="reference internal" href="#volta-multi-process-service">Volta Multi-Process Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unified-memory">Unified Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#independent-thread-scheduling">Independent Thread Scheduling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensor-cores">Tensor Cores</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tesla-v100-specifications">Tesla V100 Specifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#burst-buffer">Burst Buffer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nvme-xfs">NVMe (XFS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#current-nvme-usage">Current NVMe Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interactive-jobs-using-the-nvme">Interactive Jobs Using the NVMe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nvme-usage-example">NVMe Usage Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectral-library">Spectral Library</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#known-issues">Known Issues</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#open-issues">Open Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resolved-issues">Resolved Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cuda-10-1-known-issues">CUDA 10.1 Known Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#scalable-protected-infrastructure-spi">Scalable Protected Infrastructure (SPI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#training-system-ascent">Training System (Ascent)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id27">File Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="#obtaining-access-to-ascent">Obtaining Access to Ascent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logging-in-to-ascent">Logging In to Ascent</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#preparing-for-frontier">Preparing For Frontier</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hip">HIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-hip-on-summit">Using HIP on Summit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning-to-program-with-hip">Learning to Program with HIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#previous-frontier-training-events">Previous Frontier Training Events</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="citadel_user_guide.html">Citadel User Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="citadel_user_guide.html#what-is-citadel">What is Citadel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="citadel_user_guide.html#citadel-spi-documentation">Citadel (SPI) Documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="andes_user_guide.html">Andes User Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="andes_user_guide.html#system-overview">System Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#compute-nodes">Compute nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#login-nodes">Login nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#file-systems">File systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#lfs-setstripe-wrapper">LFS setstripe wrapper</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="andes_user_guide.html#shell-and-programming-environments">Shell and programming environments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#default-shell">Default shell</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#environment-management-with-lmod">Environment management with lmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#installed-software">Installed Software</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="andes_user_guide.html#compiling">Compiling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#available-compilers">Available compilers</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#changing-compilers">Changing compilers</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#compiler-wrappers">Compiler wrappers</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#compiling-threaded-codes">Compiling threaded codes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="andes_user_guide.html#running-jobs">Running Jobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#login-vs-compute-nodes-on-commodity-clusters">Login vs Compute Nodes on Commodity Clusters</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#slurm">Slurm</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#interactive-batch-jobs-on-commodity-clusters">Interactive Batch Jobs on Commodity Clusters</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#common-batch-options-to-slurm">Common Batch Options to Slurm</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#batch-environment-variables">Batch Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#modifying-batch-jobs">Modifying Batch Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#monitoring-batch-jobs">Monitoring Batch Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#job-execution">Job Execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#batch-queues-on-andes">Batch Queues on Andes</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#job-accounting-on-andes">Job Accounting on Andes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="andes_user_guide.html#andes-debugging">Debugging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#linaro-ddt">Linaro DDT</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#gdb">GDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#valgrind">Valgrind</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="andes_user_guide.html#visualization-tools">Visualization tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#paraview">ParaView</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#visit">VisIt</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#remote-visualization-using-vnc-non-gpu">Remote Visualization using VNC (non-GPU)</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#remote-visualization-using-vnc-gpu-nodes">Remote Visualization using VNC (GPU nodes)</a></li>
<li class="toctree-l4"><a class="reference internal" href="andes_user_guide.html#remote-visualization-using-nice-dcv-gpu-nodes-only">Remote Visualization using Nice DCV (GPU nodes only)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="home_user_guide.html">Home</a><ul>
<li class="toctree-l3"><a class="reference internal" href="home_user_guide.html#system-overview">System Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="home_user_guide.html#access-connecting">Access &amp; Connecting</a></li>
<li class="toctree-l3"><a class="reference internal" href="home_user_guide.html#usage">Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="home_user_guide.html#acceptable-tasks">Acceptable Tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="home_user_guide.html#unacceptable-tasks">Unacceptable Tasks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dtn_user_guide.html">Data Transfer Nodes (DTNs)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dtn_user_guide.html#system-overview">System Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="dtn_user_guide.html#interactive-access">Interactive Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="dtn_user_guide.html#access-from-globus-online">Access From Globus Online</a></li>
<li class="toctree-l3"><a class="reference internal" href="dtn_user_guide.html#batch-queue-slurm">Batch Queue (Slurm)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dtn_user_guide.html#queue-policy">Queue Policy</a></li>
<li class="toctree-l4"><a class="reference internal" href="dtn_user_guide.html#submitting-jobs-to-frontier">Submitting jobs to Frontier</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hpss_user_guide.html">High Performance Storage System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hpss_user_guide.html#system-overview">System Overview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="odo_user_guide.html">Odo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="odo_user_guide.html#system-overview">System Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="odo_user_guide.html#file-systems">File Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="odo_user_guide.html#obtaining-access-to-odo">Obtaining Access to Odo</a></li>
<li class="toctree-l4"><a class="reference internal" href="odo_user_guide.html#logging-in-to-odo">Logging In to Odo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ascent_user_guide.html">Ascent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ascent_user_guide.html#system-overview">System Overview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spock_quick_start_guide.html">Spock Quick-Start Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spock_quick_start_guide.html#system-overview">System Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#spock-compute-nodes">Spock Compute Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#system-interconnect">System Interconnect</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#file-systems">File Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#gpus">GPUs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spock_quick_start_guide.html#connecting">Connecting</a></li>
<li class="toctree-l3"><a class="reference internal" href="spock_quick_start_guide.html#data-and-storage">Data and Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#nfs">NFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#gpfs">GPFS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spock_quick_start_guide.html#programming-environment">Programming Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#environment-modules-lmod">Environment Modules (Lmod)</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#compilers">Compilers</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#mpi">MPI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spock_quick_start_guide.html#compiling">Compiling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#id3">MPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#openmp">OpenMP</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#openmp-gpu-offload">OpenMP GPU Offload</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#hip">HIP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spock_quick_start_guide.html#running-jobs">Running Jobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#slurm-workload-manager">Slurm Workload Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#slurm-compute-node-partitions">Slurm Compute Node Partitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#process-and-thread-mapping">Process and Thread Mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="spock_quick_start_guide.html#nvme-usage">NVMe Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spock_quick_start_guide.html#getting-help">Getting Help</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="crusher_quick_start_guide.html">Crusher Quick-Start Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#system-overview">System Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#crusher-compute-nodes">Crusher Compute Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#system-interconnect">System Interconnect</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#file-systems">File Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#gpus">GPUs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#connecting">Connecting</a></li>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#data-and-storage">Data and Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#nfs-filesystem">NFS Filesystem</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#lustre-filesystem">Lustre Filesystem</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#programming-environment">Programming Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#environment-modules-lmod">Environment Modules (Lmod)</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#compilers">Compilers</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#mpi">MPI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#compiling">Compiling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#id3">MPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#openmp">OpenMP</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#openmp-gpu-offload">OpenMP GPU Offload</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#hip">HIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#hip-openmp-cpu-threading">HIP + OpenMP CPU Threading</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#sycl">SYCL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#running-jobs">Running Jobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#slurm-workload-manager">Slurm Workload Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#slurm-compute-node-partitions">Slurm Compute Node Partitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#process-and-thread-mapping">Process and Thread Mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#nvme-usage">NVMe Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#tips-for-launching-at-scale">Tips for Launching at Scale</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#profiling-applications">Profiling Applications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#getting-started-with-the-hpe-performance-analysis-tools-pat">Getting Started with the HPE Performance Analysis Tools (PAT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#getting-started-with-hpctoolkit">Getting Started with HPCToolkit</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#getting-started-with-the-rocm-profiler">Getting Started with the ROCm Profiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#roofline-profiling-with-the-rocm-profiler">Roofline Profiling with the ROCm Profiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#omnitrace">Omnitrace</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#omniperf">Omniperf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#notable-differences-between-summit-and-crusher">Notable Differences between Summit and Crusher</a><ul>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#using-reduced-precision-fp16-and-bf16-datatypes">Using reduced precision (FP16 and BF16 datatypes)</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#enabling-gpu-page-migration">Enabling GPU Page Migration</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#floating-point-fp-atomic-operations-and-coarse-fine-grained-memory-allocations">Floating-Point (FP) Atomic Operations and Coarse/Fine Grained Memory Allocations</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#performance-considerations-for-lds-fp-atomicadd">Performance considerations for LDS FP atomicAdd()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#system-updates">System Updates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#id6">2024-03-19</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#id7">2024-01-23</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#id8">2023-12-05</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#id9">2023-10-03</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#id10">2023-09-19</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#id11">2023-07-18</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#id12">2023-04-05</a></li>
<li class="toctree-l4"><a class="reference internal" href="crusher_quick_start_guide.html#id13">2022-12-29</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="crusher_quick_start_guide.html#getting-help">Getting Help</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../services_and_applications/index.html">Services and Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../services_and_applications/slate/index.html">Slate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/overview.html">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/overview.html#what-is-slate">What is Slate?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/overview.html#what-is-kubernetes">What is Kubernetes?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/overview.html#what-is-openshift">What is OpenShift?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/getting_started.html">Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/getting_started.html#requesting-a-slate-project-allocation">Requesting A Slate Project Allocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/getting_started.html#logging-in">Logging in</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/getting_started.html#slate-namespaces">Slate Namespaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/getting_started.html#install-the-oc-tool">Install the OC tool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/getting_started.html#test-login-with-oc-tool">Test login with OC Tool</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/guided_tutorial.html">Guided Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/guided_tutorial.html#creating-your-project">Creating your project</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/guided_tutorial.html#guided-web-gui-tutorial">Guided Web GUI Tutorial</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/guided_tutorial_cli.html">Guided Tutorial: CLI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/guided_tutorial_cli.html#adding-a-pod-to-your-project">Adding a Pod to your Project</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/image_building.html">Image Building</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/image_building.html#build-types">Build Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/image_building.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/image_building.html#logging-into-the-registry-externally">Logging into the registry externally</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/workloads/index.html">Workloads</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/workloads/pod.html">Pods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/workloads/deployment.html">Deployments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/networking/index.html">Networking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/networking/services.html">Services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/networking/nodeport.html">NodePorts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/networking/route.html">Routes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/networking/networkpolicy.html">Network Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/networking/port_forwarding.html">Quick Access from Outside Slate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/storage.html">Persistent Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/storage.html#creating-a-persistent-volume-claim">Creating A Persistent Volume Claim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/storage.html#adding-pvc-to-pod">Adding PVC To Pod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/storage.html#backups">Backups</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/workflows/index.html">Workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/workflows/overview.html">Workflows Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/workflows/openshift_gitops.html">OpenShift GitOps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/workflows/openshift_pipelines.html">OpenShift Pipelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/use_cases/index.html">Application Deployment Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/use_cases/simple_website.html">Build and Deploy Simple Website</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/use_cases/mongodb_service.html">Deploy MongoDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/use_cases/nginx_hello_world.html">Deploy NGINX with Hello World</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/use_cases/gitlab_runner.html">GitLab Runners</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/use_cases/helm_example.html">Deploy Packages with Helm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/use_cases/helm_prerequisite.html">Helm Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/use_cases/minio.html">MinIO Object Store (On an NCCS Filesystem)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/access_olcf_resources/index.html">Access OLCF Resources From Containers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/access_olcf_resources/job_submit.html">Batch Job Submission</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/access_olcf_resources/mount_fs.html">Mount OLCF Filesystems</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/other_resources.html">Schedule Other Slate Resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/other_resources.html#gpus">GPUs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/olcf_provided_applications/index.html">OLCF-Provided Applications on Slate</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/troubleshooting/index.html">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/troubleshooting/fix-writable-directories.html">Fix Container Image Permissions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/troubleshooting/debugging.html">Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/examples.html">YAML Object Quick Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/examples.html#cronjobs">CronJobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/examples.html#deployments-and-stateful-sets">Deployments and Stateful Sets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/examples.html#pods">Pods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/examples.html#roles-and-rolebindings">Roles and Rolebindings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/examples.html#routes-services-and-nodeports">Routes, Services and Nodeports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/slate/examples.html#persistent-volume-claims">Persistent Volume Claims</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/slate/glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../services_and_applications/myolcf/index.html">myOLCF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/myolcf/overview.html">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/overview.html#what-is-myolcf">What is myOLCF?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/overview.html#what-can-it-do">What can it do?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/overview.html#can-i-suggest-a-feature">Can I suggest a feature?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/myolcf/authenticating.html">Authenticating</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/authenticating.html#olcf-moderate-accounts">OLCF Moderate Accounts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/authenticating.html#olcf-open-accounts">OLCF Open Accounts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/myolcf/project_pages/project_pages.html">Project Pages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/project_pages/project_pages.html#project-context">Project Context</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/project_pages/project_pages.html#switching-project-contexts">Switching Project Contexts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/project_pages/project_pages.html#available-pages">Available Pages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/myolcf/account_pages/account_pages.html">Account Pages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/account_pages/account_pages.html#account-context">Account Context</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/myolcf/account_pages/account_pages.html#available-pages">Available Pages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/myolcf/account_pages/processing_membership_requests.html">Processing Project Membership Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../services_and_applications/jupyter/index.html">Jupyter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../services_and_applications/jupyter/overview.html">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/jupyter/overview.html#jupyter-at-olcf">Jupyter at OLCF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/jupyter/overview.html#access">Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/jupyter/overview.html#cpu-vs-gpu-jupyterlab-available-resources">CPU vs. GPU JupyterLab (Available Resources)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/jupyter/overview.html#working-within-lustre-and-nfs-launching-a-notebook">Working within Lustre and NFS (Launching a notebook)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/jupyter/overview.html#conda-environments-and-custom-notebooks">Conda environments and custom notebooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/jupyter/overview.html#manually-stopping-your-jupyterlab-session">Manually stopping your JupyterLab session</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/jupyter/overview.html#things-to-be-aware-of">Things to be aware of</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services_and_applications/jupyter/overview.html#example-jupyter-notebooks">Example Jupyter Notebooks</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">Data Storage and Transfers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#summary-of-storage-areas">Summary of Storage Areas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#notes-on-user-centric-data-storage">Notes on User-Centric Data Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#user-home-directories-nfs">User Home Directories (NFS)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#notes-on-project-centric-data-storage">Notes on Project-Centric Data Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#project-home-directories-nfs">Project Home Directories (NFS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#project-work-areas">Project Work Areas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#project-archive-directories">Project Archive Directories</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#data-policies">Data Policies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#information">Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#special-requests">Special Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#data-retention">Data Retention</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#orion-lustre-hpe-clusterstor-filesystem">Orion Lustre HPE ClusterStor Filesystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#orion-performance-tiers-and-file-striping-policy">Orion Performance Tiers and File Striping Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#i-o-patterns-that-benefit-from-file-striping">I/O Patterns that Benefit from File Striping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#lfs-setstripe-wrapper">LFS setstripe wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#lustre-file-locking-tips">Lustre File Locking Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#darshan-runtime-and-i-o-profiling">Darshan-runtime and I/O Profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#purge">Purge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#alpine2-ibm-spectrum-scale-filesystem">Alpine2 IBM Spectrum Scale Filesystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#alpine2-performance-under-non-ideal-workloads">Alpine2 Performance under non-ideal workloads</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#tips">Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#major-difference-between-lustre-hpe-clusterstor-and-ibm-spectrum-scale">Major difference between Lustre HPE ClusterStor and IBM Spectrum Scale</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#hpss-data-archival-system">HPSS Data Archival System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#kronos-nearline-archival-storage-system">Kronos Nearline Archival Storage System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#access-data-transfer">Access / Data Transfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#directory-structure">Directory Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#project-quotas">Project Quotas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#kronos-and-hpss-comparison">Kronos and HPSS Comparison</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#transferring-data">Transferring Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#data-transferring-data-globus">Globus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#using-globus-to-move-data-between-collections">Using Globus to Move Data Between Collections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#using-globus-from-your-local-workstation">Using Globus From Your Local Workstation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#hsi">HSI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#additional-hsi-documentation">Additional HSI Documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#htar">HTAR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#htar-limitations">HTAR Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/index.html#additional-htar-documentation">Additional HTAR Documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../data/index.html#command-line-terminal-tools">Command-Line/Terminal Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html#burst-buffer-and-spectral-library">Burst Buffer and Spectral Library</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../software/index.html">Software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../software/SWList.html">SWList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/SWList_flat_table.html">SWList_Flat_Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/SWList_less_wide.html">SWList_Less_Wide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/SWList_condensed.html">SWList_condensed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/SWList_expanding.html">SWList_expanding_copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/software-news.html">Software News</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/software-news.html#frontier-updated-modules-for-cpe-23-12-october-16-2024">Frontier: Updated modules for cpe/23.12 (October 16 2024)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/software-news.html#frontier-core-module-october-15-2024">Frontier: Core module (October 15, 2024)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/software-news.html#frontier-system-software-update-july-16-2024">Frontier: System Software Update (July 16, 2024)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/software-news.html#frontier-user-environment-changes-july-9-2024">Frontier: User Environment Changes (July 9, 2024)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/analytics/index.html">ML/DL &amp; Data Analytics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/analytics/ibm-wml-ce.html">IBM Watson Machine Learning CE -&gt; Open CE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/ibm-wml-ce.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/ibm-wml-ce.html#running-distributed-deep-learning-jobs">Running Distributed Deep Learning Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/ibm-wml-ce.html#setting-up-custom-environments">Setting up Custom Environments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/ibm-wml-ce.html#best-distributed-deep-learning-performance">Best Distributed Deep Learning Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/ibm-wml-ce.html#troubleshooting-tips">Troubleshooting Tips</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/analytics/pbdR.html">R and pbdR on Summit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/pbdR.html#loading-r">Loading R</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/pbdR.html#how-to-run-an-r-script">How to Run an R Script</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/pbdR.html#r-hello-world-example">R Hello World Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/pbdR.html#pbdr-hello-world-example">pbdR Hello World Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/pbdR.html#common-r-packages-for-parallelism">Common R Packages for Parallelism</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/pbdR.html#gpu-computing-with-r">GPU Computing with R</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/pbdR.html#more-information">More Information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/analytics/nvidia-rapids.html">NVIDIA RAPIDS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/nvidia-rapids.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/nvidia-rapids.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/nvidia-rapids.html#rapids-on-jupyter">RAPIDS on Jupyter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/nvidia-rapids.html#rapids-on-summit">RAPIDS on Summit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/nvidia-rapids.html#setting-up-custom-environments">Setting up Custom Environments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/nvidia-rapids.html#blazingsql-distributed-execution">BlazingSQL Distributed Execution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/analytics/apache-spark.html">Apache Spark</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/apache-spark.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/analytics/apache-spark.html#getting-started">Getting Started</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/python/index.html">Python on OLCF Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/python/index.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/python/index.html#olcf-python-guides">OLCF Python Guides</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/python/conda_basics.html">Conda Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/python/parallel_h5py.html">Installing mpi4py and h5py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/python/cupy.html">Installing CuPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/python/sbcast_conda.html">Sbcast Conda Environments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/python/jupyter_envs.html">Jupyter Visibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/python/pytorch_summit.html">PyTorch on Summit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/python/pytorch_frontier.html">PyTorch on Frontier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/python/index.html#module-usage">Module Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/python/index.html#base-environment">Base Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/python/index.html#custom-environments">Custom Environments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/python/index.html#how-to-run">How to Run</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/python/index.html#summit">Summit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/python/index.html#frontier-andes">Frontier / Andes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/python/index.html#best-practices">Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/python/index.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/profiling/index.html">Profiling Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/profiling/Scorep.html">Score-P</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Scorep.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Scorep.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Scorep.html#instrumentation">Instrumentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Scorep.html#measurement">Measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Scorep.html#profiling">Profiling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Scorep.html#tracing">Tracing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Scorep.html#manual-instrumentation">Manual Instrumentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Scorep.html#score-p-demo-video">Score-P Demo Video</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/profiling/TAU.html">Tuning and Analysis Utilities (TAU)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/TAU.html#run-time-environment-variables">Run-Time Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/TAU.html#compile-time-environment-variables">Compile-Time Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/TAU.html#miniweather-example-application">MiniWeather Example Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/TAU.html#cuda-profiling-tools-interface">CUDA Profiling Tools Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/TAU.html#tracing">Tracing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/TAU.html#selective-instrumentation">Selective Instrumentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/TAU.html#dynamic-phase">Dynamic Phase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/TAU.html#static-phase">Static Phase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/TAU.html#openmp-offload">OpenMP Offload</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/profiling/Vampir.html">Vampir</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Vampir.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Vampir.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Vampir.html#vampir-on-a-login-node">Vampir on a Login Node</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Vampir.html#vampir-using-vampirserver">Vampir Using VampirServer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Vampir.html#vampir-tunneling-to-vampirserver">Vampir Tunneling to VampirServer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/profiling/Vampir.html#vampir-gui-demo">Vampir GUI Demo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/UMS/index.html">User-Managed Software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/UMS/index.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/UMS/index.html#currently-available-user-managed-software">Currently Available User-Managed Software</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/UMS/index.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/UMS/index.html#policies">Policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/UMS/index.html#writing-ums-modulefiles">Writing UMS Modulefiles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/workflows/index.html">Workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/workflows/index.html#running-workflows-on-olcf-resources">Running Workflows on OLCF Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/workflows/index.html#workflow-systems">Workflow Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/workflows/entk.html">Ensemble Toolkit (EnTK)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/workflows/fireworks.html">FireWorks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/workflows/mlflow.html">MLflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/workflows/parsl.html">Parsl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/workflows/pmake.html">pmake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/workflows/swift_t.html">Swift/T</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/workflows/libensemble.html">libEnsemble</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/e4s.html">E4S Software Stack</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/e4s.html#summit">Summit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/e4s.html#access-via-modulefiles">Access via modulefiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/e4s.html#e4s-21-08-packages">E4S 21.08 Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/e4s.html#e4s-21-05-packages">E4S 21.05 Packages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/e4s.html#spock">Spock</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/e4s.html#id1">Access via modulefiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/e4s.html#id2">E4S 21.08 Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/e4s.html#id3">E4S 21.05 Packages</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/spack_environments.html">Spack Environments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/spack_environments.html#purpose">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/spack_environments.html#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/spack_environments.html#add-dependencies-to-the-environment">Add Dependencies to the environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/spack_environments.html#adding-olcf-modulefiles-as-external-packages">Adding OLCF Modulefiles as External Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/spack_environments.html#adding-user-defined-dependencies-to-the-environment">Adding User-Defined Dependencies to the environment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/spack_environments.html#installing-the-environment">Installing the Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/spack_environments.html#more-details">More Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/spack_environments.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/viz_tools/index.html">Visualization Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/viz_tools/visit.html">VisIt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/visit.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/visit.html#installing-and-setting-up-visit">Installing and Setting Up Visit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/visit.html#remote-gui-usage">Remote GUI Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/visit.html#command-line-example">Command Line Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/visit.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/visit.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/viz_tools/paraview.html">ParaView</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/paraview.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/paraview.html#installing-and-setting-up-paraview">Installing and Setting Up ParaView</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/paraview.html#remote-gui-usage">Remote GUI Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/paraview.html#command-line-example">Command Line Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/paraview.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/viz_tools/paraview.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/containers_on_summit.html">Containers on Summit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/containers_on_summit.html#basic-information">Basic Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/containers_on_summit.html#setup-before-building">Setup before Building</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/containers_on_summit.html#build-and-run-workflow">Build and Run Workflow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_summit.html#building-a-simple-image">Building a Simple Image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_summit.html#using-a-container-registry-to-build-and-save-your-images">Using a Container Registry to Build and Save your Images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_summit.html#running-a-simple-container-in-a-batch-job">Running a Simple Container in a Batch Job</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_summit.html#running-an-mpi-program-with-the-olcf-mpi-base-image">Running an MPI program with the OLCF MPI base image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_summit.html#running-a-single-node-gpu-program-with-the-olcf-mpi-base-image">Running a single node GPU program with the OLCF MPI base image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_summit.html#running-a-cuda-aware-mpi-program-with-the-olcf-mpi-base-image">Running a CUDA-Aware MPI program with the OLCF MPI base image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/containers_on_summit.html#tips-tricks-and-things-to-watch-out-for">Tips, Tricks, and Things to Watch Out For</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/containers_on_frontier.html">Containers on Frontier</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/containers_on_frontier.html#examples-for-building-and-running-containers">Examples for Building and Running Containers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_frontier.html#building-and-running-a-container-image-from-a-base-linux-distribution-for-mpi">Building and running a container image from a base Linux distribution for MPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_frontier.html#pushing-your-apptainer-image-to-an-oci-registry-supporting-oras-e-g-dockerhub">Pushing your Apptainer image to an OCI Registry supporting ORAS (e.g. DockerHub)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_frontier.html#building-an-image-on-top-of-an-existing-image-local-docker-image-oci-artifact">Building an image on top of an existing image (local, docker image, OCI artifact)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/containers_on_frontier.html#olcf-base-images-apptainer-modules">OLCF Base Images &amp; Apptainer Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_frontier.html#base-images">Base Images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_frontier.html#apptainer-modules">Apptainer Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/containers_on_frontier.html#example-workflow">Example Workflow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/containers_on_frontier.html#some-restrictions-and-tips">Some Restrictions and Tips</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/debugging/index.html">Debugging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/debugging/index.html#linaro-forge-ddt">Linaro Forge DDT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../software/debugging/index.html#client-setup-and-usage">Client Setup and Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/debugging/index.html#download">Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/debugging/index.html#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../software/debugging/index.html#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../software/debugging/index.html#gnu-gdb">GNU GDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/debugging/index.html#valgrind">Valgrind</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../training/index.html">Training</a><ul>
<li class="toctree-l2"><a class="reference external" href="https://www.olcf.ornl.gov/for-users/training/training-calendar" target="_blank">OLCF Training Calendar</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/olcf-tutorials" target="_blank">OLCF Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/training_archive.html">OLCF Training Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/olcf_gpu_hackathons.html">OLCF GPU Hackathons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/olcf_gpu_hackathons.html#facultyhack">FacultyHack</a></li>
<li class="toctree-l2"><a class="reference external" href="https://vimeo.com/channels/olcftraining" target="_blank">OLCF Vimeo Channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/index.html#new-user-quick-start">New User Quick Start</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quantum/index.html">Quantum</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quantum/quantum_access.html">Quantum Computing User Program (QCUP) Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_access.html#qcup-priorities">QCUP Priorities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_access.html#project-allocations">Project Allocations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_access.html#what-happens-after-a-project-request-is-approved">What happens after a project request is approved?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_access.html#project-renewals">Project Renewals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_access.html#closeout-and-quarterly-reports">Closeout and Quarterly Reports</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_access.html#user-accounts">User Accounts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_access.html#checking-the-status-of-your-application">Checking the status of your application</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_access.html#accessing-quantum-resources">Accessing Quantum Resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_access.html#ibm-quantum-computing">IBM Quantum Computing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_access.html#quantinuum">Quantinuum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_access.html#rigetti">Rigetti</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_access.html#ionq">IonQ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_access.html#publication-citations">Publication Citations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quantum/quantum_systems/index.html">Quantum Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_systems/ibm_quantum.html">IBM Quantum</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ibm_quantum.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ibm_quantum.html#connecting">Connecting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ibm_quantum.html#running-jobs-queue-policies">Running Jobs &amp; Queue Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ibm_quantum.html#checking-system-availability-capability">Checking System Availability &amp; Capability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ibm_quantum.html#software">Software</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ibm_quantum.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_systems/rigetti.html">Rigetti</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/rigetti.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/rigetti.html#connecting">Connecting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/rigetti.html#running-jobs">Running Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/rigetti.html#allocations-credit-usage">Allocations &amp; Credit Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/rigetti.html#data-storage-policies">Data Storage Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/rigetti.html#software">Software</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/rigetti.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_systems/quantinuum.html">Quantinuum</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/quantinuum.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/quantinuum.html#connecting">Connecting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/quantinuum.html#running-jobs-queue-policies">Running Jobs &amp; Queue Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/quantinuum.html#allocations-credit-usage">Allocations &amp; Credit Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/quantinuum.html#software">Software</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_systems/ionq.html">IonQ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ionq.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ionq.html#ionq-systems">IonQ systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ionq.html#connecting">Connecting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ionq.html#running-jobs-queue-policies">Running Jobs &amp; Queue Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ionq.html#allocations-credit-usage">Allocations &amp; Credit Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ionq.html#checking-system-availability-capability">Checking System Availability &amp; Capability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_systems/ionq.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quantum/quantum_software/index.html">Quantum Software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_software/hybrid_hpc.html">Quantum Software on HPC Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_software/hybrid_hpc.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_software/hybrid_hpc.html#qiskit">Qiskit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_software/hybrid_hpc.html#pyquil-forest-sdk-rigetti">PyQuil/Forest SDK (Rigetti)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_software/hybrid_hpc.html#pennylane">PennyLane</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_software/hybrid_hpc.html#pytket">Pytket</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_software/hybrid_hpc.html#cuda-q">CUDA-Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../quantum/quantum_software/hybrid_hpc.html#batch-jobs">Batch Jobs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quantum/hello_qcup.html">Hello QCUP Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quantum/hello_qcup.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/hello_qcup.html#ibm-quantum">IBM Quantum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/hello_qcup.html#quantinuum">Quantinuum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/hello_qcup.html#ionq">IonQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/hello_qcup.html#rigetti">Rigetti</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quantum/quantum_faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_faq.html#how-do-quantum-computers-differ-from-classical-computers">How do quantum computers differ from classical computers?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_faq.html#what-is-a-qubit">What is a qubit?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_faq.html#how-do-i-access-the-olcf-quantum-computing-resources">How do I access the OLCF quantum computing resources?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_faq.html#what-happens-after-i-apply-for-access-to-qcup">What happens after I apply for access to QCUP?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_faq.html#i-formerly-had-access-to-quantum-resources-but-my-backends-lattices-etc-have-disappeared-what-do-i-do">I formerly had access to quantum resources, but my backends/lattices/etc. have disappeared, what do I do?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum/quantum_faq.html#i-applied-to-a-quantum-computing-resource-via-the-vendor-website-but-dont-have-access-what-do-i-do">I applied to a quantum computing resource via the vendor website, but dont have access; what do I do?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../spi/index.html">Scalable Protected Infrastructure (SPI)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../spi/index.html#what-is-spi">What is SPI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#what-is-citadel">What is Citadel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spi/index.html#new-user-quickstart">New User QuickStart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#notable-differences">Notable Differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spi/index.html#allocations-and-user-accounts">Allocations and User Accounts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#allocations-projects">Allocations (Projects)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spi/index.html#requesting-a-new-allocation-project">Requesting a New Allocation (Project)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#user-accounts">User Accounts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spi/index.html#requesting-a-new-user-account">Requesting a New User Account</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spi/index.html#available-resources">Available Resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#compute"><span class="xref std std-ref">Compute</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#file-systems"><span class="xref std std-ref">File Systems</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#data-transfer"><span class="xref std std-ref">Data Transfer</span></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spi/index.html#ip-whitelisting">IP Whitelisting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#whitelisting-an-ip-or-range">Whitelisting an IP or range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#finding-your-ip">Finding your IP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spi/index.html#citadel">Citadel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#login-nodes">Login Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#connecting">Connecting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#building-software">Building Software</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../spi/index.html#external-repositories">External Repositories</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html#running-batch-jobs">Running Batch Jobs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spi/index.html#spi-file-systems">File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spi/index.html#spi-data-transfer">Data Transfer</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ace_testbed/index.html">Advanced Computing Ecosystem Testbed (ACE)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html">Defiant Quick-Start Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#system-overview">System Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#defiant-compute-nodes">Defiant Compute Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#system-interconnect">System Interconnect</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#file-systems">File Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#gpus">GPUs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#connecting">Connecting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#data-and-storage">Data and Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#nfs-filesystem">NFS Filesystem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#lustre-filesystem-polis">Lustre Filesystem (Polis)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#programming-environment">Programming Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#environment-modules-lmod">Environment Modules (Lmod)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#compilers">Compilers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#mpi">MPI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#compiling">Compiling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#id3">MPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#openmp">OpenMP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#openmp-gpu-offload">OpenMP GPU Offload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#hip">HIP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#running-jobs">Running Jobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#slurm-workload-manager">Slurm Workload Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#slurm-compute-node-partitions">Slurm Compute Node Partitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#process-and-thread-mapping">Process and Thread Mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#nvme-usage">NVMe Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#container-usage">Container Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#setup-before-building">Setup before Building</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#build-and-run-workflow">Build and Run Workflow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#getting-help">Getting Help</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ace_testbed/defiant_quick_start_guide.html#known-issues">Known Issues</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing to these docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#submitting-suggestions">Submitting suggestions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#authoring-content">Authoring content</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#setup-authoring-environment">Setup authoring environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#edit-the-docs">Edit the docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#github-guidelines">GitHub Guidelines</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #efefef" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OLCF User Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Systems</a></li>
      <li class="breadcrumb-item active">Summit User Guide</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/olcf/olcf-user-docs/blob/master/systems/summit_user_guide.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="summit-user-guide">
<span id="id1"></span><h1>Summit User Guide<a class="headerlink" href="#summit-user-guide" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notable changes to Summit for 2024 allocations:</p>
<dl class="simple">
<dt>Alpine Decomissioned (Jan 01, 2024)</dt><dd><p>Summits previous scratch filesystem, Alpine, was decommissioned on January 01, 2024.</p>
</dd>
<dt>New Scratch Filesystem Available (Alpine2)</dt><dd><p>Alpine2, Summits new GPFS scratch filesystem is now available to replace the previous scratch filesystem.  The new filesystem is mounted on Summit, Andes, and the DTNs.  Returning users will need to transfer data onto Apline2 since data on the previous scratch filesystem is no longer available.</p>
</dd>
<dt>Software Updates</dt><dd><p>Summits software has been updated.  Returning users should recompile prior to running.  A list of default software updates can be found on <a class="reference external" href="https://docs.olcf.ornl.gov/software/software-news.html" target="_blank">https://docs.olcf.ornl.gov/software/software-news.html</a> . Please note the previous software stack remains available and can be accessed by loading the DefApps-2023 modulefile. For convenience, a DefApps-2024 is also provide to restore the most recent version of packages.</p>
</dd>
</dl>
</div>
<section id="summit-documentation-resources">
<span id="id2"></span><h2>Summit Documentation Resources<a class="headerlink" href="#summit-documentation-resources" title="Link to this heading"></a></h2>
<p>In addition to this Summit User Guide, there are other sources of
documentation, instruction, and tutorials that could be useful for
Summit users.</p>
<p>The <a class="reference internal" href="../training/training_archive.html#training-archive"><span class="std std-ref">OLCF Training Archive</span></a> provides a list of previous training
events, including multi-day Summit Workshops. Some examples of topics addressed during
these workshops include using Summits NVME burst buffers, CUDA-aware MPI, advanced
networking and MPI, and multiple ways of programming multiple GPUs per node. You can also
find simple tutorials and code examples for some common programming and running tasks in
our <a class="reference external" href="https://github.com/olcf-tutorials" target="_blank">Github tutorial page</a> .</p>
</section>
<section id="system-overview">
<span id="id3"></span><h2>System Overview<a class="headerlink" href="#system-overview" title="Link to this heading"></a></h2>
<p>Summit is an IBM system located at the Oak Ridge Leadership Computing
Facility. With a theoretical peak double-precision performance of
approximately 200 PF, it is one of the most capable systems in the world
for a wide range of traditional computational science applications. It
is also one of the smartest computers in the world for deep learning
applications with a mixed-precision capability in excess of 3 EF.</p>
<section id="summit-nodes">
<span id="id4"></span><h3>Summit Nodes<a class="headerlink" href="#summit-nodes" title="Link to this heading"></a></h3>
<img alt="Summit node architecture diagram" class="align-center" src="../_images/summit_node_architecture.png" />
<p>The basic building block of Summit is the IBM Power System AC922 node.
Each of the approximately 4,600 compute nodes on Summit contains two IBM
POWER9 processors and six <a class="reference internal" href="#nvidia-tesla-v100">NVIDIA Tesla V100</a> accelerators and provides
a theoretical double-precision capability of
approximately 40 TF. Each POWER9 processor is connected via dual NVLINK
bricks, each capable of a 25GB/s transfer rate in each direction.</p>
<p>Most Summit nodes contain 512 GB of DDR4 memory for use by the POWER9
processors, 96 GB of High Bandwidth Memory (HBM2) for use by the accelerators,
and 1.6TB of non-volatile memory that can be used as a burst buffer. A small
number of nodes (54) are configured as high memory nodes. These nodes contain 2TB of
DDR4 memory, 192GB of HBM2, and 6.4TB of non-volatile memory.</p>
<p>The POWER9 processor is built around IBMs SIMD
Multi-Core (SMC). The processor provides 22 SMCs with separate 32kB L1
data and instruction caches. Pairs of SMCs share a 512kB L2 cache and a
10MB L3 cache. SMCs support Simultaneous Multi-Threading (SMT) up to a
level of 4, meaning each physical core supports up to 4 <a class="reference internal" href="#hardware-threads"><span class="std std-ref">Hardware Threads</span></a>.</p>
<p>The POWER9 processors and V100
accelerators are cooled with cold plate technology. The remaining
components are cooled through more traditional methods, although exhaust
is passed through a back-of-cabinet heat exchanger prior to being
released back into the room. Both the cold plate and heat exchanger
operate using medium temperature water which is more cost-effective for
the center to maintain than chilled water used by older systems.</p>
</section>
<section id="node-types">
<h3>Node Types<a class="headerlink" href="#node-types" title="Link to this heading"></a></h3>
<p>On Summit, there are three major types of nodes you will encounter:
Login, Launch, and Compute. While all of these are similar in terms of
hardware (see: <a class="reference internal" href="#summit-nodes"><span class="std std-ref">Summit Nodes</span></a>), they differ considerably in their intended
use.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Node Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Login</p></td>
<td><p>When you connect to Summit, youre placed on a login node. This
is the place to write/edit/compile your code, manage data, submit jobs, etc. You
should never launch parallel jobs from a login node nor should you run threaded
jobs on a login node. Login nodes are shared resources that are in use by many
users simultaneously.</p></td>
</tr>
<tr class="row-odd"><td><p>Launch</p></td>
<td><p>When your batch script (or interactive batch job) starts
running, it will execute on a Launch Node. (If you were a user of Titan,
these are similar in function to service nodes on that system). All commands
within your job script (or the commands you run in an interactive job) will run
on a launch node. Like login nodes, these are shared resources so you should not
run multiprocessor/threaded programs on Launch nodes. It is appropriate to
launch the jsrun command from launch nodes.</p></td>
</tr>
<tr class="row-even"><td><p>Compute</p></td>
<td><p>Most of the nodes on Summit are compute nodes. These are where
your parallel job executes. Theyre accessed via the jsrun command.</p></td>
</tr>
</tbody>
</table>
<p>Although the nodes are logically organized into different types, they
all contain similar hardware. As a result of this homogeneous
architecture there is not a need to cross-compile when building on a
login node. Since login nodes have similar hardware resources as compute
nodes, any tests that are run by your build process (especially by
utilities such as <code class="docutils literal notranslate"><span class="pre">autoconf</span></code> and <code class="docutils literal notranslate"><span class="pre">cmake</span></code>) will have access to the
same type of hardware that is on compute nodes and should not require
intervention that might be required on non-homogeneous systems.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Login nodes have (2) 16-core Power9 CPUs and (4) V100 GPUs.
Compute nodes have (2) 22-core Power9 CPUs and (6) V100 GPUs.</p>
</div>
</section>
<section id="system-interconnect">
<h3>System Interconnect<a class="headerlink" href="#system-interconnect" title="Link to this heading"></a></h3>
<p>Summit nodes are connected to a dual-rail EDR InfiniBand network
providing a node injection bandwidth of 23 GB/s. Nodes are
interconnected in a Non-blocking Fat Tree topology. This interconnect is
a three-level tree implemented by a switch to connect nodes within each
cabinet (first level) along with Director switches (second and third
level) that connect cabinets together.</p>
</section>
<section id="file-systems">
<h3>File Systems<a class="headerlink" href="#file-systems" title="Link to this heading"></a></h3>
<p>Summit is connected to an IBM Spectrum Scale filesystem named Alpine2.
Summit also has access to the center-wide NFS-based filesystem (which provides user and
project home areas) and has access to the centers Nearline archival storage system (Kronos) for user and project archival storage.</p>
</section>
<section id="operating-system">
<h3>Operating System<a class="headerlink" href="#operating-system" title="Link to this heading"></a></h3>
<p>Summit is running Red Hat Enterprise Linux (RHEL) version 8.2.</p>
</section>
<section id="hardware-threads">
<span id="id5"></span><h3>Hardware Threads<a class="headerlink" href="#hardware-threads" title="Link to this heading"></a></h3>
<p>The IBM POWER9 processor supports Hardware Threads. Each of the POWER9s
physical cores has 4 slices. These slices provide Simultaneous Multi
Threading (SMT) support within the core. Three SMT modes are supported:
SMT4, SMT2, and SMT1. In SMT4 mode, each of the slices operates
independently of the other three. This would permit four separate
streams of execution (i.e. OpenMP threads or MPI tasks) on each physical
core. In SMT2 mode, pairs of slices work together to run tasks. Finally,
in SMT1 mode the four slices work together to execute the task/thread
assigned to the physical core. Regardless of the SMT mode used, the four
slices share the physical cores L1 instruction &amp; data caches.
<a class="reference external" href="https://vimeo.com/283756938" target="_blank">https://vimeo.com/283756938</a></p>
</section>
<section id="gpus">
<span id="id6"></span><h3>GPUs<a class="headerlink" href="#gpus" title="Link to this heading"></a></h3>
<p>Each Summit Compute node has 6 NVIDIA V100 GPUs.  The NVIDIA Tesla V100
accelerator has a peak performance of 7.8 TFLOP/s (double-precision) and
contributes to a majority of the computational work performed on Summit. Each
V100 contains 80 streaming multiprocessors (SMs), 16 GB (32 GB on high-memory
nodes) of high-bandwidth memory (HBM2), and a 6 MB L2 cache that is available to
the SMs. The GigaThread Engine is responsible for distributing work among the
SMs and (8) 512-bit memory controllers control access to the 16 GB (32 GB on
high-memory nodes) of HBM2 memory. The V100 uses NVIDIAs NVLink interconnect
to pass data between GPUs as well as from CPU-to-GPU. We provide a more in-depth
look into the <a class="reference internal" href="#nvidia-tesla-v100">NVIDIA Tesla V100</a> later in the Summit Guide.</p>
</section>
</section>
<section id="connecting">
<span id="id7"></span><h2>Connecting<a class="headerlink" href="#connecting" title="Link to this heading"></a></h2>
<p>To connect to Summit, ssh to summit.olcf.ornl.gov. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="n">username</span><span class="nd">@summit</span><span class="o">.</span><span class="n">olcf</span><span class="o">.</span><span class="n">ornl</span><span class="o">.</span><span class="n">gov</span>
</pre></div>
</div>
<p>For more information on connecting to OLCF resources, see <a class="reference internal" href="../connecting/index.html#connecting-to-olcf"><span class="std std-ref">Connecting for the first time</span></a>.</p>
</section>
<section id="data-and-storage">
<h2>Data and Storage<a class="headerlink" href="#data-and-storage" title="Link to this heading"></a></h2>
<p>For more information about center-wide file systems and data archiving available
on Summit, please refer to the pages on <a class="reference internal" href="../data/index.html#data-storage-and-transfers"><span class="std std-ref">Data Storage and Transfers</span></a>.</p>
<p>Each compute node on Summit has a 1.6TB<strong>N</strong>on-<strong>V</strong>olatile <strong>Me</strong>mory (NVMe) storage device (high-memory nodes have a 6.4TB NVMe storage device), colloquially known as a Burst Buffer with
theoretical performance peak of 2.1 GB/s for writing and 5.5 GB/s for reading.
The NVMes could be used to reduce the time that applications wait for
I/O.  More information can be found later in the <a class="reference internal" href="#id23">Burst Buffer</a> section.</p>
</section>
<section id="software">
<span id="id8"></span><h2>Software<a class="headerlink" href="#software" title="Link to this heading"></a></h2>
<p>Visualization and analysis tasks should be done on the Andes cluster. There are a
few tools provided for various visualization tasks, as described in the
<a class="reference internal" href="andes_user_guide.html#andes-viz-tools"><span class="std std-ref">Visualization tools</span></a> section of the <a class="reference internal" href="andes_user_guide.html#andes-user-guide"><span class="std std-ref">Andes User Guide</span></a>.</p>
<p>For a full list of software available at the OLCF, please see the
Software section (coming soon).</p>
</section>
<section id="shell-programming-environments">
<span id="id9"></span><h2>Shell &amp; Programming Environments<a class="headerlink" href="#shell-programming-environments" title="Link to this heading"></a></h2>
<p>OLCF systems provide many software packages and scientific
libraries pre-installed at the system-level for users to take advantage
of. To facilitate this, environment management tools are employed to
handle necessary changes to the shell. The sections below provide
information about using these management tools on Summit.</p>
<section id="default-shell">
<h3>Default Shell<a class="headerlink" href="#default-shell" title="Link to this heading"></a></h3>
<p>A users default shell is selected when completing the User Account
Request form. The chosen shell is set across all OLCF resources, and is
the shell interface a user will be presented with upon login to any OLCF
system. Currently, supported shells include:</p>
<ul class="simple">
<li><p>bash</p></li>
<li><p>tcsh</p></li>
<li><p>csh</p></li>
<li><p>ksh</p></li>
</ul>
<p>If you would like to have your default shell changed, please contact the
<a class="reference external" href="https://www.olcf.ornl.gov/for-users/user-assistance/" target="_blank">OLCF User Assistance Center</a> at
<a class="reference external" href="mailto:help&#37;&#52;&#48;nccs&#46;gov" target="_blank">help<span>&#64;</span>nccs<span>&#46;</span>gov</a>.</p>
</section>
<section id="environment-management-with-lmod">
<span id="id10"></span><h3>Environment Management with Lmod<a class="headerlink" href="#environment-management-with-lmod" title="Link to this heading"></a></h3>
<p>Environment modules are provided through <a class="reference external" href="https://lmod.readthedocs.io/en/latest/" target="_blank">Lmod</a>, a Lua-based module system for
dynamically altering shell environments. By managing changes to the shells
environment variables (such as <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code>, and
<code class="docutils literal notranslate"><span class="pre">PKG_CONFIG_PATH</span></code>), Lmod allows you to alter the software available in your
shell environment without the risk of creating package and version combinations
that cannot coexist in a single environment.</p>
<p>Lmod is a recursive environment module system, meaning it is aware of module
compatibility and actively alters the environment to protect against conflicts.
Messages to stderr are issued upon Lmod implicitly altering the environment.
Environment modules are structured hierarchically by compiler family such that
packages built with a given compiler will only be accessible if the compiler
family is first present in the environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lmod can interpret both Lua modulefiles and legacy Tcl
modulefiles. However, long and logic-heavy Tcl modulefiles may require
porting to Lua.</p>
</div>
<section id="general-usage">
<h4>General Usage<a class="headerlink" href="#general-usage" title="Link to this heading"></a></h4>
<p>Typical use of Lmod is very similar to that of interacting with
modulefiles on other OLCF systems. The interface to Lmod is provided by
the <code class="docutils literal notranslate"><span class="pre">module</span></code> command:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>module -t list</p></td>
<td><p>Shows a terse list of the currently loaded modules.</p></td>
</tr>
<tr class="row-odd"><td><p>module avail</p></td>
<td><p>Shows a table of the currently available modules</p></td>
</tr>
<tr class="row-even"><td><p>module help &lt;modulename&gt;</p></td>
<td><p>Shows help information about &lt;modulename&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>module show &lt;modulename&gt;</p></td>
<td><p>Shows the environment changes made by the &lt;modulename&gt; modulefile</p></td>
</tr>
<tr class="row-even"><td><p>module spider &lt;string&gt;</p></td>
<td><p>Searches all possible modules according to &lt;string&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>module load &lt;modulename&gt; []</p></td>
<td><p>Loads the given &lt;modulename&gt;(s) into the current environment</p></td>
</tr>
<tr class="row-even"><td><p>module use &lt;path&gt;</p></td>
<td><p>Adds &lt;path&gt; to the modulefile search cache and <code class="docutils literal notranslate"><span class="pre">MODULESPATH</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>module unuse &lt;path&gt;</p></td>
<td><p>Removes &lt;path&gt; from the modulefile search cache and <code class="docutils literal notranslate"><span class="pre">MODULESPATH</span></code></p></td>
</tr>
<tr class="row-even"><td><p>module purge</p></td>
<td><p>Unloads all modules</p></td>
</tr>
<tr class="row-odd"><td><p>module reset</p></td>
<td><p>Resets loaded modules to system defaults</p></td>
</tr>
<tr class="row-even"><td><p>module update</p></td>
<td><p>Reloads all currently loaded modules</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Modules are changed recursively. Some commands, such as
<code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">swap</span></code>, are available to maintain compatibility with scripts
using Tcl Environment Modules, but are not necessary since Lmod
recursively processes loaded modules and automatically resolves
conflicts.</p>
</div>
</section>
<section id="searching-for-modules">
<h4>Searching for modules<a class="headerlink" href="#searching-for-modules" title="Link to this heading"></a></h4>
<p>Modules with dependencies are only available when the underlying dependencies,
such as compiler families, are loaded. Thus, <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">avail</span></code> will only display
modules that are compatible with the current state of the environment. To search
the entire hierarchy across all possible dependencies, the <code class="docutils literal notranslate"><span class="pre">spider</span></code>
sub-command can be used as summarized in the following table.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>module spider</p></td>
<td><p>Shows the entire possible graph of modules</p></td>
</tr>
<tr class="row-odd"><td><p>module spider &lt;modulename&gt;</p></td>
<td><p>Searches for modules named &lt;modulename&gt; in the graph of possible modules</p></td>
</tr>
<tr class="row-even"><td><p>module spider &lt;modulename&gt;/&lt;version&gt;</p></td>
<td><p>Searches for a specific version of &lt;modulename&gt; in the graph of possible modules</p></td>
</tr>
<tr class="row-odd"><td><p>module spider &lt;string&gt;</p></td>
<td><p>Searches for modulefiles containing &lt;string&gt;</p></td>
</tr>
</tbody>
</table>
</section>
<section id="defining-custom-module-collections">
<h4>Defining custom module collections<a class="headerlink" href="#defining-custom-module-collections" title="Link to this heading"></a></h4>
<p>Lmod supports caching commonly used collections of environment modules on a
per-user basis in <code class="docutils literal notranslate"><span class="pre">$HOME/.lmod.d</span></code>. To create a collection called NAME from
the currently loaded modules, simply call <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">save</span> <span class="pre">NAME</span></code>. Omitting NAME
will set the users default collection. Saved collections can be recalled and
examined with the commands summarized in the following table.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>module restore NAME</p></td>
<td><p>Recalls a specific saved user collection titled NAME</p></td>
</tr>
<tr class="row-odd"><td><p>module restore</p></td>
<td><p>Recalls the user-defined defaults</p></td>
</tr>
<tr class="row-even"><td><p>module reset</p></td>
<td><p>Resets loaded modules to system defaults</p></td>
</tr>
<tr class="row-odd"><td><p>module restore system</p></td>
<td><p>Recalls the system defaults</p></td>
</tr>
<tr class="row-even"><td><p>module savelist</p></td>
<td><p>Shows the list user-defined saved collections</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should use unique names when creating collections to
specify the application (and possibly branch) you are working on. For
example, <code class="docutils literal notranslate"><span class="pre">app1-development</span></code>, <code class="docutils literal notranslate"><span class="pre">app1-production</span></code>, and
<code class="docutils literal notranslate"><span class="pre">app2-production</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to avoid conflicts between user-defined collections
on multiple compute systems that share a home file system (e.g.
<code class="docutils literal notranslate"><span class="pre">/ccs/home/[userid]</span></code>), lmod appends the hostname of each system to the
files saved in in your <code class="docutils literal notranslate"><span class="pre">~/.lmod.d</span></code> directory (using the environment
variable <code class="docutils literal notranslate"><span class="pre">LMOD_SYSTEM_NAME</span></code>). This ensures that only collections
appended with the name of the current system are visible.</p>
</div>
<p>The following screencast shows an example of setting up user-defined
module collections on Summit. <a class="reference external" href="https://vimeo.com/293582400" target="_blank">https://vimeo.com/293582400</a></p>
</section>
</section>
</section>
<section id="compiling">
<span id="id11"></span><h2>Compiling<a class="headerlink" href="#compiling" title="Link to this heading"></a></h2>
<section id="compilers">
<h3>Compilers<a class="headerlink" href="#compilers" title="Link to this heading"></a></h3>
<section id="available-compilers">
<h4>Available Compilers<a class="headerlink" href="#available-compilers" title="Link to this heading"></a></h4>
<p>The following compilers are available on Summit:</p>
<p><strong>XL:</strong> IBM XL Compilers <em>(loaded by default)</em></p>
<p><strong>LLVM:</strong> LLVM compiler infrastructure</p>
<p><strong>PGI:</strong> Portland Group compiler suite</p>
<p><strong>NVHPC:</strong> Nvidia HPC SDK compiler suite</p>
<p><strong>GNU:</strong> GNU Compiler Collection</p>
<p><strong>NVCC</strong>: CUDA C compiler</p>
<p>PGI was bought out by Nvidia and have rebranded their compilers, incorporating
them into the NVHPC compiler suite. There will be no more new releases of the
PGI compilers.</p>
<p>Upon login, the default versions of the XL compiler suite and Spectrum Message
Passing Interface (MPI) are added to each users environment through the modules
system. No changes to the environment are needed to make use of the defaults.</p>
<p>Multiple versions of each compiler family are provided, and can be inspected
using the modules system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>summit$ module -t avail gcc
/sw/summit/spack-envs/base/modules/site/Core:
gcc/7.5.0
gcc/9.1.0
gcc/9.3.0
gcc/10.2.0
gcc/11.1.0
</pre></div>
</div>
</section>
<section id="c-compilation">
<h4>C compilation<a class="headerlink" href="#c-compilation" title="Link to this heading"></a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>type char is unsigned by default</p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Vendor</strong></p></th>
<th class="head"><p><strong>Module</strong></p></th>
<th class="head"><p><strong>Compiler</strong></p></th>
<th class="head"><p><strong>Enable C99</strong></p></th>
<th class="head"><p><strong>Enable C11</strong></p></th>
<th class="head"><p><strong>Default signed char</strong></p></th>
<th class="head"><p><strong>Define macro</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>IBM</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xl</span></code></p></td>
<td><p>xlc xlc_r</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu99</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-qchar=signed</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-WF,-D</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>GNU</strong></p></td>
<td><p>system default</p></td>
<td><p>gcc</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu99</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fsigned-char</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>GNU</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">gcc</span></code></p></td>
<td><p>gcc</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu99</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fsigned-char</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>LLVM</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">llvm</span></code></p></td>
<td><p>clang</p></td>
<td><p>default</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fsigned-char</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>PGI</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pgi</span></code></p></td>
<td><p>pgcc</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-c99</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-c11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-Mschar</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>NVHPC</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nvhpc</span></code></p></td>
<td><p>nvc</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-c99</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-c11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-Mschar</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="c-compilations">
<h4>C++ compilations<a class="headerlink" href="#c-compilations" title="Link to this heading"></a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>type char is unsigned by default</p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Vendor</strong></p></th>
<th class="head"><p><strong>Module</strong></p></th>
<th class="head"><p><strong>Compiler</strong></p></th>
<th class="head"><p><strong>Enable C++11</strong></p></th>
<th class="head"><p><strong>Enable C++14</strong></p></th>
<th class="head"><p><strong>Default signed char</strong></p></th>
<th class="head"><p><strong>Define macro</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>IBM</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xl</span></code></p></td>
<td><p>xlc++, xlc++_r</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu++11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu++1y</span></code> (PARTIAL)*</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-qchar=signed</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-WF,-D</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>GNU</strong></p></td>
<td><p>system default</p></td>
<td><p>g++</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu++11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu++1y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fsigned-char</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>GNU</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">gcc</span></code></p></td>
<td><p>g++</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu++11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu++1y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fsigned-char</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>LLVM</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">llvm</span></code></p></td>
<td><p>clang++</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu++11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=gnu++1y</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fsigned-char</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>PGI</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pgi</span></code></p></td>
<td><p>pgc++</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=c++11</span> <span class="pre">-gnu_extensions</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=c++14</span> <span class="pre">-gnu_extensions</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-Mschar</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>NVHPC</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nvhpc</span></code></p></td>
<td><p>nvc++</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=c++11</span> <span class="pre">-gnu_extensions</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=c++14</span> <span class="pre">-gnu_extensions</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-Mschar</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="fortran-compilation">
<h4>Fortran compilation<a class="headerlink" href="#fortran-compilation" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Vendor</strong></p></th>
<th class="head"><p><strong>Module</strong></p></th>
<th class="head"><p><strong>Compiler</strong></p></th>
<th class="head"><p><strong>Enable F90</strong></p></th>
<th class="head"><p><strong>Enable F2003</strong></p></th>
<th class="head"><p><strong>Enable F2008</strong></p></th>
<th class="head"><p><strong>Define macro</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>IBM</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xl</span></code></p></td>
<td><p>xlf xlf90 xlf95 xlf2003 xlf2008</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-qlanglvl=90std</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-qlanglvl=2003std</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-qlanglvl=2008std</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-WF,-D</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>GNU</strong></p></td>
<td><p>system default</p></td>
<td><p>gfortran</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=f90</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=f2003</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-std=f2008</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>LLVM</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">llvm</span></code></p></td>
<td><p>xlflang</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>PGI</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pgi</span></code></p></td>
<td><p>pgfortran</p></td>
<td><p>use <code class="docutils literal notranslate"><span class="pre">.F90</span></code> source file
suffix</p></td>
<td><p>use <code class="docutils literal notranslate"><span class="pre">.F03</span></code> source file
suffix</p></td>
<td><p>use <code class="docutils literal notranslate"><span class="pre">.F08</span></code> source file
suffix</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>NVHPC</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nvhpc</span></code></p></td>
<td><p>nvfortran</p></td>
<td><p>use <code class="docutils literal notranslate"><span class="pre">.F90</span></code> source file
suffix</p></td>
<td><p>use <code class="docutils literal notranslate"><span class="pre">.F03</span></code> source file
suffix</p></td>
<td><p>use <code class="docutils literal notranslate"><span class="pre">.F08</span></code> source file
suffix</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-D</span></code></p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The xlflang module currently conflicts with the clang
module. This restriction is expected to be lifted in future releases.</p>
</div>
</section>
<section id="mpi">
<h4>MPI<a class="headerlink" href="#mpi" title="Link to this heading"></a></h4>
<p>MPI on Summit is provided by IBM Spectrum MPI. Spectrum MPI provides compiler
wrappers that automatically choose the proper compiler to build your
application.</p>
<p>The following compiler wrappers are available:</p>
<p><strong>C</strong>: <code class="docutils literal notranslate"><span class="pre">mpicc</span></code></p>
<p><strong>C++</strong>: <code class="docutils literal notranslate"><span class="pre">mpic++</span></code>, <code class="docutils literal notranslate"><span class="pre">mpiCC</span></code></p>
<p><strong>Fortran</strong>: <code class="docutils literal notranslate"><span class="pre">mpifort</span></code>, <code class="docutils literal notranslate"><span class="pre">mpif77</span></code>, <code class="docutils literal notranslate"><span class="pre">mpif90</span></code></p>
<p>While these wrappers conveniently abstract away linking of Spectrum MPI, its
sometimes helpful to see exactly whats happening when invoked. The <code class="docutils literal notranslate"><span class="pre">--showme</span></code>
flag will display the full link lines, without actually compiling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>summit$ mpicc --showme
/sw/summit/xl/16.1.1-10/xlC/16.1.1/bin/xlc_r -I/sw/summit/spack-envs/base/opt/linux-rhel8-ppc64le/xl-16.1.1-10/spectrum-mpi-10.4.0.3-20210112-v7qymniwgi6mtxqsjd7p5jxinxzdkhn3/include -pthread -L/sw/summit/spack-envs/base/opt/linux-rhel8-ppc64le/xl-16.1.1-10/spectrum-mpi-10.4.0.3-20210112-v7qymniwgi6mtxqsjd7p5jxinxzdkhn3/lib -lmpiprofilesupport -lmpi_ibm
</pre></div>
</div>
</section>
<section id="openmp">
<h4>OpenMP<a class="headerlink" href="#openmp" title="Link to this heading"></a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using OpenMP with IBM XL compilers, the thread-safe
compiler variant is required; These variants have the same name as the
non-thread-safe compilers with an additional <code class="docutils literal notranslate"><span class="pre">_r</span></code> suffix. e.g. to
compile OpenMPI C code one would use <code class="docutils literal notranslate"><span class="pre">xlc_r</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OpenMP offloading support is still under active development.
Performance and debugging capabilities in particular are expected to
improve as the implementations mature.</p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Vendor</strong></p></th>
<th class="head"><p><strong>3.1 Support</strong></p></th>
<th class="head"><p><strong>Enable OpenMP</strong></p></th>
<th class="head"><p><strong>4.x Support</strong></p></th>
<th class="head"><p><strong>Enable OpenMP 4.x Offload</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>IBM</strong></p></td>
<td><p>FULL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-qsmp=omp</span></code></p></td>
<td><p>FULL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-qsmp=omp</span> <span class="pre">-qoffload</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>GNU</strong></p></td>
<td><p>FULL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fopenmp</span></code></p></td>
<td><p>PARTIAL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fopenmp</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>clang</strong></p></td>
<td><p>FULL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fopenmp</span></code></p></td>
<td><p>PARTIAL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fopenmp</span> <span class="pre">-fopenmp-targets=nvptx64-nvidia-cuda</span> <span class="pre">--cuda-path=${OLCF_CUDA_ROOT}</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>xlflang</strong></p></td>
<td><p>FULL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fopenmp</span></code></p></td>
<td><p>PARTIAL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fopenmp</span> <span class="pre">-fopenmp-targets=nvptx64-nvidia-cuda</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>PGI</strong></p></td>
<td><p>FULL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-mp</span></code></p></td>
<td><p>NONE</p></td>
<td><p>NONE</p></td>
</tr>
<tr class="row-odd"><td><p><strong>NVHPC</strong></p></td>
<td><p>FULL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-mp=gpu</span></code></p></td>
<td><p>NONE</p></td>
<td><p>NONE</p></td>
</tr>
</tbody>
</table>
</section>
<section id="openacc">
<h4>OpenACC<a class="headerlink" href="#openacc" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Vendor</strong></p></th>
<th class="head"><p><strong>Module</strong></p></th>
<th class="head"><p><strong>OpenACC Support</strong></p></th>
<th class="head"><p><strong>Enable OpenACC</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>IBM</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xl</span></code></p></td>
<td><p>NONE</p></td>
<td><p>NONE</p></td>
</tr>
<tr class="row-odd"><td><p><strong>GNU</strong></p></td>
<td><p>system default</p></td>
<td><p>NONE</p></td>
<td><p>NONE</p></td>
</tr>
<tr class="row-even"><td><p><strong>GNU</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">gcc</span></code></p></td>
<td><p>2.5</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-fopenacc</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>LLVM</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">clang</span></code> or
<code class="docutils literal notranslate"><span class="pre">xlflang</span></code></p></td>
<td><p>NONE</p></td>
<td><p>NONE</p></td>
</tr>
<tr class="row-even"><td><p><strong>PGI</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pgi</span></code></p></td>
<td><p>2.5</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-acc,</span> <span class="pre">-ta=nvidia:cc70</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>NVHPC</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nvhpc</span></code></p></td>
<td><p>2.5</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-acc=gpu</span> <span class="pre">-gpu=cc70</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="cuda-compilation">
<h4>CUDA compilation<a class="headerlink" href="#cuda-compilation" title="Link to this heading"></a></h4>
<section id="nvidia">
<h5>NVIDIA<a class="headerlink" href="#nvidia" title="Link to this heading"></a></h5>
<p>CUDA C/C++ support is provided through the <code class="docutils literal notranslate"><span class="pre">cuda</span></code> module or throught the <code class="docutils literal notranslate"><span class="pre">nvhpc</span></code> module.</p>
<p><code class="docutils literal notranslate"><span class="pre">nvcc</span></code> : Primary CUDA C/C++ compiler</p>
<p><strong>Language support</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">-std=c++11</span></code> : provide C++11 support</p>
<p><code class="docutils literal notranslate"><span class="pre">--expt-extended-lambda</span></code> : provide experimental host/device lambda support</p>
<p><code class="docutils literal notranslate"><span class="pre">--expt-relaxed-constexpr</span></code> : provide experimental host/device constexpr support</p>
<p><strong>Compiler support</strong></p>
<p>NVCC currently supports XL, GCC, and PGI C++ backends.</p>
<p><code class="docutils literal notranslate"><span class="pre">--ccbin</span></code> : set to host compiler location</p>
</section>
</section>
<section id="cuda-fortran-compilation">
<h4>CUDA Fortran compilation<a class="headerlink" href="#cuda-fortran-compilation" title="Link to this heading"></a></h4>
<section id="ibm">
<h5>IBM<a class="headerlink" href="#ibm" title="Link to this heading"></a></h5>
<p>The IBM compiler suite is made available through the default loaded xl
module, the cuda module is also required.</p>
<p><code class="docutils literal notranslate"><span class="pre">xlcuf</span></code> : primary Cuda fortran compiler, thread safe</p>
<p><strong>Language support flags</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">-qlanglvl=90std</span></code> : provide Fortran90 support</p>
<p><code class="docutils literal notranslate"><span class="pre">-qlanglvl=95std</span></code> : provide Fortran95 support</p>
<p><code class="docutils literal notranslate"><span class="pre">-qlanglvl=2003std</span></code> : provide Fortran2003 support</p>
<p><code class="docutils literal notranslate"><span class="pre">-qlanglvl=2008std</span></code> : provide Fortran2003 support</p>
</section>
<section id="pgi">
<h5>PGI<a class="headerlink" href="#pgi" title="Link to this heading"></a></h5>
<p>The PGI compiler suite is available through the <code class="docutils literal notranslate"><span class="pre">pgi</span></code> module.</p>
<p><code class="docutils literal notranslate"><span class="pre">pgfortran</span></code> : Primary fortran compiler with CUDA Fortran support</p>
<p><strong>Language support:</strong></p>
<p>Files with <code class="docutils literal notranslate"><span class="pre">.cuf</span></code> suffix automatically compiled with cuda fortran support</p>
<p>Standard fortran suffixed source files determines the standard involved,
see the man page for full details</p>
<p><code class="docutils literal notranslate"><span class="pre">-Mcuda</span></code> : Enable CUDA Fortran on provided source file</p>
</section>
</section>
</section>
<section id="linking-in-libraries">
<h3>Linking in Libraries<a class="headerlink" href="#linking-in-libraries" title="Link to this heading"></a></h3>
<p>OLCF systems provide many software packages and scientific
libraries pre-installed at the system-level for users to take advantage
of. In order to link these libraries into an application, users must
direct the compiler to their location. The <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">show</span></code> command can
be used to determine the location of a particular library. For example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>summit$ module show essl
------------------------------------------------------------------------------------
   /sw/summit/modulefiles/core/essl/6.1.0-1:
------------------------------------------------------------------------------------
whatis(&quot;ESSL 6.1.0-1 &quot;)
prepend_path(&quot;LD_LIBRARY_PATH&quot;,&quot;/sw/summit/essl/6.1.0-1/essl/6.1/lib64&quot;)
append_path(&quot;LD_LIBRARY_PATH&quot;,&quot;/sw/summit/xl/16.1.1-beta4/lib&quot;)
prepend_path(&quot;MANPATH&quot;,&quot;/sw/summit/essl/6.1.0-1/essl/6.1/man&quot;)
setenv(&quot;OLCF_ESSL_ROOT&quot;,&quot;/sw/summit/essl/6.1.0-1/essl/6.1&quot;)
help([[ESSL 6.1.0-1

]])
</pre></div>
</div>
<p>When this module is loaded, the <code class="docutils literal notranslate"><span class="pre">$OLCF_ESSL_ROOT</span></code> environment variable
holds the path to the ESSL installation, which contains the lib64/ and
include/ directories:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>summit$ module load essl
summit$ echo $OLCF_ESSL_ROOT
/sw/summit/essl/6.1.0-1/essl/6.1
summit$ ls $OLCF_ESSL_ROOT
FFTW3  READMES  REDIST.txt  include  iso-swid  ivps  lap  lib64  man  msg
</pre></div>
</div>
<p>The following screencast shows an example of linking two libraries into
a simple program on Summit. <a class="reference external" href="https://vimeo.com/292015868" target="_blank">https://vimeo.com/292015868</a></p>
</section>
</section>
<section id="running-jobs">
<span id="id12"></span><h2>Running Jobs<a class="headerlink" href="#running-jobs" title="Link to this heading"></a></h2>
<p>As is the case on other OLCF systems, computational work on Summit is
performed within jobs. A typical job consists of several components:</p>
<ul class="simple">
<li><p>A submission script</p></li>
<li><p>An executable</p></li>
<li><p>Input files needed by the executable</p></li>
<li><p>Output files created by the executable</p></li>
</ul>
<p>In general, the process for running a job is to:</p>
<ol class="arabic simple">
<li><p>Prepare executables and input files</p></li>
<li><p>Write the batch script</p></li>
<li><p>Submit the batch script</p></li>
<li><p>Monitor the jobs progress before and during execution</p></li>
</ol>
<p>The following sections will provide more information regarding running
jobs on Summit. Summit uses IBM Spectrum Load Sharing Facility (LSF) as
the batch scheduling system.</p>
<section id="login-launch-and-compute-nodes">
<span id="id13"></span><h3>Login, Launch, and Compute Nodes<a class="headerlink" href="#login-launch-and-compute-nodes" title="Link to this heading"></a></h3>
<p>Recall from the <a class="reference internal" href="#system-overview"><span class="std std-ref">System Overview</span></a>
section that Summit has three types of nodes: login, launch, and
compute. When you log into the system, you are placed on a login node.
When your <a class="reference internal" href="#batch-scripts"><span class="std std-ref">Batch Scripts</span></a> or <a class="reference internal" href="#interactive-jobs"><span class="std std-ref">Interactive Jobs</span></a> run,
the resulting shell will run on a launch node. Compute nodes are accessed
via the <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> command. The <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> command should only be issued
from within an LSF job (either batch or interactive) on a launch node.
Otherwise, you will not have any compute nodes allocated and your parallel
job will run on the login node. If this happens, your job will interfere with
(and be interfered with by) other users login node tasks. <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> is covered
in-depth in the <a class="reference internal" href="#id17">Job Launcher (jsrun)</a> section.</p>
<section id="per-user-login-node-resource-limits">
<h4>Per-User Login Node Resource Limits<a class="headerlink" href="#per-user-login-node-resource-limits" title="Link to this heading"></a></h4>
<p>Because the login nodes are resources shared by all Summit users, we utilize
<code class="docutils literal notranslate"><span class="pre">cgroups</span></code> to help better ensure resource availability for all users of the
shared nodes. By default each user is limited to <strong>16 hardware-threads</strong>, <strong>16GB
of memory</strong>, and <strong>1 GPU</strong>.  Please note that limits are set per user and not
individual login sessions. All user processes on a node are contained within a
single cgroup and share the cgroups limits.</p>
<p>If a process from any of a users login sessions reaches 4 hours of CPU-time,
all login sessions will be limited to <strong>.5 hardware-thread</strong>. After 8 hours of
CPU-time, the process is automatically killed. To reset the cgroup limits on a
node to default once the 4 hour CPU-time reduction has been reached, kill the
offending process and start a new login session to the node.</p>
<p>Users can run command <code class="docutils literal notranslate"><span class="pre">check_cgroup_user</span></code> on login nodes to check what processes
were recently killed by cgroup limits.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Login node limits are set per user and not per individual login
session.  All user processes on a node are contained within a single cgroup
and will share the cgroups limits.</p>
</div>
</div></blockquote>
</section>
</section>
<section id="batch-scripts">
<span id="id14"></span><h3>Batch Scripts<a class="headerlink" href="#batch-scripts" title="Link to this heading"></a></h3>
<p>The most common way to interact with the batch system is via batch jobs.
A batch job is simply a shell script with added directives to request
various resources from or provide certain information to the batch
scheduling system. Aside from the lines containing LSF options, the
batch script is simply the series commands needed to set up and run your
job.</p>
<p>To submit a batch script, use the bsub command: <code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">myjob.lsf</span></code></p>
<p>If youve previously used LSF, youre probably used to submitting a job
with input redirection (i.e. <code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">&lt;</span> <span class="pre">myjob.lsf</span></code>). This is not needed
(and will not work) on Summit.</p>
<p>As an example, consider the following batch script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#!/bin/bash</span>
<span class="linenos"> 2</span><span class="c1"># Begin LSF Directives</span>
<span class="linenos"> 3</span><span class="c1">#BSUB -P ABC123</span>
<span class="linenos"> 4</span><span class="c1">#BSUB -W 3:00</span>
<span class="linenos"> 5</span><span class="c1">#BSUB -nnodes 2048</span>
<span class="linenos"> 6</span><span class="c1">#BSUB -alloc_flags gpumps</span>
<span class="linenos"> 7</span><span class="c1">#BSUB -J RunSim123</span>
<span class="linenos"> 8</span><span class="c1">#BSUB -o RunSim123.%J</span>
<span class="linenos"> 9</span><span class="c1">#BSUB -e RunSim123.%J</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="nb">cd</span><span class="w"> </span><span class="nv">$MEMBERWORK</span>/abc123
<span class="linenos">12</span>cp<span class="w"> </span><span class="nv">$PROJWORK</span>/abc123/RunData/Input.123<span class="w"> </span>./Input.123
<span class="linenos">13</span>date
<span class="linenos">14</span>jsrun<span class="w"> </span>-n<span class="w"> </span><span class="m">4092</span><span class="w"> </span>-r<span class="w"> </span><span class="m">2</span><span class="w"> </span>-a<span class="w"> </span><span class="m">12</span><span class="w"> </span>-g<span class="w"> </span><span class="m">3</span><span class="w"> </span>./a.out
<span class="linenos">15</span>cp<span class="w"> </span>my_output_file<span class="w"> </span>/ccs/proj/abc123/Output.123
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For Moderate Enhanced Projects, job scripts need to add -l (ell) to the shell specification, similar to interactive usage.</p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Line #</p></th>
<th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td></td>
<td><p>Shell specification. This script will run under with bash as the shell. Moderate enhanced
projects should add <code class="docutils literal notranslate"><span class="pre">-l</span></code> (ell) to the shell specification.</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td></td>
<td><p>Comment line</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Required</p></td>
<td><p>This job will charge to the ABC123 project</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Required</p></td>
<td><p>Maximum walltime for the job is 3 hours</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Required</p></td>
<td><p>The job will use 2,048 compute nodes</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Optional</p></td>
<td><p>Enable GPU Multi-Process Service</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Optional</p></td>
<td><p>The name of the job is RunSim123</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Optional</p></td>
<td><p>Write standard output to a file named RunSim123.#, where # is the job ID assigned by LSF</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Optional</p></td>
<td><p>Write standard error to a file named RunSim123.#, where # is the job ID assigned by LSF</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Blank line</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Change into one of the scratch filesystems</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Copy input files into place</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Run the <code class="docutils literal notranslate"><span class="pre">date</span></code> command to write a timestamp to the standard output file</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Run the executable on the allocated compute nodes</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Copy output files from the scratch area into a more permanent location</p></td>
</tr>
</tbody>
</table>
</section>
<section id="interactive-jobs">
<span id="id15"></span><h3>Interactive Jobs<a class="headerlink" href="#interactive-jobs" title="Link to this heading"></a></h3>
<p>Most users will find batch jobs to be the easiest way to interact with
the system, since they permit you to hand off a job to the scheduler and
then work on other tasks; however, it is sometimes preferable to run
interactively on the system. This is especially true when developing,
modifying, or debugging a code.</p>
<p>Since all compute resources are managed/scheduled by LSF, it is not possible
to simply log into the system and begin running a parallel code interactively.
You must request the appropriate resources from the system and, if necessary,
wait until they are available. This is done with an interactive batch job.
Interactive batch jobs are submitted via the command line, which
supports the same options that are passed via <code class="docutils literal notranslate"><span class="pre">#BSUB</span></code> parameters in a
batch script. The final options on the command line are what makes the
job interactive batch: <code class="docutils literal notranslate"><span class="pre">-Is</span></code> followed by a shell name. For example,
to request an interactive batch job (with bash as the shell) equivalent
to the sample batch script above, you would use the command:
<code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-W</span> <span class="pre">3:00</span> <span class="pre">-nnodes</span> <span class="pre">2048</span> <span class="pre">-P</span> <span class="pre">ABC123</span> <span class="pre">-Is</span> <span class="pre">/bin/bash</span></code></p>
<p>As pointed out in <a class="reference internal" href="#login-launch-and-compute-nodes"><span class="std std-ref">Login, Launch, and Compute Nodes</span></a>, you will be placed on
a launch (a.k.a. batch) node upon launching an interactive job and as usual
need to use <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> to access the compute node(s):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ bsub -Is -W 0:10 -nnodes 1 -P STF007 $SHELL
Job &lt;779469&gt; is submitted to default queue &lt;batch&gt;.
&lt;&lt;Waiting for dispatch ...&gt;&gt;
&lt;&lt;Starting on batch2&gt;&gt;

$ hostname
batch2

$ jsrun -n1 hostname
a35n03
</pre></div>
</div>
</section>
<section id="common-bsub-options">
<h3>Common bsub Options<a class="headerlink" href="#common-bsub-options" title="Link to this heading"></a></h3>
<p>The table below summarizes options for submitted jobs. Unless otherwise
noted, these can be used from batch scripts or interactive jobs. For
interactive jobs, the options are simply added to the <code class="docutils literal notranslate"><span class="pre">bsub</span></code> command
line. For batch scripts, they can either be added on the <code class="docutils literal notranslate"><span class="pre">bsub</span></code>
command line or they can appear as a <code class="docutils literal notranslate"><span class="pre">#BSUB</span></code> directive in the batch
script. If conflicting options are specified (i.e. different walltime
specified on the command line versus in the script), the option on the
command line takes precedence. Note that LSF has numerous options; only
the most common ones are described here. For more in-depth information
about other LSF options, see the <code class="docutils literal notranslate"><span class="pre">bsub</span></code> man page.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12.0%" />
<col style="width: 25.0%" />
<col style="width: 63.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Example Usage</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-W</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-W</span> <span class="pre">50</span></code></p></td>
<td><p>Requested
maximum walltime. NOTE: The format is [hours:]minutes, not
[[hours:]minutes:]seconds like PBS/Torque/Moab</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-nnodes</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-nnodes</span> <span class="pre">1024</span></code></p></td>
<td><p>Number of nodes
NOTE: There is specified with only one hyphen (i.e. -nnodes, not nnodes)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-P</span> <span class="pre">ABC123</span></code></p></td>
<td><p>Specifies the
project to which the job should be charged</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-o</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-o</span> <span class="pre">jobout.%J</span></code></p></td>
<td><p>File into which
job STDOUT should be directed (%J will be replaced with the job ID number) If
you do not also specify a STDERR file with <code class="docutils literal notranslate"><span class="pre">-e</span></code> or <code class="docutils literal notranslate"><span class="pre">-eo</span></code>, STDERR will also
be written to this file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-e</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-e</span> <span class="pre">jobout.%J</span></code></p></td>
<td><p>File into which
job STDERR should be directed (%J will be replaced with the job ID number)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-J</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-J</span> <span class="pre">MyRun123</span></code></p></td>
<td><p>Specifies the
name of the job (if not present, LSF will use the name of the job script as the
jobs name)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-w</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-w</span> <span class="pre">ended()</span></code></p></td>
<td><p>Place a dependency on the job</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-N</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-N</span></code></p></td>
<td><p>Send a job report via email when the job completes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-XF</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-XF</span></code></p></td>
<td><p>Use X11 forwarding</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-alloc_flags</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-alloc_flags</span> <span class="pre">&quot;gpumps</span> <span class="pre">smt1&quot;</span></code></p></td>
<td><p>Used to request
GPU Multi-Process Service (MPS) and to set SMT (Simultaneous Multithreading)
levels. Only one #BSUB alloc_flags command is recognized so multiple
alloc_flags options need to be enclosed in quotes and space-separated. Setting
gpumps enables NVIDIAs Multi-Process Service, which allows multiple MPI ranks
to simultaneously access a GPU. Setting smt<em>n</em> (where <em>n</em> is 1, 2, or 4) sets
different SMT levels. To run with 2 hardware threads per physical core, youd
use smt2. The default level is smt4.</p></td>
</tr>
</tbody>
</table>
<section id="allocation-wide-options">
<h4>Allocation-wide Options<a class="headerlink" href="#allocation-wide-options" title="Link to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">-alloc_flags</span></code> option to <code class="docutils literal notranslate"><span class="pre">bsub</span></code> is used to set allocation-wide options.
These settings are applied to every compute node in a job. Only one instance of
the flag is accepted, and multiple <code class="docutils literal notranslate"><span class="pre">alloc_flags</span></code> values should be enclosed in
quotes and space-separated. For example, <code class="docutils literal notranslate"><span class="pre">-alloc_flags</span> <span class="pre">&quot;gpumps</span> <span class="pre">smt1</span></code>.</p>
<p>The most common values (<code class="docutils literal notranslate"><span class="pre">smt{1,2,4}</span></code>, <code class="docutils literal notranslate"><span class="pre">gpumps</span></code>, <code class="docutils literal notranslate"><span class="pre">gpudefault</span></code>) are detailed in
the following sections.</p>
<p>This option can also be used to provide additional resources to GPFS service
processes, described in the <a class="reference external" href="#gpfs-system-service-isolation" target="_blank">GPFS System Service Isolation</a> section.</p>
<section id="id16">
<h5>Hardware Threads<a class="headerlink" href="#id16" title="Link to this heading"></a></h5>
<p>Hardware threads are a feature of the POWER9 processor through which
individual physical cores can support multiple execution streams,
essentially looking like one or more virtual cores (similar to
hyperthreading on some Intel<sup></sup> microprocessors). This feature is often
called Simultaneous Multithreading or SMT. The POWER9 processor on
Summit supports SMT levels of 1, 2, or 4, meaning (respectively) each
physical core looks like 1, 2, or 4 virtual cores. The SMT level is
controlled by the <code class="docutils literal notranslate"><span class="pre">-alloc_flags</span></code> option to <code class="docutils literal notranslate"><span class="pre">bsub</span></code>. For example, to
set the SMT level to 2, add the line <code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">alloc_flags</span> <span class="pre">smt2</span></code> to your
batch script or add the option <code class="docutils literal notranslate"><span class="pre">-alloc_flags</span> <span class="pre">smt2</span></code> to you <code class="docutils literal notranslate"><span class="pre">bsub</span></code>
command line.</p>
<p>The default SMT level is 4.</p>
</section>
<section id="mps">
<h5>MPS<a class="headerlink" href="#mps" title="Link to this heading"></a></h5>
<p>The Multi-Process Service (MPS) enables multiple processes (e.g. MPI
ranks) to concurrently share the resources on a single GPU. This is
accomplished by starting an MPS server process, which funnels the work
from multiple CUDA contexts (e.g. from multiple MPI ranks) into a single
CUDA context. In some cases, this can increase performance due to better
utilization of the resources. As mentioned in the <a class="reference external" href="#common-bsub-options" target="_blank">Common bsub Options</a>
section above, MPS can be enabled with the <code class="docutils literal notranslate"><span class="pre">-alloc_flags</span> <span class="pre">&quot;gpumps&quot;</span></code> option to
<code class="docutils literal notranslate"><span class="pre">bsub</span></code>. The following screencast shows an example of how to start an MPS
server process for a job: <a class="reference external" href="https://vimeo.com/292016149" target="_blank">https://vimeo.com/292016149</a></p>
</section>
<section id="gpu-compute-modes">
<h5>GPU Compute Modes<a class="headerlink" href="#gpu-compute-modes" title="Link to this heading"></a></h5>
<p>Summits V100 GPUs are configured to have a default compute mode of
<code class="docutils literal notranslate"><span class="pre">EXCLUSIVE_PROCESS</span></code>. In this mode, the GPU is assigned to only a single
process at a time, and can accept work from multiple process threads
concurrently.</p>
<p>It may be desirable to change the GPUs compute mode to <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code>, which
enables multiple processes and their threads to share and submit work to it
simultaneously. To change the compute mode to <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code>, use the
<code class="docutils literal notranslate"><span class="pre">-alloc_flags</span> <span class="pre">gpudefault</span></code> option.</p>
<p>NVIDIA recommends using the <code class="docutils literal notranslate"><span class="pre">EXCLUSIVE_PROCESS</span></code> compute mode (the default on
Summit) when using the Multi-Process Service, but both MPS and the compute mode
can be changed by providing both values: <code class="docutils literal notranslate"><span class="pre">-alloc_flags</span> <span class="pre">&quot;gpumps</span> <span class="pre">gpudefault&quot;</span></code>.</p>
</section>
</section>
</section>
<section id="batch-environment-variables">
<h3>Batch Environment Variables<a class="headerlink" href="#batch-environment-variables" title="Link to this heading"></a></h3>
<p>LSF provides a number of environment variables in your jobs shell
environment. Many job parameters are stored in environment variables and
can be queried within the batch job. Several of these variables are
summarized in the table below. This is not an all-inclusive list of
variables available to your batch job; in particular only LSF variables
are discussed, not the many standard environment variables that will
be available (such as <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>).</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LSB_JOBID</span></code></p></td>
<td><p>The ID assigned to the job by LSF</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">LS_JOBPID</span></code></p></td>
<td><p>The jobs process ID</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LSB_JOBINDEX</span></code></p></td>
<td><p>The jobs index (if it belongs to a job array)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">LSB_HOSTS</span></code></p></td>
<td><p>The hosts assigned to run the job</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LSB_QUEUE</span></code></p></td>
<td><p>The queue from which the job was dispatched</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">LSB_INTERACTIVE</span></code></p></td>
<td><p>Set to Y for an interactive job; otherwise unset</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LS_SUBCWD</span></code></p></td>
<td><p>The directory from which the job was submitted</p></td>
</tr>
</tbody>
</table>
</section>
<section id="job-states">
<h3>Job States<a class="headerlink" href="#job-states" title="Link to this heading"></a></h3>
<p>A job will progress through a number of states through its lifetime. The
states youre most likely to see are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>State</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PEND</p></td>
<td><p>Job is pending</p></td>
</tr>
<tr class="row-odd"><td><p>RUN</p></td>
<td><p>Job is running</p></td>
</tr>
<tr class="row-even"><td><p>DONE</p></td>
<td><p>Job completed normally (with an exit code of 0)</p></td>
</tr>
<tr class="row-odd"><td><p>EXIT</p></td>
<td><p>Job completed abnormally</p></td>
</tr>
<tr class="row-even"><td><p>PSUSP</p></td>
<td><p>Job was suspended (either by the user or an administrator) while pending</p></td>
</tr>
<tr class="row-odd"><td><p>USUSP</p></td>
<td><p>Job was suspended (either by the user or an administrator) after starting</p></td>
</tr>
<tr class="row-even"><td><p>SSUSP</p></td>
<td><p>Job was suspended by the system after starting</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Jobs may end up in the PSUSP state for a number of reasons. Two common reasons for PSUSP jobs include jobs that have been held by the user or jobs with unresolved dependencies.</p>
<p>Another common reason that jobs end up in a PSUSP state is a job that the system is unable to start. You may notice a job alternating between PEND and RUN states a few times and ultimately ends up as PSUSP. In this case, the system attempted to start the job but failed for some reason. This can be due to a system issue, but we have also seen this casued by improper settings on user <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code> files. (The batch system uses SSH, and the improper settings cause SSH to fail.) If you notice your jobs alternating between PEND and RUN, you might want to check permissions of your <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code> file to make sure it does not have write permission for group or other. (A setting of read/write for the user and no other permissions, which can be set with <code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">600</span> <span class="pre">~/.ssh/config</span></code>, is recommended.)</p>
</div>
</section>
<section id="scheduling-policy">
<h3>Scheduling Policy<a class="headerlink" href="#scheduling-policy" title="Link to this heading"></a></h3>
<p>In a simple batch queue system, jobs run in a first-in, first-out (FIFO)
order. This often does not make effective use of the system. A large job
may be next in line to run. If the system is using a strict FIFO queue,
many processors sit idle while the large job waits to run. <em>Backfilling</em>
would allow smaller, shorter jobs to use those otherwise idle resources,
and with the proper algorithm, the start time of the large job would not
be delayed. While this does make more effective use of the system, it
indirectly encourages the submission of smaller jobs.</p>
<section id="the-doe-leadership-class-job-mandate">
<h4>The DOE Leadership-Class Job Mandate<a class="headerlink" href="#the-doe-leadership-class-job-mandate" title="Link to this heading"></a></h4>
<p>As a DOE Leadership Computing Facility, the OLCF has a mandate that a
large portion of Summits usage come from large, <em>leadership-class</em> (aka
<em>capability</em>) jobs. To ensure the OLCF complies with DOE directives, we
strongly encourage users to run jobs on Summit that are as large as
their code will warrant. To that end, the OLCF implements queue policies
that enable large jobs to run in a timely fashion.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The OLCF implements queue policies that encourage the
submission and timely execution of large, leadership-class jobs on
Summit.</p>
</div>
<p>The basic priority-setting mechanism for jobs waiting in the queue is
the time a job has been waiting relative to other jobs in the queue.</p>
<p>If your jobs require resources outside these queue policies such as higher priority or longer walltimes, please contact <a class="reference external" href="mailto:help&#37;&#52;&#48;olcf&#46;ornl&#46;gov" target="_blank">help<span>&#64;</span>olcf<span>&#46;</span>ornl<span>&#46;</span>gov</a>.</p>
</section>
<section id="job-priority-by-processor-count">
<h4>Job Priority by Processor Count<a class="headerlink" href="#job-priority-by-processor-count" title="Link to this heading"></a></h4>
<p>Jobs are <em>aged</em> according to the jobs requested processor count (older
age equals higher queue priority). Each jobs requested processor count
places it into a specific <em>bin</em>. Each bin has a different aging
parameter, which all jobs in the bin receive.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bin</p></th>
<th class="head"><p>Min Nodes</p></th>
<th class="head"><p>Max Nodes</p></th>
<th class="head"><p>Max Walltime (Hours)</p></th>
<th class="head"><p>Aging Boost (Days)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>2,765</p></td>
<td><p>4,608</p></td>
<td><p>24.0</p></td>
<td><p>15</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>922</p></td>
<td><p>2,764</p></td>
<td><p>24.0</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>92</p></td>
<td><p>921</p></td>
<td><p>12.0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>46</p></td>
<td><p>91</p></td>
<td><p>6.0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>1</p></td>
<td><p>45</p></td>
<td><p>2.0</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
<section id="batch-queue-policy">
<h5><code class="docutils literal notranslate"><span class="pre">batch</span></code> Queue Policy<a class="headerlink" href="#batch-queue-policy" title="Link to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">batch</span></code> queue (and the <code class="docutils literal notranslate"><span class="pre">batch-spi</span></code> queue for Moderate Enhanced security
enclave projects) is the default queue for production work on Summit.  Most
work on Summit is handled through this queue. It enforces the following
policies:</p>
<ul class="simple">
<li><p>Limit of (4) <em>eligible-to-run</em> jobs per user.</p></li>
<li><p>Jobs in excess of the per user limit above will be placed into a
<em>held</em> state, but will change to eligible-to-run at the appropriate
time.</p></li>
<li><p>Users may have only (100) jobs queued in the <code class="docutils literal notranslate"><span class="pre">batch</span></code> queue at any state at any time.
Additional jobs will be rejected at submit time.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <em>eligible-to-run</em> state is not the <em>running</em> state.
Eligible-to-run jobs have not started and are waiting for resources.
Running jobs are actually executing.</p>
</div>
</section>
<section id="batch-hm-queue-policy">
<h5><code class="docutils literal notranslate"><span class="pre">batch-hm</span></code> Queue Policy<a class="headerlink" href="#batch-hm-queue-policy" title="Link to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">batch-hm</span></code> queue (and the <code class="docutils literal notranslate"><span class="pre">batch-hm-spi</span></code> queue for Moderate Enhanced
security enclave projects) is used to access Summits high-memory nodes.  Jobs
may use all 54 nodes. It enforces the following policies:</p>
<ul class="simple">
<li><p>Limit of (4) <em>eligible-to-run</em> jobs per user.</p></li>
<li><p>Jobs in excess of the per user limit above will be placed into a
<em>held</em> state, but will change to eligible-to-run at the appropriate
time.</p></li>
<li><p>Users may have only (25) jobs queued in the <code class="docutils literal notranslate"><span class="pre">batch-hm</span></code> queue at any state at any time.
Additional jobs will be rejected at submit time.</p></li>
</ul>
<p><strong>batch-hm job limits:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Min Nodes</p></th>
<th class="head"><p>Max Nodes</p></th>
<th class="head"><p>Max Walltime (Hours)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>54</p></td>
<td><p>24.0</p></td>
</tr>
</tbody>
</table>
<p>To submit a job to the <code class="docutils literal notranslate"><span class="pre">batch-hm</span></code> queue, add the <code class="docutils literal notranslate"><span class="pre">-q</span> <span class="pre">batch-hm</span></code> option to your
<code class="docutils literal notranslate"><span class="pre">bsub</span></code> command or <code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-q</span> <span class="pre">batch-hm</span></code> to your job script.</p>
</section>
<section id="killable-queue-policy">
<h5><code class="docutils literal notranslate"><span class="pre">killable</span></code> Queue Policy<a class="headerlink" href="#killable-queue-policy" title="Link to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">killable</span></code> queue is a preemptable queue that allows jobs in bins 4 and 5
to request walltimes up to 24 hours. Jobs submitted to the killable queue will
be preemptable once the job reaches the guaranteed runtime limit as shown in the
table below. For example, a job in bin 5 submitted to the killable queue can
request a walltime of 24 hours. The job will be preemptable after two hours of
run time. Similarly, a job in bin 4 will be preemptable after six hours of run
time. Once a job is preempted, the job will be resubmitted by default with the
original limits as requested in the job script and will have the same <code class="docutils literal notranslate"><span class="pre">JOBID</span></code>.</p>
<p><strong>Preemptable job limits:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bin</p></th>
<th class="head"><p>Min Nodes</p></th>
<th class="head"><p>Max Nodes</p></th>
<th class="head"><p>Max Walltime (Hours)</p></th>
<th class="head"><p>Guaranteed Walltime</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>4</p></td>
<td><p>46</p></td>
<td><p>91</p></td>
<td><p>24.0</p></td>
<td><p>6.0 (hours)</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>1</p></td>
<td><p>45</p></td>
<td><p>24.0</p></td>
<td><p>2.0 (hours)</p></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If a job in the <code class="docutils literal notranslate"><span class="pre">killable</span></code> queue does not reach its requested
walltime, it will continue to use allocation time with each automatic
resubmission until it either reaches the requested walltime during a single
continuous run, or is manually killed by the user. Allocations are always
charged based on actual compute time used by all jobs.</p>
</div>
<p>To submit a job to the <code class="docutils literal notranslate"><span class="pre">killable</span></code> queue, add the <code class="docutils literal notranslate"><span class="pre">-q</span> <span class="pre">killable</span></code> option to your
<code class="docutils literal notranslate"><span class="pre">bsub</span></code> command or <code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-q</span> <span class="pre">killable</span></code> to your job script.</p>
<p>To prevent a preempted job from being automatically requeued, the <code class="docutils literal notranslate"><span class="pre">BSUB</span> <span class="pre">-rn</span></code>
flag can be used at submit time.</p>
</section>
<section id="debug-queue-policy">
<h5><code class="docutils literal notranslate"><span class="pre">debug</span></code> Queue Policy<a class="headerlink" href="#debug-queue-policy" title="Link to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">debug</span></code> queue (and the <code class="docutils literal notranslate"><span class="pre">debug-spi</span></code> queue for Moderate Enhanced security
enclave projects) can be used to access Summits compute resources for short
non-production debug tasks.  The queue provides a higher priority compared to
jobs of the same job size bin in production queues.  Production work and job
chaining in the debug queue is prohibited.  Each user is limited to one job in
any state in the debug queue at any one point. Attempts to submit multiple jobs
to the debug queue will be rejected upon job submission.</p>
<p><strong>debug job limits:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Min Nodes</p></th>
<th class="head"><p>Max Nodes</p></th>
<th class="head"><p>Max Walltime (Hours)</p></th>
<th class="head"><p>Max queued any state (per user)</p></th>
<th class="head"><p>Aging Boost (Days)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>unlimited</p></td>
<td><p>2.0</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<p>To submit a job to the <code class="docutils literal notranslate"><span class="pre">debug</span></code> queue, add the <code class="docutils literal notranslate"><span class="pre">-q</span> <span class="pre">debug</span></code> option to your
<code class="docutils literal notranslate"><span class="pre">bsub</span></code> command or <code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-q</span> <span class="pre">debug</span></code> to your job script.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Production work and job chaining in the <code class="docutils literal notranslate"><span class="pre">debug</span></code> queue is prohibited.</p>
</div>
</section>
<section id="spi-kdi-citadel-queue-policy-moderate-enhanced-projects">
<h5>SPI/KDI Citadel Queue Policy (Moderate Enhanced Projects)<a class="headerlink" href="#spi-kdi-citadel-queue-policy-moderate-enhanced-projects" title="Link to this heading"></a></h5>
<p>There are special queue names when submitting jobs to <code class="docutils literal notranslate"><span class="pre">citadel.ccs.ornl.gov</span></code>
(the Moderate Enhanced version of Summit). These queues are: <code class="docutils literal notranslate"><span class="pre">batch-spi</span></code>,
<code class="docutils literal notranslate"><span class="pre">batch-hm-spi</span></code>, and <code class="docutils literal notranslate"><span class="pre">debug-spi</span></code>.  For example, to submit a job to the
<code class="docutils literal notranslate"><span class="pre">batch-spi</span></code> queue on Citadel, you would need <code class="docutils literal notranslate"><span class="pre">-q</span> <span class="pre">batch-spi</span></code> when using the
<code class="docutils literal notranslate"><span class="pre">bsub</span></code> command or <code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-q</span> <span class="pre">batch-spi</span></code> when using a job script.</p>
<p>Except for the enhanced security policies for jobs in these queues, all other
queue properties are the same as the respective Summit queues described above,
such as maximum walltime and number of eligible running jobs.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you submit a job to a normal Summit queue while on Citadel, such as
<code class="docutils literal notranslate"><span class="pre">-q</span> <span class="pre">batch</span></code>, your job will be unable to launch.</p>
</div>
</section>
</section>
<section id="allocation-overuse-policy">
<h4>Allocation Overuse Policy<a class="headerlink" href="#allocation-overuse-policy" title="Link to this heading"></a></h4>
<p>Projects that overrun their allocation are still allowed to run on OLCF
systems, although at a reduced priority. Like the adjustment for the
number of processors requested above, this is an adjustment to the
apparent submit time of the job. However, this adjustment has the effect
of making jobs appear much younger than jobs submitted under projects
that have not exceeded their allocation. In addition to the priority
change, these jobs are also limited in the amount of wall time that can
be used. For example, consider that <code class="docutils literal notranslate"><span class="pre">job1</span></code> is submitted at the same
time as <code class="docutils literal notranslate"><span class="pre">job2</span></code>. The project associated with <code class="docutils literal notranslate"><span class="pre">job1</span></code> is over its
allocation, while the project for <code class="docutils literal notranslate"><span class="pre">job2</span></code> is not. The batch system will
consider <code class="docutils literal notranslate"><span class="pre">job2</span></code> to have been waiting for a longer time than <code class="docutils literal notranslate"><span class="pre">job1</span></code>.
Additionally, projects that are at 125% of their allocated time will be
limited to only 3 running jobs at a time. The adjustment to the
apparent submit time depends upon the percentage that the project is
over its allocation, as shown in the table below:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>% Of Allocation Used</p></th>
<th class="head"><p>Priority Reduction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&lt; 100%</p></td>
<td><p>0 days</p></td>
</tr>
<tr class="row-odd"><td><p>100% to 125%</p></td>
<td><p>30 days</p></td>
</tr>
<tr class="row-even"><td><p>&gt; 125%</p></td>
<td><p>365 days</p></td>
</tr>
</tbody>
</table>
</section>
<section id="system-reservation-policy">
<h4>System Reservation Policy<a class="headerlink" href="#system-reservation-policy" title="Link to this heading"></a></h4>
<p>Projects may request to reserve a set of nodes for a period of time
by contacting <a class="reference external" href="mailto:help&#37;&#52;&#48;olcf&#46;ornl&#46;gov" target="_blank">help<span>&#64;</span>olcf<span>&#46;</span>ornl<span>&#46;</span>gov</a>. If the reservation is granted, the reserved nodes will be
blocked from general use for a given period of time. Only users that
have been authorized to use the reservation can utilize those resources.
To access the reservation, please add -U {reservation name} to bsub or job script.
Since no other users can access the reserved resources, it is crucial
that groups given reservations take care to ensure the utilization on
those resources remains high. To prevent reserved resources from
remaining idle for an extended period of time, reservations are
monitored for inactivity. If activity falls below 50% of the reserved
resources for more than (30) minutes, the reservation will be canceled
and the system will be returned to normal scheduling. A new reservation
must be requested if this occurs.</p>
<p>The requesting projects allocation is charged according to the time window
granted, regardless of actual utilization. For example, an 8-hour, 2,000
node reservation on Summit would be equivalent to using 16,000 Summit
node-hours of a projects allocation.</p>
</section>
</section>
<hr class="docutils" />
<section id="job-dependencies">
<h3>Job Dependencies<a class="headerlink" href="#job-dependencies" title="Link to this heading"></a></h3>
<p>As is the case with many other queuing systems, it is possible to place
dependencies on jobs to prevent them from running until other jobs have
started/completed/etc. Several possible dependency settings are
described in the table below:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27.0%" />
<col style="width: 73.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Expression</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-w</span> <span class="pre">started(12345)</span></code></p></td>
<td><p>The job will not start until
job 12345 starts. Job 12345 is considered to have started if is in any of the
following states: USUSP, SSUSP, DONE, EXIT or RUN (with any pre-execution
command specified by <code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-E</span></code> completed)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-w</span> <span class="pre">done(12345)</span></code> <code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-w</span> <span class="pre">12345</span></code></p></td>
<td><p>The job will not start until
job 12345 has a state of DONE (i.e. completed normally). If a job ID is given
with no condition, <code class="docutils literal notranslate"><span class="pre">done()</span></code> is assumed.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-w</span> <span class="pre">exit(12345)</span></code></p></td>
<td><p>The job will not start until
job 12345 has a state of EXIT (i.e. completed abnormally)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-w</span> <span class="pre">ended(12345)</span></code></p></td>
<td><p>The job will not start until
job 12345 has a state of EXIT or DONE</p></td>
</tr>
</tbody>
</table>
<p>Dependency expressions can be combined with logical operators. For
example, if you want a job held until job 12345 is DONE and job 12346
has started, you can use <code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-w</span> <span class="pre">&quot;done(12345)</span> <span class="pre">&amp;&amp;</span> <span class="pre">started(12346)&quot;</span></code></p>
</section>
<section id="job-launcher-jsrun">
<span id="id17"></span><h3>Job Launcher (jsrun)<a class="headerlink" href="#job-launcher-jsrun" title="Link to this heading"></a></h3>
<p>The default job launcher for Summit is <code class="docutils literal notranslate"><span class="pre">jsrun</span></code>. jsrun was developed by
IBM for the Oak Ridge and Livermore Power systems. The tool will execute
a given program on resources allocated through the LSF batch scheduler;
similar to <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> and <code class="docutils literal notranslate"><span class="pre">aprun</span></code> functionality.</p>
<section id="compute-node-description">
<h4>Compute Node Description<a class="headerlink" href="#compute-node-description" title="Link to this heading"></a></h4>
<p>The following compute node image will be used to discuss jsrun resource
sets and layout.</p>
<a class="reference internal image-reference" href="../_images/summit-node-description-1.png"><img alt="../_images/summit-node-description-1.png" class="align-center" src="../_images/summit-node-description-1.png" style="width: 85%;" /></a>
<ul class="simple">
<li><p>1 node</p></li>
<li><p>2 sockets (grey)</p></li>
<li><p>42 physical cores* (dark blue)</p></li>
<li><p>168 hardware cores (light blue)</p></li>
<li><p>6 GPUs (orange)</p></li>
<li><p>2 Memory blocks (yellow)</p></li>
</ul>
<p><strong>*Core Isolation:</strong> 1 core on each socket has been set aside for
overhead and is not available for allocation through jsrun. The core has
been omitted and is not shown in the above image.</p>
</section>
<section id="resource-sets">
<h4>Resource Sets<a class="headerlink" href="#resource-sets" title="Link to this heading"></a></h4>
<p>While jsrun performs similar job launching functions as aprun and
mpirun, its syntax is very different. A large reason for syntax
differences is the introduction of the <code class="docutils literal notranslate"><span class="pre">resource</span> <span class="pre">set</span></code> concept. Through
resource sets, jsrun can control how a node appears to each job. Users
can, through jsrun command line flags, control which resources on a node
are visible to a job. Resource sets also allow the ability to run
multiple jsruns simultaneously within a node. Under the covers, a
resource set is a cgroup.</p>
<p>At a high level, a resource set allows users to configure what a node
look like to their job.</p>
<p>jsrun will create one or more resource sets within a node. Each resource
set will contain 1 or more cores and 0 or more GPUs. A resource set can
span sockets, but it may not span a node. While a resource set can span
sockets within a node, consideration should be given to the cost of
cross-socket communication. By creating resource sets only within
sockets, costly communication between sockets can be prevented.</p>
<section id="subdividing-a-node-with-resource-sets">
<h5>Subdividing a Node with Resource Sets<a class="headerlink" href="#subdividing-a-node-with-resource-sets" title="Link to this heading"></a></h5>
<p>Resource sets provides the ability to subdivide nodes resources into
smaller groups. The following examples show how a node can be subdivided
and how many resource set could fit on a node.</p>
<img alt="../_images/summit-resource-set-subdivide.png" class="align-center" src="../_images/summit-resource-set-subdivide.png" />
</section>
<section id="multiple-methods-to-creating-resource-sets">
<h5>Multiple Methods to Creating Resource Sets<a class="headerlink" href="#multiple-methods-to-creating-resource-sets" title="Link to this heading"></a></h5>
<p>Resource sets should be created to fit code requirements. The following
examples show multiple ways to create resource sets that allow two MPI
tasks access to a single GPU.</p>
<ol class="arabic">
<li><p>6 resource sets per node: 1 GPU, 2 cores per (Titan)</p>
<img alt="https://www.olcf.ornl.gov/wp-content/uploads/2018/03/RS-summit-example-1GPU-2Cores.png" class="align-center" src="https://www.olcf.ornl.gov/wp-content/uploads/2018/03/RS-summit-example-1GPU-2Cores.png" />
<p>In this case, CPUs can only see single assigned GPU.</p>
</li>
<li><p>2 resource sets per node: 3 GPUs and 6 cores per socket</p>
<img alt="https://www.olcf.ornl.gov/wp-content/uploads/2018/03/RS-summit-example-3GPU-6Cores.png" class="align-center" src="https://www.olcf.ornl.gov/wp-content/uploads/2018/03/RS-summit-example-3GPU-6Cores.png" />
<p>In this case, all 6 CPUs can see 3 GPUs. Code must manage CPU -&gt; GPU
communication. CPUs on socket0 can not access GPUs or Memory on socket1.</p>
</li>
<li><p>Single resource set per node: 6 GPUs, 12 cores</p>
<img alt="https://www.olcf.ornl.gov/wp-content/uploads/2018/03/RS-summit-example-6GPU-12Core.png" class="align-center" src="https://www.olcf.ornl.gov/wp-content/uploads/2018/03/RS-summit-example-6GPU-12Core.png" />
<p>In this case, all 12 CPUs can see all nodes 6 GPUs. Code must manage CPU to
GPU communication. CPUs on socket0 can access GPUs and Memory on socket1.
Code must manage cross socket communication.</p>
</li>
</ol>
</section>
<section id="designing-a-resource-set">
<h5>Designing a Resource Set<a class="headerlink" href="#designing-a-resource-set" title="Link to this heading"></a></h5>
<p>Resource sets allow each jsrun to control how the node appears to a
code. This method is unique to jsrun, and requires thinking of each job
launch differently than aprun or mpirun. While the method is unique, the
method is not complicated and can be reasoned in a few basic steps.</p>
<p>The first step to creating resource sets is understanding how a code would
like the node to appear. For example, the number of tasks/threads per
GPU. Once this is understood, the next step is to simply calculate the
number of resource sets that can fit on a node. From here, the number of
needed nodes can be calculated and passed to the batch job request.</p>
<p>The basic steps to creating resource sets:</p>
<ol class="arabic">
<li><dl>
<dt>Understand how your code expects to interact with the system.</dt><dd><p>How many tasks/threads per GPU?</p>
<p>Does each task expect to see a single GPU? Do multiple tasks expect
to share a GPU? Is the code written to internally manage task to GPU
workload based on the number of available cores and GPUs?</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Create resource sets containing the needed GPU to task binding</dt><dd><p>Based on how your code expects to interact with the system, you can
create resource sets containing the needed GPU and core resources.
If a code expects to utilize one GPU per task, a resource set would
contain one core and one GPU. If a code expects to pass work to a
single GPU from two tasks, a resource set would contain two cores
and one GPU.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Decide on the number of resource sets needed</dt><dd><p>Once you understand tasks, threads, and GPUs in a resource set, you
simply need to decide the number of resource sets needed.</p>
</dd>
</dl>
</li>
</ol>
<p>As on any system, it is useful to keep in mind the hardware underneath every
execution. This is particularly true when laying out resource sets.</p>
</section>
</section>
</section>
<section id="launching-a-job-with-jsrun">
<h3>Launching a Job with jsrun<a class="headerlink" href="#launching-a-job-with-jsrun" title="Link to this heading"></a></h3>
<section id="jsrun-format">
<h4>jsrun Format<a class="headerlink" href="#jsrun-format" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jsrun</span>    <span class="p">[</span> <span class="o">-</span><span class="n">n</span> <span class="c1">#resource sets ]   [tasks, threads, and GPUs within each resource set]   program [ program args ]</span>
</pre></div>
</div>
</section>
<section id="common-jsrun-options">
<h4>Common jsrun Options<a class="headerlink" href="#common-jsrun-options" title="Link to this heading"></a></h4>
<p>Below are common jsrun options. More flags and details can be found in the jsrun
man page. The defaults listed in the table below are the OLCF defaults and take
precedence over those mentioned in the man page.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 5.0%" />
<col style="width: 35.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p>Flags</p></th>
<th class="head" rowspan="2"><p>Description</p></th>
<th class="head" rowspan="2"><p>Default Value</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Long</p></th>
<th class="head"><p>Short</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--nrs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-n</span></code></p></td>
<td><p>Number of resource sets</p></td>
<td><p>All available physical cores</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--tasks_per_rs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-a</span></code></p></td>
<td><p>Number of MPI tasks (ranks) per resource set</p></td>
<td><p>Not set by default, instead
total tasks (-p) set</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--cpu_per_rs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-c</span></code></p></td>
<td><p>Number of CPUs (cores) per resource set.</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--gpu_per_rs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-g</span></code></p></td>
<td><p>Number of GPUs per resource set</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--bind</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-b</span></code></p></td>
<td><p>Binding of tasks within a resource set. Can be none,
rs, or packed:#</p></td>
<td><p>packed:1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--rs_per_host</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-r</span></code></p></td>
<td><p>Number of resource sets per host</p></td>
<td><p>No default</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--latency_priority</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-l</span></code></p></td>
<td><p>Latency Priority. Controls layout
priorities. Can currently be cpu-cpu or gpu-cpu</p></td>
<td><p>gpu-cpu,cpu-mem,cpu-cpu</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--launch_distribution</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-d</span></code></p></td>
<td><p>How tasks are started on resource sets</p></td>
<td><p>packed</p></td>
</tr>
</tbody>
</table>
<p>Its recommended to explicitly specify <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> options and not rely on the
default values. This most often includes <code class="docutils literal notranslate"><span class="pre">--nrs</span></code>,<code class="docutils literal notranslate"><span class="pre">--cpu_per_rs</span></code>,
<code class="docutils literal notranslate"><span class="pre">--gpu_per_rs</span></code>, <code class="docutils literal notranslate"><span class="pre">--tasks_per_rs</span></code>, <code class="docutils literal notranslate"><span class="pre">--bind</span></code>, and <code class="docutils literal notranslate"><span class="pre">--launch_distribution</span></code>.</p>
</section>
</section>
<section id="jsrun-examples">
<h3>Jsrun Examples<a class="headerlink" href="#jsrun-examples" title="Link to this heading"></a></h3>
<p>The below examples were launched in the following 2 node interactive
batch job:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>summit&gt; bsub -nnodes 2 -Pprj123 -W02:00 -Is $SHELL
</pre></div>
</div>
<section id="single-mpi-task-single-gpu-per-rs">
<h4>Single MPI Task, single GPU per RS<a class="headerlink" href="#single-mpi-task-single-gpu-per-rs" title="Link to this heading"></a></h4>
<p>The following example will create 12 resource sets each with 1 MPI task
and 1 GPU. Each MPI task will have access to a single GPU.</p>
<p>Rank 0 will have access to GPU 0 on the first node ( red resource set).
Rank 1 will have access to GPU 1 on the first node ( green resource set).
This pattern will continue until 12 resources sets have been created.</p>
<p>The following jsrun command will request 12 resource sets (<code class="docutils literal notranslate"><span class="pre">-n12</span></code>) 6
per node (<code class="docutils literal notranslate"><span class="pre">-r6</span></code>). Each resource set will contain 1 MPI task (<code class="docutils literal notranslate"><span class="pre">-a1</span></code>),
1 GPU (<code class="docutils literal notranslate"><span class="pre">-g1</span></code>), and 1 core (<code class="docutils literal notranslate"><span class="pre">-c1</span></code>).</p>
<img alt="../_images/summit-jsrun-example-1Core-1GPU.png" class="align-center" src="../_images/summit-jsrun-example-1Core-1GPU.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">jsrun</span> <span class="o">-</span><span class="n">n12</span> <span class="o">-</span><span class="n">r6</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">g1</span> <span class="o">-</span><span class="n">c1</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">0</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">0</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n04</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">1</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">4</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n04</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">2</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">8</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n04</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">3</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">88</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n04</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">4</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">92</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n04</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">5</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">96</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n04</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">5</span>

<span class="n">Rank</span><span class="p">:</span>    <span class="mi">6</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">0</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n03</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">7</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">4</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n03</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">8</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">8</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n03</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">9</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">88</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n03</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">10</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">92</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n03</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">11</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">96</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">h41n03</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
</section>
<section id="multiple-tasks-single-gpu-per-rs">
<h4>Multiple tasks, single GPU per RS<a class="headerlink" href="#multiple-tasks-single-gpu-per-rs" title="Link to this heading"></a></h4>
<p>The following jsrun command will request 12 resource sets (<code class="docutils literal notranslate"><span class="pre">-n12</span></code>).
Each resource set will contain 2 MPI tasks (<code class="docutils literal notranslate"><span class="pre">-a2</span></code>), 1 GPU
(<code class="docutils literal notranslate"><span class="pre">-g1</span></code>), and 2 cores (<code class="docutils literal notranslate"><span class="pre">-c2</span></code>). 2 MPI tasks will have access to a
single GPU. Ranks 0 - 1 will have access to GPU 0 on the first node (
red resource set). Ranks 2 - 3 will have access to GPU 1 on the first
node ( green resource set). This pattern will continue until 12 resource
sets have been created.</p>
<img alt="../_images/summit-jsrun-example-2taskperGPU.png" class="align-center" src="../_images/summit-jsrun-example-2taskperGPU.png" />
<p><strong>Adding cores to the RS:</strong> The <code class="docutils literal notranslate"><span class="pre">-c</span></code> flag should be used to request
the needed cores for tasks and treads. The default -c core count is 1.
In the above example, if -c is not specified both tasks will run on a
single core.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">jsrun</span> <span class="o">-</span><span class="n">n12</span> <span class="o">-</span><span class="n">a2</span> <span class="o">-</span><span class="n">g1</span> <span class="o">-</span><span class="n">c2</span> <span class="o">-</span><span class="n">dpacked</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span> <span class="o">|</span> <span class="n">sort</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">0</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">0</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">1</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">4</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span>

<span class="n">Rank</span><span class="p">:</span>    <span class="mi">2</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">8</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">3</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">12</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">1</span>

<span class="n">Rank</span><span class="p">:</span>    <span class="mi">4</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">16</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">5</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">20</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">2</span>

<span class="n">Rank</span><span class="p">:</span>    <span class="mi">6</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">88</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">7</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">92</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span>

<span class="n">Rank</span><span class="p">:</span>    <span class="mi">8</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">96</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">9</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">100</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">4</span>

<span class="n">Rank</span><span class="p">:</span>   <span class="mi">10</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">104</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">11</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">108</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">5</span>

<span class="n">Rank</span><span class="p">:</span>   <span class="mi">12</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">0</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">13</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">4</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span>

<span class="n">Rank</span><span class="p">:</span>   <span class="mi">14</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">8</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">15</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">12</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">1</span>

<span class="n">Rank</span><span class="p">:</span>   <span class="mi">16</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">16</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">17</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">20</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">2</span>

<span class="n">Rank</span><span class="p">:</span>   <span class="mi">18</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">88</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">19</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">92</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span>

<span class="n">Rank</span><span class="p">:</span>   <span class="mi">20</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">96</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">21</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">100</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">4</span>

<span class="n">Rank</span><span class="p">:</span>   <span class="mi">22</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">104</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">23</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">108</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a01n01</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">5</span>

<span class="n">summit</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="multiple-task-multiple-gpu-per-rs">
<h4>Multiple Task, Multiple GPU per RS<a class="headerlink" href="#multiple-task-multiple-gpu-per-rs" title="Link to this heading"></a></h4>
<p>The following example will create 4 resource sets each with 6 tasks and
3 GPUs. Each set of 6 MPI tasks will have access to 3 GPUs. Ranks 0 - 5
will have access to GPUs 0 - 2 on the first socket of the first node (
red resource set). Ranks 6 - 11 will have access to GPUs 3 - 5 on the
second socket of the first node ( green resource set). This pattern will
continue until 4 resource sets have been created. The following jsrun
command will request 4 resource sets (<code class="docutils literal notranslate"><span class="pre">-n4</span></code>). Each resource set will
contain 6 MPI tasks (<code class="docutils literal notranslate"><span class="pre">-a6</span></code>), 3 GPUs (<code class="docutils literal notranslate"><span class="pre">-g3</span></code>), and 6 cores
(<code class="docutils literal notranslate"><span class="pre">-c6</span></code>).</p>
<img alt="../_images/RS-summit-example-24Tasks-3GPU-6Cores.png" class="align-center" src="../_images/RS-summit-example-24Tasks-3GPU-6Cores.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">jsrun</span> <span class="o">-</span><span class="n">n</span> <span class="mi">4</span> <span class="o">-</span><span class="n">a</span> <span class="mi">6</span> <span class="o">-</span><span class="n">c</span> <span class="mi">6</span> <span class="o">-</span><span class="n">g</span> <span class="mi">3</span> <span class="o">-</span><span class="n">d</span> <span class="n">packed</span> <span class="o">-</span><span class="n">l</span> <span class="n">GPU</span><span class="o">-</span><span class="n">CPU</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">0</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">0</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">1</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">4</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">2</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">8</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">3</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">12</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">4</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">16</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">5</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">20</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>

<span class="n">Rank</span><span class="p">:</span>    <span class="mi">6</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">88</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">7</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">92</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">8</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">96</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>    <span class="mi">9</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">100</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">10</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">104</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">11</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">108</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>

<span class="n">Rank</span><span class="p">:</span>   <span class="mi">12</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">0</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">13</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">4</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">14</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>   <span class="mi">8</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">15</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">12</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">16</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">16</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">17</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">20</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>

<span class="n">Rank</span><span class="p">:</span>   <span class="mi">18</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">88</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">19</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">92</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">20</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span>  <span class="mi">96</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">21</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">100</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">22</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">104</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">Rank</span><span class="p">:</span>   <span class="mi">23</span><span class="p">;</span> <span class="n">NumRanks</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">108</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">GPU</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">summit</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="common-use-cases">
<h4>Common Use Cases<a class="headerlink" href="#common-use-cases" title="Link to this heading"></a></h4>
<p>The following table provides a quick reference for creating resource
sets of various common use cases. The <code class="docutils literal notranslate"><span class="pre">-n</span></code> flag can be altered to
specify the number of resource sets needed.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Resource Sets</p></th>
<th class="head"><p>MPI Tasks</p></th>
<th class="head"><p>Threads</p></th>
<th class="head"><p>Physical Cores</p></th>
<th class="head"><p>GPUs</p></th>
<th class="head"><p>jsrun Command</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>42</p></td>
<td><p>0</p></td>
<td><p>42</p></td>
<td><p>0</p></td>
<td><p>jsrun -n1 -a42 -c42 -g0</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>jsrun -n1 -a1 -c1 -g1</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>2</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>jsrun -n1 -a2 -c2 -g1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>jsrun -n1 -a1 -c1 -g2</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>21</p></td>
<td><p>21</p></td>
<td><p>3</p></td>
<td><p>jsrun -n1 -a1 -c21 -g3 -bpacked:21</p></td>
</tr>
</tbody>
</table>
</section>
<section id="jsrun-tools">
<h4>jsrun Tools<a class="headerlink" href="#jsrun-tools" title="Link to this heading"></a></h4>
<p>This section describes tools that users might find helpful to better
understand the jsrun job launcher.</p>
<section id="hello-jsrun">
<h5>hello_jsrun<a class="headerlink" href="#hello-jsrun" title="Link to this heading"></a></h5>
<p>hello_jsrun is a Hello World-type program that users can run on
Summit nodes to better understand how MPI ranks and OpenMP threads are
mapped to the hardware. <a class="reference external" href="https://code.ornl.gov/t4p/Hello_jsrun" target="_blank">https://code.ornl.gov/t4p/Hello_jsrun</a> A
screencast showing how to use Hello_jsrun is also available:
<a class="reference external" href="https://vimeo.com/261038849" target="_blank">https://vimeo.com/261038849</a></p>
</section>
<section id="job-step-viewer">
<h5>Job Step Viewer<a class="headerlink" href="#job-step-viewer" title="Link to this heading"></a></h5>
<p><a class="reference external" href="https://jobstepviewer.olcf.ornl.gov/" target="_blank">Job Step Viewer</a> provides a graphical view of an applications runtime layout on Summit.
It allows users to preview and quickly iterate with multiple <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> options to
understand and optimize job launch.</p>
<p>For bug reports or suggestions, please email <a class="reference external" href="mailto:help&#37;&#52;&#48;olcf&#46;ornl&#46;gov" target="_blank">help<span>&#64;</span>olcf<span>&#46;</span>ornl<span>&#46;</span>gov</a>.</p>
<section id="usage">
<h6>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h6>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Request a Summit allocation</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-W</span> <span class="pre">10</span> <span class="pre">-nnodes</span> <span class="pre">2</span> <span class="pre">-P</span> <span class="pre">$OLCF_PROJECT_ID</span> <span class="pre">-Is</span> <span class="pre">$SHELL</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Load the <code class="docutils literal notranslate"><span class="pre">job-step-viewer</span></code> module</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">job-step-viewer</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Test out a <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> line by itself, or provide an executable as normal</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n12</span> <span class="pre">-r6</span> <span class="pre">-c7</span> <span class="pre">-g1</span> <span class="pre">-a1</span> <span class="pre">-EOMP_NUM_THREADS=7</span> <span class="pre">-brs</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Visit the provided URL</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://jobstepviewer.olcf.ornl.gov/summit/871957-1" target="_blank">https://jobstepviewer.olcf.ornl.gov/summit/871957-1</a></p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most Terminal applications have built-in shortcuts to directly open
web addresses in the default browser.</p>
<ul class="simple">
<li><p>MacOS Terminal.app: hold Command () and double-click on the URL</p></li>
<li><p>iTerm2: hold Command () and single-click on the URL</p></li>
</ul>
</div>
</section>
<section id="limitations">
<h6>Limitations<a class="headerlink" href="#limitations" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>(currently) Compiled with GCC toolchain only</p></li>
<li><p>Does not support MPMD-mode via ERF</p></li>
<li><p>OpenMP only supported with use of the <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code> environment variable.</p></li>
</ul>
</section>
</section>
</section>
<section id="more-information">
<h4>More Information<a class="headerlink" href="#more-information" title="Link to this heading"></a></h4>
<p>This section provides some of the most commonly used LSF commands as
well as some of the most useful options to those commands and
information on <code class="docutils literal notranslate"><span class="pre">jsrun</span></code>, Summits job launch command. Many commands
have much more information than can be easily presented here. More
information about these commands is available via the online manual
(i.e. <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">jsrun</span></code>). Additional LSF information can be found on <a class="reference external" href="https://www.ibm.com/support/knowledgecenter/en/SSWRJV/product_welcome_spectrum_lsf.html" target="_blank">IBMs
website</a>.</p>
</section>
</section>
<section id="using-multithreading-in-a-job">
<h3>Using Multithreading in a Job<a class="headerlink" href="#using-multithreading-in-a-job" title="Link to this heading"></a></h3>
<section id="hardware-threads-multiple-threads-per-core">
<h4>Hardware Threads: Multiple Threads per Core<a class="headerlink" href="#hardware-threads-multiple-threads-per-core" title="Link to this heading"></a></h4>
<p>Each physical core on Summit contains 4 hardware threads. The SMT level
can be set using LSF flags (the default is smt4):</p>
<p>SMT1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#BSUB -alloc_flags smt1</span>
<span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">c1</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">bpacked</span><span class="p">:</span><span class="mi">1</span> <span class="n">csh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo $OMP_PLACES</span>
<span class="mi">0</span>
</pre></div>
</div>
<p>SMT2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#BSUB -alloc_flags smt2</span>
<span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">c1</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">bpacked</span><span class="p">:</span><span class="mi">1</span> <span class="n">csh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo $OMP_PLACES</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
<p>SMT4</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#BSUB -alloc_flags smt4</span>
<span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">c1</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">bpacked</span><span class="p">:</span><span class="mi">1</span> <span class="n">csh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo $OMP_PLACES</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="controlling-number-of-threads-for-tasks">
<h4>Controlling Number of Threads for Tasks<a class="headerlink" href="#controlling-number-of-threads-for-tasks" title="Link to this heading"></a></h4>
<p>In addition to specifying the SMT level, you can also control the
number of threads per MPI task by exporting the <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code>
environment variable. If you dont export it yourself, Jsrun will
automatically set the number of threads based on the number of cores
requested (<code class="docutils literal notranslate"><span class="pre">-c</span></code>) and the binding (<code class="docutils literal notranslate"><span class="pre">-b</span></code>) option. It is better to be
explicit and set the <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code> value yourself rather than
relying on Jsrun constructing it for you. Especially when you are
using <a class="reference internal" href="#job-step-viewer">Job Step Viewer</a> which relies on the presence of that
environment variable to give you visual thread assignment information.</p>
<p>In the below example, you could also do <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">OMP_NUM_THREADS=16</span></code> in your
job script instead of passing it as a <code class="docutils literal notranslate"><span class="pre">-E</span></code> flag to jsrun. The below example
starts 1 resource set with 2 tasks and 8 cores, 4 cores bound to each task,
16 threads for each task. We can set 16 threads since there are 4 cores
per task and the default is smt4 for each core (4 * 4 = 16 threads).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">a2</span> <span class="o">-</span><span class="n">c8</span> <span class="o">-</span><span class="n">g1</span> <span class="o">-</span><span class="n">bpacked</span><span class="p">:</span><span class="mi">4</span> <span class="o">-</span><span class="n">dpacked</span> <span class="o">-</span><span class="n">EOMP_NUM_THREADS</span><span class="o">=</span><span class="mi">16</span> <span class="n">csh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo $OMP_NUM_THREADS $OMP_PLACES&#39;</span>

<span class="mi">16</span> <span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">4</span>
<span class="mi">16</span> <span class="mi">16</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">28</span><span class="p">:</span><span class="mi">4</span>
</pre></div>
</div>
<p>Be careful with assigning threads to tasks, as you might end up
oversubscribing your cores. For example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">a2</span> <span class="o">-</span><span class="n">c8</span> <span class="o">-</span><span class="n">g1</span> <span class="o">-</span><span class="n">bpacked</span><span class="p">:</span><span class="mi">4</span> <span class="o">-</span><span class="n">dpacked</span> <span class="o">-</span><span class="n">EOMP_NUM_THREADS</span><span class="o">=</span><span class="mi">32</span> <span class="n">csh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo $OMP_NUM_THREADS $OMP_PLACES&#39;</span>

<span class="ne">Warning</span><span class="p">:</span> <span class="n">OMP_NUM_THREADS</span><span class="o">=</span><span class="mi">32</span> <span class="ow">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">available</span> <span class="n">PU</span><span class="s1">&#39;s</span>
<span class="ne">Warning</span><span class="p">:</span> <span class="n">OMP_NUM_THREADS</span><span class="o">=</span><span class="mi">32</span> <span class="ow">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">available</span> <span class="n">PU</span><span class="s1">&#39;s</span>
<span class="ne">Warning</span><span class="p">:</span> <span class="n">OMP_NUM_THREADS</span><span class="o">=</span><span class="mi">32</span> <span class="ow">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">available</span> <span class="n">PU</span><span class="s1">&#39;s</span>
<span class="ne">Warning</span><span class="p">:</span> <span class="n">OMP_NUM_THREADS</span><span class="o">=</span><span class="mi">32</span> <span class="ow">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">available</span> <span class="n">PU</span><span class="s1">&#39;s</span>
<span class="mi">32</span> <span class="mi">16</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">28</span><span class="p">:</span><span class="mi">4</span>
<span class="mi">32</span> <span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">4</span>
</pre></div>
</div>
<p>You can use <a class="reference internal" href="#hello-jsrun">hello_jsrun</a> or <a class="reference internal" href="#job-step-viewer">Job Step Viewer</a> to see how the cores
are being oversubscribed.</p>
<p>Because of how jsrun sets up <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code> based on <code class="docutils literal notranslate"><span class="pre">-c</span></code> and
<code class="docutils literal notranslate"><span class="pre">-b</span></code> options if you dont specify the environment variable yourself,
you can accidentally end up oversubscribing your cores. For example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">a2</span> <span class="o">-</span><span class="n">c8</span> <span class="o">-</span><span class="n">g1</span> <span class="o">-</span><span class="n">brs</span> <span class="o">-</span><span class="n">dpacked</span>  <span class="n">csh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo $OMP_NUM_THREADS $OMP_PLACES&#39;</span>

<span class="ne">Warning</span><span class="p">:</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">1</span> <span class="n">task</span><span class="o">/</span><span class="n">rank</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">a</span> <span class="n">core</span>
<span class="ne">Warning</span><span class="p">:</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">1</span> <span class="n">task</span><span class="o">/</span><span class="n">rank</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">a</span> <span class="n">core</span>
<span class="mi">32</span> <span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">28</span><span class="p">:</span><span class="mi">4</span>
<span class="mi">32</span> <span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">28</span><span class="p">:</span><span class="mi">4</span>
</pre></div>
</div>
<p>Because jsrun sees 8 cores and the <code class="docutils literal notranslate"><span class="pre">-brs</span></code> flag, it assigns all 8 cores to
each of the 2 tasks in the resource set. Jsrun will set up <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code>
as 32 (8 cores with 4 threads per core) which will apply to all the
tasks in the resource set. This means that each task sees that it can
have 32 threads (which means 64 threads for the 2 tasks combined) which
will oversubscribe the cores and may decrease efficiency as a result.</p>
</section>
<section id="example-single-task-single-gpu-multiple-threads-per-rs">
<h4>Example: Single Task, Single GPU, Multiple Threads per RS<a class="headerlink" href="#example-single-task-single-gpu-multiple-threads-per-rs" title="Link to this heading"></a></h4>
<p>The following example will create 12 resource sets each with 1 task, 4
threads, and 1 GPU. Each MPI task will start 4 threads and have access
to 1 GPU. Rank 0 will have access to GPU 0 and start 4 threads on the
first socket of the first node ( red resource set). Rank 2 will have
access to GPU 1 and start 4 threads on the second socket of the first
node ( green resource set). This pattern will continue until 12 resource
sets have been created. The following jsrun command will create 12
resource sets (<code class="docutils literal notranslate"><span class="pre">-n12</span></code>). Each resource set will contain 1 MPI task
(<code class="docutils literal notranslate"><span class="pre">-a1</span></code>), 1 GPU (<code class="docutils literal notranslate"><span class="pre">-g1</span></code>), and 4 cores (<code class="docutils literal notranslate"><span class="pre">-c4</span></code>). Notice that
more cores are requested than MPI tasks; the extra cores will be needed
to place threads. Without requesting additional cores, threads will be
placed on a single core.</p>
<p><strong>Requesting Cores for Threads:</strong> The <code class="docutils literal notranslate"><span class="pre">-c</span></code> flag should be used to
request additional cores for thread placement. Without requesting
additional cores, threads will be placed on a single core.</p>
<p><strong>Binding Cores to Tasks:</strong> The <code class="docutils literal notranslate"><span class="pre">-b</span></code> binding flag should be used to
bind cores to tasks. Without specifying binding, all threads will be
bound to the first core.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">setenv</span> <span class="n">OMP_NUM_THREADS</span> <span class="mi">4</span>
<span class="n">summit</span><span class="o">&gt;</span> <span class="n">jsrun</span> <span class="o">-</span><span class="n">n12</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">c4</span> <span class="o">-</span><span class="n">g1</span> <span class="o">-</span><span class="n">b</span> <span class="n">packed</span><span class="p">:</span><span class="mi">4</span> <span class="o">-</span><span class="n">d</span> <span class="n">packed</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">},{</span><span class="mi">4</span><span class="p">},{</span><span class="mi">8</span><span class="p">},{</span><span class="mi">12</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">4</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">},{</span><span class="mi">4</span><span class="p">},{</span><span class="mi">8</span><span class="p">},{</span><span class="mi">12</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">2</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">8</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">},{</span><span class="mi">4</span><span class="p">},{</span><span class="mi">8</span><span class="p">},{</span><span class="mi">12</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">3</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">},{</span><span class="mi">4</span><span class="p">},{</span><span class="mi">8</span><span class="p">},{</span><span class="mi">12</span><span class="p">}</span>

<span class="n">Rank</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">16</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">16</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">16</span><span class="p">},{</span><span class="mi">20</span><span class="p">},{</span><span class="mi">24</span><span class="p">},{</span><span class="mi">28</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">16</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">20</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">16</span><span class="p">},{</span><span class="mi">20</span><span class="p">},{</span><span class="mi">24</span><span class="p">},{</span><span class="mi">28</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">16</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">2</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">24</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">16</span><span class="p">},{</span><span class="mi">20</span><span class="p">},{</span><span class="mi">24</span><span class="p">},{</span><span class="mi">28</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">16</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">3</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">28</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n06</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">16</span><span class="p">},{</span><span class="mi">20</span><span class="p">},{</span><span class="mi">24</span><span class="p">},{</span><span class="mi">28</span><span class="p">}</span>

<span class="o">...</span>

<span class="n">Rank</span><span class="p">:</span> <span class="mi">10</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">104</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">104</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">104</span><span class="p">},{</span><span class="mi">108</span><span class="p">},{</span><span class="mi">112</span><span class="p">},{</span><span class="mi">116</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">10</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">104</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">108</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">104</span><span class="p">},{</span><span class="mi">108</span><span class="p">},{</span><span class="mi">112</span><span class="p">},{</span><span class="mi">116</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">10</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">104</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">2</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">112</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">104</span><span class="p">},{</span><span class="mi">108</span><span class="p">},{</span><span class="mi">112</span><span class="p">},{</span><span class="mi">116</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">10</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">104</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">3</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">116</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">104</span><span class="p">},{</span><span class="mi">108</span><span class="p">},{</span><span class="mi">112</span><span class="p">},{</span><span class="mi">116</span><span class="p">}</span>

<span class="n">Rank</span><span class="p">:</span> <span class="mi">11</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">120</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">120</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">120</span><span class="p">},{</span><span class="mi">124</span><span class="p">},{</span><span class="mi">128</span><span class="p">},{</span><span class="mi">132</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">11</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">120</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">124</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">120</span><span class="p">},{</span><span class="mi">124</span><span class="p">},{</span><span class="mi">128</span><span class="p">},{</span><span class="mi">132</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">11</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">120</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">2</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">128</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">120</span><span class="p">},{</span><span class="mi">124</span><span class="p">},{</span><span class="mi">128</span><span class="p">},{</span><span class="mi">132</span><span class="p">}</span>
<span class="n">Rank</span><span class="p">:</span> <span class="mi">11</span><span class="p">;</span> <span class="n">RankCore</span><span class="p">:</span> <span class="mi">120</span><span class="p">;</span> <span class="n">Thread</span><span class="p">:</span> <span class="mi">3</span><span class="p">;</span> <span class="n">ThreadCore</span><span class="p">:</span> <span class="mi">132</span><span class="p">;</span> <span class="n">Hostname</span><span class="p">:</span> <span class="n">a33n05</span><span class="p">;</span> <span class="n">OMP_NUM_PLACES</span><span class="p">:</span> <span class="p">{</span><span class="mi">120</span><span class="p">},{</span><span class="mi">124</span><span class="p">},{</span><span class="mi">128</span><span class="p">},{</span><span class="mi">132</span><span class="p">}</span>

<span class="n">summit</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../_images/RS-summit-example-4Threads-4Core-1GPU.png" class="align-center" src="../_images/RS-summit-example-4Threads-4Core-1GPU.png" />
</section>
</section>
<section id="launching-multiple-jsruns">
<h3>Launching Multiple Jsruns<a class="headerlink" href="#launching-multiple-jsruns" title="Link to this heading"></a></h3>
<p>Jsrun provides the ability to launch multiple <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> job launches within a
single batch job allocation. This can be done within a single node, or across
multiple nodes.</p>
<section id="sequential-job-steps">
<h4>Sequential Job Steps<a class="headerlink" href="#sequential-job-steps" title="Link to this heading"></a></h4>
<p>By default, multiple invocations of <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> in a job script will execute
serially in order. In this configuration, jobs will launch one at a time and
the next one will not start until the previous is complete. The batch node
allocation is equal to the largest jsrun submitted, and the total walltime
must be equal to or greater then the <em>sum</em> of all jsruns issued.</p>
<img alt="../_images/summit-multi-jsrun-example-sequential.png" class="align-center" src="../_images/summit-multi-jsrun-example-sequential.png" />
</section>
<section id="simultaneous-job-steps">
<h4>Simultaneous Job Steps<a class="headerlink" href="#simultaneous-job-steps" title="Link to this heading"></a></h4>
<p>To execute multiple job steps concurrently, standard UNIX process
backgrounding can be used by adding a <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> at the end of the command. This
will return control to the job script and execute the next command immediately,
allowing multiple job launches to start at the same time. The jsruns will not
share core/gpu resources in this configuration. The batch node allocation is
equal to the <em>sum</em> of those of each jsrun, and the total walltime must be equal
to or greater than that of the longest running jsrun task.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">wait</span></code> command must follow all backgrounded processes to prevent the job
from appearing completed and exiting prematurely.</p>
<img alt="../_images/summit-multi-jsrun-example-simultaneous.png" class="align-center" src="../_images/summit-multi-jsrun-example-simultaneous.png" />
<p>The following example executes three backgrounded job steps and waits for them
to finish before the job ends.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#BSUB -P ABC123
#BSUB -W 3:00
#BSUB -nnodes 1
#BSUB -J RunSim123
#BSUB -o RunSim123.%J
#BSUB -e RunSim123.%J

cd $MEMBERWORK/abc123
jsrun &lt;options&gt; ./a.out &amp;
jsrun &lt;options&gt; ./a.out &amp;
jsrun &lt;options&gt; ./a.out &amp;
wait
</pre></div>
</div>
<p>As submission scripts (and interactive sessions) are executed on batch nodes,
the number of concurrent job steps is limited by the per-user process limit on
a batch node, where a single user is only permitted 4096 simultaneous
processes. This limit is per user on each batch node, not per batch job.</p>
<p>Each job step will create 3 processes, and JSM management may create up to ~23
processes. This creates an upper-limit of ~1350 simultaneous job steps.</p>
<p>If JSM or PMIX errors occur as the result of backgrounding many job steps, using the
<code class="docutils literal notranslate"><span class="pre">--immediate</span></code> option to <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> may help, as shown in the following example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#BSUB -P ABC123
#BSUB -W 3:00
#BSUB -nnodes 1
#BSUB -J RunSim123
#BSUB -o RunSim123.%J
#BSUB -e RunSim123.%J

cd $MEMBERWORK/abc123
jsrun &lt;options&gt; --immediate ./a.out
jsrun &lt;options&gt; --immediate ./a.out
jsrun &lt;options&gt; --immediate ./a.out
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">--immediate</span></code> does not produce <code class="docutils literal notranslate"><span class="pre">stdout</span></code> or
<code class="docutils literal notranslate"><span class="pre">stderr</span></code>. To capture <code class="docutils literal notranslate"><span class="pre">stdout</span></code> and/or <code class="docutils literal notranslate"><span class="pre">stderr</span></code> when using this option,
additionally include <code class="docutils literal notranslate"><span class="pre">--stdio_stdout</span></code>/<code class="docutils literal notranslate"><span class="pre">-o</span></code> and/or
<code class="docutils literal notranslate"><span class="pre">--stdio_stderr</span></code>/<code class="docutils literal notranslate"><span class="pre">-k</span></code>.</p>
</div>
</section>
<section id="using-jslist">
<h4>Using <cite>jslist</cite><a class="headerlink" href="#using-jslist" title="Link to this heading"></a></h4>
<p>To view the status of multiple jobs launched sequentially or concurrently within a
batch script, you can use <cite>jslist</cite> to see which are completed, running, or still
queued. If you are using it outside of an interactive batch job, use the <cite>-c</cite> option
to specify the CSM allocation ID number. The following example shows how to obtain the
CSM allocation number for a non interactive job and then check its status.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ bsub test.lsf
Job &lt;26238&gt; is submitted to default queue &lt;batch&gt;.

$ bjobs -l 26238 | grep CSM_ALLOCATION_ID
Sun Feb 16 19:01:18: CSM_ALLOCATION_ID=34435

$ jslist -c 34435
  parent         cpus     gpus     exit
  ID  ID    nrs  per RS  per RS   status    status
 ===========================================================
   1   0    12     4       1        0       Running
</pre></div>
</div>
</section>
<section id="explicit-resource-files-erf">
<h4>Explicit Resource Files (ERF)<a class="headerlink" href="#explicit-resource-files-erf" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://www.ibm.com/support/knowledgecenter/en/SSWRJV_10.1.0/jsm/10.3/base/erf_format.html" target="_blank">Explicit Resource Files</a>
provide even more fine-granied control over how processes are mapped onto
compute nodes. ERFs can define job step options such as rank placement/binding,
SMT/CPU/GPU resources, compute hosts, among many others. If you find that the
most common jsrun options do not readily provide the resource layout you need,
we recommend considering ERF files.</p>
<p>A common source of confusion when using ERFs is how physical cores are
enumerated. See the tutorial on <a class="reference external" href="https://github.com/olcf-tutorials/ERF-CPU-Indexing" target="_blank">ERF CPU
Indexing</a> for a
discussion of the <code class="docutils literal notranslate"><span class="pre">cpu_index_using</span></code> control and its interaction with various
SMT modes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note, a known bug is currently preventing execution of most ERF use cases. We are working to resolve the issue.</p>
</div>
</section>
</section>
<section id="cuda-aware-mpi">
<span id="id18"></span><h3>CUDA-Aware MPI<a class="headerlink" href="#cuda-aware-mpi" title="Link to this heading"></a></h3>
<p>CUDA-aware MPI and GPUDirect are often used interchangeably, but they
are distinct topics.</p>
<p>CUDA-aware MPI allows GPU buffers (e.g., GPU memory allocated with
<code class="docutils literal notranslate"><span class="pre">cudaMalloc</span></code>) to be used directly in MPI calls rather than requiring
data to be manually transferred to/from a CPU buffer (e.g., using
<code class="docutils literal notranslate"><span class="pre">cudaMemcpy</span></code>) before/after passing data in MPI calls. By itself,
CUDA-aware MPI does not specify whether data is staged through
CPU memory or, for example, transferred directly between GPUs when
passing GPU buffers to MPI calls. That is where GPUDirect comes in.</p>
<p>GPUDirect is a technology that can be implemented on a system to enhance
CUDA-aware MPI by allowing data transfers directly between GPUs on the
same node (peer-to-peer) and/or directly between GPUs on different nodes
(with RDMA support) without the need to stage data through CPU memory.
On Summit, both peer-to-peer and RDMA support are implemented. To enable
CUDA-aware MPI in a job, use the following argument to <code class="docutils literal notranslate"><span class="pre">jsrun</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jsrun</span> <span class="o">--</span><span class="n">smpiargs</span><span class="o">=</span><span class="s2">&quot;-gpu&quot;</span> <span class="o">...</span>
</pre></div>
</div>
<p>Not using the <code class="docutils literal notranslate"><span class="pre">--smpiargs=&quot;-gpu&quot;</span></code> flag might result in confusing segmentation
faults. If you see a segmentation fault when trying to do GPU aware MPI, check to
see if you have the flag set correctly.</p>
</section>
<section id="monitoring-jobs">
<h3>Monitoring Jobs<a class="headerlink" href="#monitoring-jobs" title="Link to this heading"></a></h3>
<p>LSF provides several utilities with which you can monitor jobs. These
include monitoring the queue, getting details about a particular job,
viewing STDOUT/STDERR of running jobs, and more.</p>
<p>The most straightforward monitoring is with the <code class="docutils literal notranslate"><span class="pre">bjobs</span></code> command. This
command will show the current queue, including both pending and running
jobs. Running <code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-l</span></code> will provide much more detail about a job (or
group of jobs). For detailed output of a single job, specify the job id
after the <code class="docutils literal notranslate"><span class="pre">-l</span></code>. For example, for detailed output of job 12345, you can
run <code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-l</span> <span class="pre">12345</span></code> . Other options to <code class="docutils literal notranslate"><span class="pre">bjobs</span></code> are shown below. In
general, if the command is specified with <code class="docutils literal notranslate"><span class="pre">-u</span> <span class="pre">all</span></code> it will show
information for all users/all jobs. Without that option, it only shows
your jobs. Note that this is not an exhaustive list. See <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">bjobs</span></code>
for more information.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span></code></p></td>
<td><p>Show your current jobs in the queue</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-u</span> <span class="pre">all</span></code></p></td>
<td><p>Show currently queued jobs for all users</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-P</span> <span class="pre">ABC123</span></code></p></td>
<td><p>Shows currently-queued jobs for project ABC123</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-UF</span></code></p></td>
<td><p>Dont format output (might be useful if youre using the output in a script)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-a</span></code></p></td>
<td><p>Show jobs in all states, including recently finished jobs</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-l</span></code></p></td>
<td><p>Show long/detailed output</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-l</span> <span class="pre">12345</span></code></p></td>
<td><p>Show long/detailed output for jobs 12345</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-d</span></code></p></td>
<td><p>Show details for recently completed jobs</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-s</span></code></p></td>
<td><p>Show suspended jobs, including the reason(s) theyre suspended</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-r</span></code></p></td>
<td><p>Show running jobs</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-p</span></code></p></td>
<td><p>Show pending jobs</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-w</span></code></p></td>
<td><p>Use wide formatting for output</p></td>
</tr>
</tbody>
</table>
<p>If you want to check the STDOUT/STDERR of a currently running job, you
can do so with the <code class="docutils literal notranslate"><span class="pre">bpeek</span></code> command. The command supports several
options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bpeek</span> <span class="pre">-J</span> <span class="pre">jobname</span></code></p></td>
<td><p>Show STDOUT/STDERR for the job youve most recently submitted with the name jobname</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bpeek</span> <span class="pre">12345</span></code></p></td>
<td><p>Show STDOUT/STDERR for job 12345</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bpeek</span> <span class="pre">-f</span> <span class="pre">...</span></code></p></td>
<td><p>Used with other options. Makes <code class="docutils literal notranslate"><span class="pre">bpeek</span></code> use <code class="docutils literal notranslate"><span class="pre">tail</span> <span class="pre">-f</span></code> and exit once the job completes.</p></td>
</tr>
</tbody>
</table>
<p>The OLCF also provides <code class="docutils literal notranslate"><span class="pre">jobstat</span></code>, which adds dividers in the queue to
identify jobs as running, eligible, or blocked. Run without arguments,
<code class="docutils literal notranslate"><span class="pre">jobstat</span></code> provides a snapshot of the entire batch queue. Additional
information, including the number of jobs in each state, total nodes
available, and relative job priority are also included.</p>
<p><code class="docutils literal notranslate"><span class="pre">jobstat</span> <span class="pre">-u</span> <span class="pre">&lt;username&gt;</span></code> restricts output to only the jobs of a
specific user. See the <code class="docutils literal notranslate"><span class="pre">jobstat</span></code> man page for a full list of
formatting arguments.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ jobstat -u &lt;user&gt;
--------------------------- Running Jobs: 2 (4544 of 4604 nodes, 98.70%) ---------------------------
JobId    Username   Project          Nodes Remain     StartTime       JobName
331590   user     project           2     57:06      04/09 10:06:23  Not_Specified
331707   user     project           40    39:47      04/09 11:04:04  runA
----------------------------------------- Eligible Jobs: 3 -----------------------------------------
JobId    Username   Project          Nodes Walltime   QueueTime       Priority JobName
331712   user     project           80    45:00      04/09 11:06:23  501.00   runB
331713   user     project           90    45:00      04/09 11:07:19  501.00   runC
331714   user     project           100   45:00      04/09 11:07:49  501.00   runD
----------------------------------------- Blocked Jobs: 1 ------------------------------------------
JobId    Username   Project          Nodes Walltime   BlockReason
331715   user        project           12    2:00:00    Job dependency condition not satisfied
</pre></div>
</div>
<section id="inspecting-backfill">
<h4>Inspecting Backfill<a class="headerlink" href="#inspecting-backfill" title="Link to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">bjobs</span></code> and <code class="docutils literal notranslate"><span class="pre">jobstat</span></code> help to identify whats currently running and
scheduled to run, but sometimes its beneficial to know how much of the
system is <em>not</em> currently in use or scheduled for use.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bslots</span></code> command can be used to inspect backfill windows and answer
the question How many nodes are currently available, and for how long
will they remain available? This can be thought of as identifying gaps in
the systems current job schedule. By intentionally requesting resources
within the parameters of a backfill window, one can potentially shorten
their queued time and improve overall system utilization.</p>
<p>LSF uses slots to describe allocatable resources. Summit compute nodes have 1
slot per CPU core, for a total of 42 per node ([2x] Power9 CPUs, each
with 21 cores). Since Summit nodes are scheduled in whole-node
allocations, the output from <code class="docutils literal notranslate"><span class="pre">bslots</span></code> can be divided by 42 to see how
many nodes are currently available.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">bslots</span></code> output includes launch node slots, which can
cause unwanted and inflated fractional node values. The output can
be adjusted to reflect only available compute node slots with the
flag  <code class="docutils literal notranslate"><span class="pre">-Rselect[CN]</span></code>. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ bslots -R&quot;select[CN]&quot;
SLOTS          RUNTIME
42             25 hours 42 minutes 51 seconds
27384          1 hours 11 minutes 50 seconds
</pre></div>
</div>
<p>27384 compute node slots / 42 slots per node = 652 compute nodes are
available for 1 hour, 11 minutes, 50 seconds.</p>
<p>A more specific <code class="docutils literal notranslate"><span class="pre">bslots</span></code> query could check for a backfill window with
space to fit a 1000 node job for 10 minutes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ bslots -R&quot;select[CN]&quot; -n $((1000*42)) -W10
SLOTS          RUNTIME
127764         22 minutes 55 seconds
</pre></div>
</div>
<p>There is no guarantee that the slots reported by <code class="docutils literal notranslate"><span class="pre">bslots</span></code> will still
be available at time of new job submission.</p>
</section>
</section>
<section id="interacting-with-jobs">
<h3>Interacting With Jobs<a class="headerlink" href="#interacting-with-jobs" title="Link to this heading"></a></h3>
<p>Sometimes its necessary to interact with a batch job after it has been
submitted. LSF provides several commands for interacting with
already-submitted jobs.</p>
<p>Many of these commands can operate on either one job or a group of jobs.
In general, they only operate on the most recently submitted job that
matches other criteria provided unless 0 is specified as the job id.</p>
<section id="suspending-and-resuming-jobs">
<h4>Suspending and Resuming Jobs<a class="headerlink" href="#suspending-and-resuming-jobs" title="Link to this heading"></a></h4>
<p>LSF supports user-level suspension and resumption of jobs. Jobs are
suspended with the <code class="docutils literal notranslate"><span class="pre">bstop</span></code> command and resumed with the <code class="docutils literal notranslate"><span class="pre">bresume</span></code>
command. The simplest way to invoke these commands is to list the job id
to be suspended/resumed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bstop</span> <span class="mi">12345</span>
<span class="n">bresume</span> <span class="mi">12345</span>
</pre></div>
</div>
<p>Instead of specifying a job id, you can specify other criteria that will
allow you to suspend some/all jobs that meet other criteria such as a
job name, a queue name, etc. These are described in the manpages for
<code class="docutils literal notranslate"><span class="pre">bstop</span></code> and <code class="docutils literal notranslate"><span class="pre">bresume</span></code>.</p>
</section>
<section id="signaling-jobs">
<h4>Signaling Jobs<a class="headerlink" href="#signaling-jobs" title="Link to this heading"></a></h4>
<p>You can send signals to jobs with the <code class="docutils literal notranslate"><span class="pre">bkill</span></code> command. While the
command name suggests its only purpose is to terminate jobs, this is not
the case. Similar to the <code class="docutils literal notranslate"><span class="pre">kill</span></code> command found in Unix-like operating
systems, this command can be used to send various signals (not just
<code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code> and <code class="docutils literal notranslate"><span class="pre">SIGKILL</span></code>) to jobs. The command can accept both
numbers and names for signals. For a list of accepted signal names, run
<code class="docutils literal notranslate"><span class="pre">bkill</span> <span class="pre">-l</span></code>. Common ways to invoke the command include:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17.0%" />
<col style="width: 83.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bkill</span> <span class="pre">12345</span></code></p></td>
<td><p>Force a job to stop by sending <code class="docutils literal notranslate"><span class="pre">SIGINT</span></code>,
<code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>, and <code class="docutils literal notranslate"><span class="pre">SIGKILL</span></code>. These signals are sent in that order, so users
can write applications such that they will trap <code class="docutils literal notranslate"><span class="pre">SIGINT</span></code> and/or <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>
and exit in a controlled manner.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bkill</span> <span class="pre">-s</span> <span class="pre">USR1</span> <span class="pre">12345</span></code></p></td>
<td><p>Send <code class="docutils literal notranslate"><span class="pre">SIGUSR1</span></code> to job 12345 NOTE: When
specifying a signal by name, omit SIG from the name. Thus, you specify <code class="docutils literal notranslate"><span class="pre">USR1</span></code>
and not <code class="docutils literal notranslate"><span class="pre">SIGUSR1</span></code> on the <code class="docutils literal notranslate"><span class="pre">bkill</span></code> command line.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bkill</span> <span class="pre">-s</span> <span class="pre">9</span> <span class="pre">12345</span></code></p></td>
<td><p>Send signal 9 to job 12345</p></td>
</tr>
</tbody>
</table>
<p>Like <code class="docutils literal notranslate"><span class="pre">bstop</span></code> and <code class="docutils literal notranslate"><span class="pre">bresume</span></code>, <code class="docutils literal notranslate"><span class="pre">bkill</span></code> command also supports
identifying the job(s) to be signaled by criteria other than the job id.
These include some/all jobs with a given name, in a particular queue,
etc. See <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">bkill</span></code> for more information.</p>
</section>
<section id="checkpointing-jobs">
<h4>Checkpointing Jobs<a class="headerlink" href="#checkpointing-jobs" title="Link to this heading"></a></h4>
<p>LSF documentation mentions the <code class="docutils literal notranslate"><span class="pre">bchkpnt</span></code> and <code class="docutils literal notranslate"><span class="pre">brestart</span></code> commands for
checkpointing and restarting jobs, as well as the <code class="docutils literal notranslate"><span class="pre">-k</span></code> option to
<code class="docutils literal notranslate"><span class="pre">bsub</span></code> for configuring checkpointing. Since checkpointing is very
application specific and a wide range of applications run on OLCF
resources, this type of checkpointing is not configured on Summit. If
you wish to use checkpointing (which is highly encouraged), youll need
to configure it within your application.</p>
<p>If you wish to implement some form of on-demand checkpointing, keep in mind
the <code class="docutils literal notranslate"><span class="pre">bkill</span></code> command is really a signaling command and you can have your
job script/application checkpoint as a response to certain signals (such
as <code class="docutils literal notranslate"><span class="pre">SIGUSR1</span></code>).</p>
</section>
</section>
<section id="other-lsf-commands">
<h3>Other LSF Commands<a class="headerlink" href="#other-lsf-commands" title="Link to this heading"></a></h3>
<p>The table below summarizes some additional LSF commands that might be
useful.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12.0%" />
<col style="width: 88.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bparams</span> <span class="pre">-a</span></code></p></td>
<td><p>Show current parameters for LSF. The behavior/available
options for some LSF commands depend on settings in various configuration
files. This command shows those settings without having to search for the
actual files.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bjdepinfo</span></code></p></td>
<td><p>Show job dependency information (could be useful in
determining what job is keeping another job in a pending state)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="pbs-torque-moab-to-lsf-translation">
<h3>PBS/Torque/MOAB-to-LSF Translation<a class="headerlink" href="#pbs-torque-moab-to-lsf-translation" title="Link to this heading"></a></h3>
<p>More details about these commands are given elsewhere in this section;
the table below is simply for your convenience in looking up various LSF
commands.</p>
<p>Users of other OLCF resources are likely familiar with
PBS-like commands which are used by the Torque/Moab instances on other
systems. The table below summarizes the equivalent LSF command for
various PBS/Torque/Moab commands.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>LSF Command</p></th>
<th class="head"><p>PBS/Torque/Moab Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">job.sh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qsub</span> <span class="pre">job.sh</span></code></p></td>
<td><p>Submit the job script job.sh to the batch system</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-Is</span> <span class="pre">/bin/bash</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qsub</span> <span class="pre">-I</span></code></p></td>
<td><p>Submit an interactive batch job</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-u</span> <span class="pre">all</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">showq</span></code></p></td>
<td><p>Show jobs currently in the queue NOTE: without the
-u all argument, bjobs will only show your jobs</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-l</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">checkjob</span></code></p></td>
<td><p>Get information about a specific job</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-d</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">showq</span> <span class="pre">-c</span></code></p></td>
<td><p>Get information about completed jobs</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">showq</span> <span class="pre">-i</span></code>
<code class="docutils literal notranslate"><span class="pre">showq</span> <span class="pre">-b</span></code>
<code class="docutils literal notranslate"><span class="pre">checkjob</span></code></p></td>
<td><p>Get information about pending jobs</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-r</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">showq</span> <span class="pre">-r</span></code></p></td>
<td><p>Get information about running jobs</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bkill</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qsig</span></code></p></td>
<td><p>Send a signal to a job</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bkill</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qdel</span></code></p></td>
<td><p>Terminate/Kill a job</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bstop</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qhold</span></code></p></td>
<td><p>Hold a job/stop a job from running</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bresume</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qrls</span></code></p></td>
<td><p>Release a held job</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bqueues</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">-q</span></code></p></td>
<td><p>Get information about queues</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bjdepinfo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">checkjob</span></code></p></td>
<td><p>Get information about job dependencies</p></td>
</tr>
</tbody>
</table>
<p>The table below shows shows LSF (bsub) command-line/batch script options
and the PBS/Torque/Moab (qsub) options that provide similar
functionality.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>LSF Option</p></th>
<th class="head"><p>PBS/Torque/Moab Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-W</span> <span class="pre">60</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-l</span> <span class="pre">walltime=1:00:00</span></code></p></td>
<td><p>Request a walltime of 1 hour</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-nnodes</span> <span class="pre">1024</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-l</span> <span class="pre">nodes=1024</span></code></p></td>
<td><p>Request 1024 nodes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-P</span> <span class="pre">ABC123</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-A</span> <span class="pre">ABC123</span></code></p></td>
<td><p>Charge the job to project ABC123</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-alloc_flags</span> <span class="pre">gpumps</span></code></p></td>
<td><p>No equivalent (set via environment variable)</p></td>
<td><p>Enable multiple MPI tasks to simultaneously access a GPU</p></td>
</tr>
</tbody>
</table>
</section>
<section id="easy-mode-vs-expert-mode">
<span id="easy-mode-v-expert-mode"></span><h3>Easy Mode vs. Expert Mode<a class="headerlink" href="#easy-mode-vs-expert-mode" title="Link to this heading"></a></h3>
<p>The Cluster System Management (CSM) component of the job launch
environment supports two methods of job submission, termed easy mode
and expert mode. The difference in the modes is where the
responsibility for creating the LSF resource string is placed.</p>
<p>In easy mode, the system software converts options such as -nnodes in
a batch script into the resource string needed by the scheduling system.
In expert mode, the user is responsible for creating this string and
options such as -nnodes cannot be used. In easy mode, you will not be
able to use <code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-R</span></code> to create resource strings. The system will
automatically create the resource string based on your other <code class="docutils literal notranslate"><span class="pre">bsub</span></code>
options. In expert mode, you will be able to use <code class="docutils literal notranslate"><span class="pre">-R</span></code>, but you will
not be able to use the following options to <code class="docutils literal notranslate"><span class="pre">bsub</span></code>: <code class="docutils literal notranslate"><span class="pre">-ln_slots</span></code>,
<code class="docutils literal notranslate"><span class="pre">-ln_mem</span></code>, <code class="docutils literal notranslate"><span class="pre">-cn_cu</span></code>, or <code class="docutils literal notranslate"><span class="pre">-nnodes</span></code>.</p>
<p>Most users will want to use easy mode. However, if you need precise
control over your jobs resources, such as placement on (or avoidance
of) specific nodes, you will need to use expert mode. To use expert
mode, add <code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-csm</span> <span class="pre">y</span></code> to your batch script (or <code class="docutils literal notranslate"><span class="pre">-csm</span> <span class="pre">y</span></code> to
your <code class="docutils literal notranslate"><span class="pre">bsub</span></code> command line).</p>
</section>
<section id="system-service-core-isolation">
<h3>System Service Core Isolation<a class="headerlink" href="#system-service-core-isolation" title="Link to this heading"></a></h3>
<p>One core per socket is set aside for system service tasks. The cores are
not available to jsrun. When listing available resources through jsrun,
you will not see cores with hyperthreads 84-87 and 172-175. Isolating a
sockets system services to a single core helps to reduce jitter and
improve performance of tasks performed on the sockets remaining cores.</p>
<p>The isolated core always operates at SMT4 regardless of the batch jobs
SMT level.</p>
<section id="gpfs-system-service-isolation">
<h4>GPFS System Service Isolation<a class="headerlink" href="#gpfs-system-service-isolation" title="Link to this heading"></a></h4>
<p>By default, GPFS system service tasks are forced onto only the isolated
cores. This can be overridden at the batch job level using the
<code class="docutils literal notranslate"><span class="pre">maximizegpfs</span></code> argument to LSFs <code class="docutils literal notranslate"><span class="pre">alloc_flags</span></code>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#BSUB -alloc_flags maximizegpfs</span>
</pre></div>
</div>
<p>The maximizegpfs flag will allow GPFS tasks to utilize any core on the
compute node. This may be beneficial because it provides more resources
for GPFS service tasks, but it may also cause resource contention for
the jsrun compute job.</p>
</section>
</section>
<section id="job-accounting-on-summit">
<h3>Job Accounting on Summit<a class="headerlink" href="#job-accounting-on-summit" title="Link to this heading"></a></h3>
<p>Jobs on Summit are scheduled in full node increments; a nodes cores cannot be
allocated to multiple jobs. Because the OLCF charges based on what a job makes
<em>unavailable</em> to other users, a job is charged for an entire node even if it
uses only one core on a node. To simplify the process, users request and are allocated
multiples of entire nodes through LSF.</p>
<p>Allocations on Summit are separate from those on Andes and other OLCF resources.</p>
<section id="node-hour-calculation">
<h4>Node-Hour Calculation<a class="headerlink" href="#node-hour-calculation" title="Link to this heading"></a></h4>
<p>The <em>node-hour</em> charge for each batch job will be calculated as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">-</span><span class="n">hours</span> <span class="o">=</span> <span class="n">nodes</span> <span class="n">requested</span> <span class="o">*</span> <span class="p">(</span> <span class="n">batch</span> <span class="n">job</span> <span class="n">endtime</span> <span class="o">-</span> <span class="n">batch</span> <span class="n">job</span> <span class="n">starttime</span> <span class="p">)</span>
</pre></div>
</div>
<p>Where <em>batch job starttime</em> is the time the job moves into a running state, and
<em>batch job endtime</em> is the time the job exits a running state.</p>
<p>A batch jobs usage is calculated solely on requested nodes and the batch jobs
start and end time. The number of cores actually used within any particular node
within the batch job is not used in the calculation. For example, if a job
requests (6) nodes through the batch script, runs for (1) hour, uses only (2)
CPU cores per node, the job will still be charged for 6 nodes * 1 hour = <em>6
node-hours</em>.</p>
</section>
<section id="viewing-usage">
<h4>Viewing Usage<a class="headerlink" href="#viewing-usage" title="Link to this heading"></a></h4>
<p>Utilization is calculated daily using batch jobs which complete between 00:00
and 23:59 of the previous day. For example, if a job moves into a run state on
Tuesday and completes Wednesday, the jobs utilization will be recorded
Thursday. Only batch jobs which write an end record are used to calculate
utilization. Batch jobs which do not write end records due to system failure or
other reasons are not used when calculating utilization. Jobs which fail because
of run-time errors (e.g. the users application causes a segmentation fault) are
counted against the allocation.</p>
<p>Each user may view usage for projects on which they are members from the command
line tool <code class="docutils literal notranslate"><span class="pre">showusage</span></code> and the <a class="reference external" href="https://my.olcf.ornl.gov" target="_blank">myOLCF site</a>.</p>
<section id="on-the-command-line-via-showusage">
<h5>On the Command Line via <code class="docutils literal notranslate"><span class="pre">showusage</span></code><a class="headerlink" href="#on-the-command-line-via-showusage" title="Link to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">showusage</span></code> utility can be used to view your usage from January 01
through midnight of the previous day. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ showusage
  Usage:
                           Project Totals
  Project             Allocation      Usage      Remaining     Usage
  _________________|______________|___________|____________|______________
  abc123           |  20000       |   126.3   |  19873.7   |   1560.80
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-h</span></code> option will list more usage details.</p>
</section>
<section id="on-the-web-via-myolcf">
<h5>On the Web via myOLCF<a class="headerlink" href="#on-the-web-via-myolcf" title="Link to this heading"></a></h5>
<p>More detailed metrics may be found on each projects usage section of the <a class="reference external" href="https://my.olcf.ornl.gov" target="_blank">myOLCF
site</a>. The following information is available
for each project:</p>
<ul class="simple">
<li><p>YTD usage by system, subproject, and project member</p></li>
<li><p>Monthly usage by system, subproject, and project member</p></li>
<li><p>YTD usage by job size groupings for each system, subproject, and
project member</p></li>
<li><p>Weekly usage by job size groupings for each system, and subproject</p></li>
<li><p>Batch system priorities by project and subproject</p></li>
<li><p>Project members</p></li>
</ul>
<p>The myOLCF site is provided to aid in the utilization and management of OLCF
allocations. See the <a class="reference internal" href="../services_and_applications/myolcf/index.html"><span class="doc">myOLCF Documentation</span></a> for more information.</p>
<p>If you have any questions or have a request for additional data,
please contact the OLCF User Assistance Center.</p>
</section>
</section>
</section>
<section id="other-notes">
<h3>Other Notes<a class="headerlink" href="#other-notes" title="Link to this heading"></a></h3>
<p>Compute nodes are only allocated to one job at a time; they are not
shared. This is why users request nodes (instead of some other resource
such as cores or GPUs) in batch jobs and is why projects are charged
based on the number of nodes allocated multiplied by the amount of time
for which they were allocated. Thus, a job using only 1 core on each of
its nodes is charged the same as a job using every core and every GPU on
each of its nodes.</p>
</section>
</section>
<section id="debugging">
<span id="id19"></span><h2>Debugging<a class="headerlink" href="#debugging" title="Link to this heading"></a></h2>
<section id="linaro-ddt">
<h3>Linaro DDT<a class="headerlink" href="#linaro-ddt" title="Link to this heading"></a></h3>
<p>Linaro DDT is an advanced debugging tool used for scalar, multi-threaded,
and large-scale parallel applications. In addition to traditional
debugging features (setting breakpoints, stepping through code,
examining variables), DDT also supports attaching to already-running
processes and memory debugging. In-depth details of DDT can be found in
the <a class="reference external" href="https://www.linaroforge.com/documentation/" target="_blank">Official DDT User Guide</a>, and
instructions for how to use it on OLCF systems can be found on the <a class="reference internal" href="../software/debugging/index.html"><span class="doc">Debugging Software</span></a> page. DDT is the
OLCFs recommended debugging software for large parallel applications.</p>
<p>One of the most useful features of DDT is its remote debugging feature. This allows you to connect to a debugging session on Frontier from a client running on your workstation. The local client provides much faster interaction than you would have if using the graphical client on Frontier. For guidance in setting up the remote client see the <a class="reference internal" href="../software/debugging/index.html"><span class="doc">Debugging Software</span></a> page.</p>
</section>
<section id="gdb">
<h3>GDB<a class="headerlink" href="#gdb" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://www.gnu.org/software/gdb/" target="_blank">GDB</a>, the GNU Project Debugger,
is a command-line debugger useful for traditional debugging and
investigating code crashes. GDB lets you debug programs written in Ada,
C, C++, Objective-C, Pascal (and many other languages).</p>
<p>GDB is available on Summit under all compiler families:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">gdb</span>
</pre></div>
</div>
<p>To use GDB to debug your application run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdb</span> <span class="o">./</span><span class="n">path_to_executable</span>
</pre></div>
</div>
<p>Additional information about GDB usage can befound on the <a class="reference external" href="https://www.sourceware.org/gdb/documentation/" target="_blank">GDB Documentation Page</a>.</p>
</section>
<section id="valgrind">
<h3>Valgrind<a class="headerlink" href="#valgrind" title="Link to this heading"></a></h3>
<p><a class="reference external" href="http://valgrind.org" target="_blank">Valgrind</a> is an instrumentation framework for
building dynamic analysis tools. There are Valgrind tools that can
automatically detect many memory management and threading bugs, and
profile your programs in detail. You can also use Valgrind to build new
tools.</p>
<p>The Valgrind distribution currently includes five production-quality
tools: a memory error detector, a thread error detector, a cache and
branch-prediction profiler, a call-graph generating cache profiler,
and a heap profiler. It also includes two experimental tools: a data
race detector, and an instant memory leak detector.</p>
<p>The Valgrind tool suite provides a number of debugging and
profiling tools. The most popular is Memcheck, a memory checking tool
which can detect many common memory errors such as:</p>
<ul class="simple">
<li><p>Touching memory you shouldnt (eg. overrunning heap block boundaries,
or reading/writing freed memory).</p></li>
<li><p>Using values before they have been initialized.</p></li>
<li><p>Incorrect freeing of memory, such as double-freeing heap blocks.</p></li>
<li><p>Memory leaks.</p></li>
</ul>
<p>Valgrind is available on Summit under all compiler families:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">valgrind</span>
</pre></div>
</div>
<p>Additional information about Valgrind usage and OLCF-provided builds can
be found on the <a class="reference external" href="https://www.olcf.ornl.gov/software_package/valgrind/" target="_blank">Valgrind Software
Page</a>.</p>
</section>
</section>
<section id="optimizing-and-profiling">
<span id="id20"></span><h2>Optimizing and Profiling<a class="headerlink" href="#optimizing-and-profiling" title="Link to this heading"></a></h2>
<section id="profiling-gpu-code-with-nvidia-developer-tools">
<h3>Profiling GPU Code with NVIDIA Developer Tools<a class="headerlink" href="#profiling-gpu-code-with-nvidia-developer-tools" title="Link to this heading"></a></h3>
<p>NVIDIA provides developer tools for profiling any code that runs on NVIDIA
GPUs. These are the <a class="reference external" href="https://developer.nvidia.com/tools-overview" target="_blank">Nsight suite of developer tools</a>: NVIDIA Nsight Systems for
collecting a timeline of your application, and NVIDIA Nsight Compute for
collecting detailed performance information about specific GPU kernels.</p>
<section id="nvidia-nsight-systems">
<h4>NVIDIA Nsight Systems<a class="headerlink" href="#nvidia-nsight-systems" title="Link to this heading"></a></h4>
<p>The first step to GPU profiling is collecting a timeline of your application.
(This operation is also sometimes called tracing, that is, finding
the start and stop timestamps of all activities that occurred on the GPU
or involved the GPU, such as copying data back and forth.) To do this, we
can collect a timeline using the command-line interface, <code class="docutils literal notranslate"><span class="pre">nsys</span></code>. To use
this tool, load the <code class="docutils literal notranslate"><span class="pre">nsight-systems</span></code> module.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">module</span> <span class="n">load</span> <span class="n">nsight</span><span class="o">-</span><span class="n">systems</span>
</pre></div>
</div>
<p>For example, we can profile the <code class="docutils literal notranslate"><span class="pre">vectorAdd</span></code> CUDA sample (the CUDA samples
can be found in <code class="docutils literal notranslate"><span class="pre">$OLCF_CUDA_ROOT/samples</span></code> if the <code class="docutils literal notranslate"><span class="pre">cuda</span></code> module is loaded.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">g1</span> <span class="n">nsys</span> <span class="n">profile</span> <span class="o">-</span><span class="n">o</span> <span class="n">vectorAdd</span> <span class="o">--</span><span class="n">stats</span><span class="o">=</span><span class="n">true</span> <span class="o">./</span><span class="n">vectorAdd</span>
</pre></div>
</div>
<p>(Note that even if you do not ask for Nsight Systems to create an output file,
but just ask it to print summary statistics with <code class="docutils literal notranslate"><span class="pre">--stats=true</span></code>, it will create
a temporary file for storing the profiling data, so you will need to work on a
file system that can be written to from a compute node such as GPFS.)</p>
<p>The profiler will print several sections including information about the
CUDA API calls made by the application, as well as any GPU kernels that were
launched. Nsight Systems can be used for CUDA C++, CUDA Fortran, OpenACC,
OpenMP offload, and other programming models that target NVIDIA GPUs, because
under the hood they all ultimately take the same path for generating the binary
code that runs on the GPU.</p>
<p>If you add the <code class="docutils literal notranslate"><span class="pre">-o</span></code> option, as above, the report will be saved to file
with the extension <code class="docutils literal notranslate"><span class="pre">.qdrep</span></code>. That report file can later be analyzed in
the Nsight Systems UI by selecting File &gt; Open and locating the <code class="docutils literal notranslate"><span class="pre">vectorAdd.qdrep</span></code>
file on your filesystem. Nsight Systems does not currently have a Power9
version of the UI, so you will need to <a class="reference external" href="https://developer.nvidia.com/nsight-systems" target="_blank">download the UI for your local system</a>, which is supported on
Windows, Mac, and Linux (x86). Then use <code class="docutils literal notranslate"><span class="pre">scp</span></code> or some other file transfer
utility for copying the report file from Summit to your local machine.</p>
<p>Nsight Systems can be used for MPI runs with multiple ranks, but it is
not a parallel profiler and cannot combine output from multiple ranks.
Instead, each rank must be profiled and analyzed independently. The file
name should be unique for every rank. Nsight Systems knows how to parse
environment variables with the syntax <code class="docutils literal notranslate"><span class="pre">%q{ENV_VAR}</span></code>, and since Spectrum
MPI provides an environment variable for every process with its MPI rank,
you can do</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">jsrun</span> <span class="o">-</span><span class="n">n6</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">g1</span> <span class="n">nsys</span> <span class="n">profile</span> <span class="o">-</span><span class="n">o</span> <span class="n">vectorAdd_</span><span class="o">%</span><span class="n">q</span><span class="p">{</span><span class="n">OMPI_COMM_WORLD_RANK</span><span class="p">}</span> <span class="o">./</span><span class="n">vectorAdd</span>
</pre></div>
</div>
<p>Then you will have <code class="docutils literal notranslate"><span class="pre">vectorAdd_0.qdrep</span></code> through <code class="docutils literal notranslate"><span class="pre">vectorAdd_5.qdrep</span></code>.
(Of course, in this case each rank does the same thing as this is not
an MPI application, but it works the same way for an MPI code.)</p>
<p>For more details about Nsight Systems, consult the <a class="reference external" href="https://developer.nvidia.com/nsight-systems" target="_blank">product page</a> and the <a class="reference external" href="https://docs.nvidia.com/nsight-systems/index.html" target="_blank">documentation</a>. If you previously
used <code class="docutils literal notranslate"><span class="pre">nvprof</span></code> and would like to start using the Nsight Developer Tools,
check out <a class="reference external" href="https://devblogs.nvidia.com/migrating-nvidia-nsight-tools-nvvp-nvprof/" target="_blank">this transition guide</a>.
Also, in March 2020 NVIDIA presented a webinar on Nsight Systems which you
can <a class="reference external" href="https://www.olcf.ornl.gov/calendar/nvidia-profiling-tools-nsight-systems/" target="_blank">watch on demand</a>.</p>
</section>
<section id="nvidia-nsight-compute">
<h4>NVIDIA Nsight Compute<a class="headerlink" href="#nvidia-nsight-compute" title="Link to this heading"></a></h4>
<p>Individual GPU kernels (the discrete chunks of work that are launched by
programming languages such as CUDA and OpenACC) can be profiled in detail
with NVIDIA Nsight Compute. The typical workflow is to profile your code
with Nsight Systems and identify the major performance bottleneck in your
application. If that performance bottleneck is on the CPU, it means more
code should be ported to the GPU; or, if that bottleneck is in memory
management, such as copying data back and forth between the CPU and GPU,
you should look for opportunities to reduce that data motion. But if that
bottleneck is a GPU kernel, then Nsight Compute can be used to collect
performance counters to understand whether the kernel is running efficiently
and if theres anything you can do to improve.</p>
<p>The Nsight Compute command-line interface, <code class="docutils literal notranslate"><span class="pre">nv-nsight-cu-cli</span></code>, can be
prefixed to your application to collect a report.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">module</span> <span class="n">load</span> <span class="n">nsight</span><span class="o">-</span><span class="n">compute</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">g1</span> <span class="n">nv</span><span class="o">-</span><span class="n">nsight</span><span class="o">-</span><span class="n">cu</span><span class="o">-</span><span class="n">cli</span> <span class="o">./</span><span class="n">vectorAdd</span>
</pre></div>
</div>
<p>Similar to Nsight Systems, Nsight Compute will create a temporary report file,
even when <code class="docutils literal notranslate"><span class="pre">-o</span></code> is not specified.</p>
<p>The most important output to look at is the GPU Speed of Light section,
which tells you what fraction of peak memory throughput and what fraction
of peak compute throughput you achieved. Typically if you have achieved
higher than 60% of the peak of either subsystem, your kernel would be
considered memory-bound or compute-bound (respectively), and if you have
not achieved 60% of either this is often a latency-bound kernel. (A common
cause of latency issues is not exposing enough parallelism to saturate
the GPUs compute capacity  peak GPU performance can only be achieved when
there is enough work to hide the latency of memory accesses and to keep all
compute pipelines busy.)</p>
<p>By default, Nsight Compute will collect this performance data for every kernel
in your application. This will take a long time in a real-world application.
It is recommended that you identify a specific kernel to profile and then use
the <code class="docutils literal notranslate"><span class="pre">-k</span></code> argument to just profile that kernel. (If you dont know the name of
your kernel, use <code class="docutils literal notranslate"><span class="pre">nsys</span></code> to obtain that. The flag will pattern match on any
substring of the kernel name.) You can also use the <code class="docutils literal notranslate"><span class="pre">-s</span></code> option to skip some
number of kernel calls and the <code class="docutils literal notranslate"><span class="pre">-c</span></code> option to specify how many invocations of
that kernel you want to profile.</p>
<p>If you want to collect information on just a specific performance measurement,
for example the number of bytes written to DRAM, you can do so with the
<code class="docutils literal notranslate"><span class="pre">--metrics</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">g1</span> <span class="n">nv</span><span class="o">-</span><span class="n">nsight</span><span class="o">-</span><span class="n">cu</span><span class="o">-</span><span class="n">cli</span> <span class="o">-</span><span class="n">k</span> <span class="n">vectorAdd</span> <span class="o">--</span><span class="n">metrics</span> <span class="n">dram__bytes_write</span><span class="o">.</span><span class="n">sum</span> <span class="o">./</span><span class="n">vectorAdd</span>
</pre></div>
</div>
<p>The list of available metrics can be obtained with <code class="docutils literal notranslate"><span class="pre">nv-nsight-cu-cli</span>
<span class="pre">--query-metrics</span></code>. Most metrics have both a base name and suffix. Together
these  make up the full metric name to pass to <code class="docutils literal notranslate"><span class="pre">nv-nsight-cu-cli</span></code>. To list
the full names for a collection of metrics, use <code class="docutils literal notranslate"><span class="pre">--query-metrics-mode</span> <span class="pre">suffix</span>
<span class="pre">--metrics</span> <span class="pre">&lt;metrics</span> <span class="pre">list&gt;</span></code>.</p>
<p>As with Nsight Systems, there is a graphical user interface you can load a
report file into (The GUI is only available for Windows, x86_64 Linux and Mac).
Use the <code class="docutils literal notranslate"><span class="pre">-o</span></code> flag to create a file (the added report extension will be
<code class="docutils literal notranslate"><span class="pre">.nsight-cuprof-report</span></code>), copy it to your local system, and use the File &gt;
Open File menu item. If you are using multiple MPI ranks, make sure you name
each one independently. Nsight Compute does not yet support the <code class="docutils literal notranslate"><span class="pre">%q</span></code> syntax
(this will come in a future release), so your job script will have to do the
naming manually; for example, you can create a simple shell script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat run.sh
#!/bin/bash

nv-nsight-cu-cli -o vectorAdd_$OMPI_COMM_WORLD_RANK ./vectorAdd
</pre></div>
</div>
<p>For more details on Nsight Compute, check out the <a class="reference external" href="https://developer.nvidia.com/nsight-compute" target="_blank">product page</a> and the <a class="reference external" href="https://docs.nvidia.com/nsight-compute/index.html" target="_blank">documentation</a>. If you previously used
<code class="docutils literal notranslate"><span class="pre">nvprof</span></code> and would like to start using Nsight Compute, check out <a class="reference external" href="https://docs.nvidia.com/nsight-compute/NsightComputeCli/index.html#nvprof-guide" target="_blank">this transition
guide</a>.
Also, in March 2020 NVIDIA presented a webinar on Nsight Compute which you can <a class="reference external" href="https://www.olcf.ornl.gov/calendar/nvidia-profiling-tools-nsight-compute/" target="_blank">watch on
demand</a>.</p>
</section>
<section id="nvprof-and-nvvp">
<h4>nvprof and nvvp<a class="headerlink" href="#nvprof-and-nvvp" title="Link to this heading"></a></h4>
<p>Prior to Nsight Systems and Nsight Compute, the NVIDIA command line profiling
tool was <code class="docutils literal notranslate"><span class="pre">nvprof</span></code>, which provides both tracing and kernel profiling
capabilities. Like with Nsight Systems and Nsight Compute, the profiler data
output can be saved and imported into the NVIDIA Visual Profiler for additional
graphical analysis. <code class="docutils literal notranslate"><span class="pre">nvprof</span></code> is in maintenance mode now: it still works on
Summit and significant bugs will be fixed, but no new feature development is
occurring on this tool.</p>
<p>To use <code class="docutils literal notranslate"><span class="pre">nvprof</span></code>, the <code class="docutils literal notranslate"><span class="pre">cuda</span></code> module must be loaded.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">module</span> <span class="n">load</span> <span class="n">cuda</span>
</pre></div>
</div>
<p>A simple Hello, World! run using <code class="docutils literal notranslate"><span class="pre">nvprof</span></code> can be done by adding
nvprof to the jsrun (see: <a class="reference internal" href="#job-launcher-jsrun"><span class="std std-ref">Job Launcher (jsrun)</span></a>)
line in your batch script (see <a class="reference internal" href="#batch-scripts"><span class="std std-ref">Batch Scripts</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">g1</span> <span class="n">nvprof</span> <span class="o">./</span><span class="n">hello_world_gpu</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Although <code class="docutils literal notranslate"><span class="pre">nvprof</span></code> doesnt provide aggregated MPI data, the <code class="docutils literal notranslate"><span class="pre">%h</span></code> and
<code class="docutils literal notranslate"><span class="pre">%p</span></code> output file modifiers can be used to create separate output files
for each host and process.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">g1</span> <span class="n">nvprof</span> <span class="o">-</span><span class="n">o</span> <span class="n">output</span><span class="o">.%</span><span class="n">h</span><span class="o">.%</span><span class="n">p</span> <span class="o">./</span><span class="n">hello_world_gpu</span>
<span class="o">...</span>
</pre></div>
</div>
<p>There are many various metrics and events that the profiler can capture.
For example, to output the number of double-precision FLOPS, you may use
the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">jsrun</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">a1</span> <span class="o">-</span><span class="n">g1</span> <span class="n">nvprof</span> <span class="o">--</span><span class="n">metrics</span> <span class="n">flops_dp</span> <span class="o">-</span><span class="n">o</span> <span class="n">output</span><span class="o">.%</span><span class="n">h</span><span class="o">.%</span><span class="n">p</span> <span class="o">./</span><span class="n">hello_world_gpu</span>
<span class="o">...</span>
</pre></div>
</div>
<p>To see a list of all available metrics and events, use the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summit</span><span class="o">&gt;</span> <span class="n">nvprof</span> <span class="o">--</span><span class="n">query</span><span class="o">-</span><span class="n">metrics</span>
<span class="n">summit</span><span class="o">&gt;</span> <span class="n">nvprof</span> <span class="o">--</span><span class="n">query</span><span class="o">-</span><span class="n">events</span>
</pre></div>
</div>
<p>While using <code class="docutils literal notranslate"><span class="pre">nvprof</span></code> on the command-line is a quick way to gain
insight into your CUDA application, a full visual profile is often even
more useful. For information on how to view the output of <code class="docutils literal notranslate"><span class="pre">nvprof</span></code> in
the NVIDIA Visual Profiler, see the <a class="reference external" href="http://docs.nvidia.com/cuda/profiler-users-guide/#nvprof-overview" target="_blank">NVIDIA
Documentation</a>.</p>
</section>
</section>
<section id="score-p">
<h3>Score-P<a class="headerlink" href="#score-p" title="Link to this heading"></a></h3>
<p>The <a class="reference external" href="http://score-p.org/" target="_blank">Score-P</a> measurement infrastructure is a
highly scalable and easy-to-use tool suite for profiling, event
tracing, and online analysis of HPC applications. Score-P supports
analyzing C, C++ and Fortran applications that make use of
multi-processing (MPI, SHMEM), thread parallelism (OpenMP, PThreads) and
accelerators (CUDA, OpenCL, OpenACC) and combinations.</p>
<p>For detailed information about using Score-P on Summit and the
builds available, please see the
<a class="reference external" href="https://www.olcf.ornl.gov/software_package/score-p/" target="_blank">Score-P Software Page.</a></p>
</section>
<section id="vampir">
<h3>Vampir<a class="headerlink" href="#vampir" title="Link to this heading"></a></h3>
<p><a class="reference external" href="http://vampir.eu/" target="_blank">Vampir</a> is a software performance visualizer focused on highly
parallel applications. It presents a unified view on an application
run including the use of programming paradigms like MPI, OpenMP,
PThreads, CUDA, OpenCL and OpenACC. It also incorporates file I/O,
hardware performance counters and other performance data sources.
Various interactive displays offer detailed insight into the performance
behavior of the analyzed application. Vampirs scalable analysis
server and visualization engine enable interactive navigation of
large amounts of performance data. <a class="reference external" href="https://olcf.ornl.gov/software_package/score-p" target="_blank">Score-P</a>
and <a class="reference external" href="https://www.olcf.ornl.gov/software_package/tau" target="_blank">TAU</a> generate OTF2
trace files for Vampir to visualize.</p>
<p>For detailed information about using Vampir on Summit and the builds available,
please see the <a class="reference external" href="https://www.olcf.ornl.gov/software_package/vampir/" target="_blank">Vampir Software Page</a>.</p>
</section>
<section id="hpctoolkit">
<h3>HPCToolkit<a class="headerlink" href="#hpctoolkit" title="Link to this heading"></a></h3>
<p><a class="reference external" href="http://hpctoolkit.org/" target="_blank">HPCToolkit</a> is an integrated suite of tools for measurement and analysis of program performance on computers ranging from multicore desktop systems to the nations largest supercomputers. HPCToolkit provides accurate measurements of a programs work, resource consumption, and inefficiency, correlates these metrics with the programs source code, works with multilingual, fully optimized binaries, has very low measurement overhead, and scales to large parallel systems. HPCToolkits measurements provide support for analyzing a program execution cost, inefficiency, and scaling characteristics both within and across nodes of a parallel system.</p>
<p>Programming models supported by HPCToolkit include MPI, OpenMP, OpenACC, CUDA, OpenCL, DPC++, HIP, RAJA, Kokkos, and others.</p>
<p>Below is an example that generates a profile and loads the results in their GUI-based viewer.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module<span class="w"> </span>use<span class="w"> </span>/gpfs/alpine/csc322/world-shared/modulefiles/ppc64le
module<span class="w"> </span>load<span class="w"> </span>hpctoolkit

<span class="c1"># 1. Profile and trace an application using CPU time and GPU performance counters</span>
jsrun<span class="w"> </span>&lt;jsrun_options&gt;<span class="w"> </span>hpcrun<span class="w"> </span>-o<span class="w"> </span>&lt;measurement_dir&gt;<span class="w"> </span>-t<span class="w"> </span>-e<span class="w"> </span>CPUTIME<span class="w"> </span>-e<span class="w"> </span><span class="nv">gpu</span><span class="o">=</span>nvidia<span class="w"> </span>&lt;application&gt;

<span class="c1"># 2. Analyze the binary of executables and its dependent libraries</span>
hpcstruct<span class="w"> </span>&lt;measurement_dir&gt;

<span class="c1"># 3. Combine measurements with program structure information and generate a database</span>
hpcprof<span class="w"> </span>-o<span class="w"> </span>&lt;database_dir&gt;<span class="w"> </span>&lt;measurement_dir&gt;

<span class="c1"># 4. Understand performance issues by analyzing profiles and traces with the GUI</span>
hpcviewer<span class="w"> </span>&lt;database_dir&gt;
</pre></div>
</div>
<p>A quick summary of HPCToolkit options can be found in the <a class="reference external" href="https://gitlab.com/hpctoolkit/hpctoolkit/-/wikis/HPCToolkit-cheat-sheet" target="_blank">HPCTookit wiki page</a>. More detailed information on HPCToolkit can be found in the <a class="reference external" href="http://hpctoolkit.org/manual/HPCToolkit-users-manual.pdf" target="_blank">HPCToolkit Users Manual</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>HPCToolkit does not require a recompile to profile the code. It is recommended to use the -g optimization flag for attribution to source lines.</p>
</div>
</section>
</section>
<section id="nvidia-tesla-v100">
<span id="nvidia-v100-gpus"></span><span id="id21"></span><h2>NVIDIA V100 GPUs<a class="headerlink" href="#nvidia-tesla-v100" title="Link to this heading"></a></h2>
<p>The NVIDIA Tesla V100 accelerator has a peak performance of 7.8 TFLOP/s
(double-precision) and contributes to a majority of the computational
work performed on Summit. Each V100 contains 80 streaming
multiprocessors (SMs), 16 GB (32 GB on high-memory nodes) of high-bandwidth
memory (HBM2), and a 6 MB L2 cache that is available to the SMs. The
GigaThread Engine is responsible for distributing work among the SMs and
(8) 512-bit memory controllers control access to the 16 GB (32 GB on
high-memory nodes) of HBM2 memory. The V100 uses NVIDIAs NVLink interconnect
to pass data between GPUs as well as from CPU-to-GPU.</p>
<img alt="../_images/GV100_FullChip_Diagram_FINAL2_a.png" class="align-center" src="../_images/GV100_FullChip_Diagram_FINAL2_a.png" />
<section id="nvidia-v100-sm">
<h3>NVIDIA V100 SM<a class="headerlink" href="#nvidia-v100-sm" title="Link to this heading"></a></h3>
<p>Each SM on the V100 contains 32 FP64 (double-precision) cores, 64 FP32
(single-precision) cores, 64 INT32 cores, and 8 tensor cores. A 128-KB
combined memory block for shared memory and L1 cache can be configured
to allow up to 96 KB of shared memory. In addition, each SM has 4
texture units which use the (configured size of the) L1 cache.</p>
<img alt="../_images/GV100_SM_Diagram-FINAL2.png" class="align-center" src="../_images/GV100_SM_Diagram-FINAL2.png" />
</section>
<section id="hbm2">
<h3>HBM2<a class="headerlink" href="#hbm2" title="Link to this heading"></a></h3>
<p>Each V100 has access to 16 GB (32GB for high-memory nodes) of
high-bandwidth memory (HBM2), which can be accessed at speeds of
up to 900 GB/s. Access to this memory is controlled by (8) 512-bit
memory controllers, and all accesses to the high-bandwidth memory
go through the 6 MB L2 cache.</p>
</section>
<section id="nvidia-nvlink">
<h3>NVIDIA NVLink<a class="headerlink" href="#nvidia-nvlink" title="Link to this heading"></a></h3>
<p>The processors within a node are connected by NVIDIAs NVLink
interconnect. Each link has a peak bandwidth of 25 GB/s (in each
direction), and since there are 2 links between processors, data can be
transferred from GPU-to-GPU and CPU-to-GPU at a peak rate of 50 GB/s.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The 50-GB/s peak bandwidth stated above is for data transfers
in a single direction. However, this bandwidth can be achieved in both
directions simultaneously, giving a peak bi-directional bandwidth of
100 GB/s between processors.</p>
</div>
<p>The figure below shows a schematic of the NVLink connections between the
CPU and GPUs on a single socket of a Summit node.</p>
<img alt="../_images/NVLink2.png" class="align-center" src="../_images/NVLink2.png" />
</section>
<section id="volta-multi-process-service">
<h3>Volta Multi-Process Service<a class="headerlink" href="#volta-multi-process-service" title="Link to this heading"></a></h3>
<p>When a CUDA program begins, each MPI rank creates a separate CUDA
context on the GPU, but the scheduler on the GPU only allows one CUDA
context (and so one MPI rank) at a time to launch on the GPU. This means
that multiple MPI ranks can share access to the same GPU, but each rank
gets exclusive access while the other ranks wait (time-slicing). This
can cause the GPU to become underutilized if a rank (that has exclusive
access) does not perform enough work to saturate the resources of the
GPU. The following figure depicts such time-sliced access to a pre-Volta
GPU.</p>
<img alt="../_images/nv_mps_1.png" class="align-center" src="../_images/nv_mps_1.png" />
<p>The Multi-Process Service (MPS) enables multiple processes (e.g. MPI ranks) to
<em>concurrently</em> share the resources on a single GPU. This is accomplished by
starting an MPS server process, which funnels the work from multiple CUDA
contexts (e.g. from multiple MPI ranks) into a single CUDA context. In some
cases, this can increase performance due to better utilization of the resources.
The figure below illustrates MPS on a pre-Volta GPU.</p>
<a class="reference internal image-reference" href="../_images/nv_mps_2.png"><img alt="../_images/nv_mps_2.png" class="align-center" src="../_images/nv_mps_2.png" style="width: 65.0%;" /></a>
<p>Volta GPUs improve MPS with new capabilities. For instance, each Volta
MPS client (MPI rank) is assigned a subcontext that has its own GPU
address space, instead of sharing the address space with other clients.
This isolation helps protect MPI ranks from out-of-range reads/writes
performed by other ranks within CUDA kernels. Because each subcontext
manages its own GPU resources, it can submit work directly to the GPU
without the need to first pass through the MPS server. In addition,
Volta GPUs support up to 48 MPS clients (up from 16 MPS clients on
Pascal).</p>
<a class="reference internal image-reference" href="../_images/nv_mps_3.png"><img alt="../_images/nv_mps_3.png" class="align-center" src="../_images/nv_mps_3.png" style="width: 65.0%;" /></a>
<p>For more information, please see the following document from NVIDIA:
<a class="reference external" href="https://docs.nvidia.com/deploy/pdf/CUDA_Multi_Process_Service_Overview.pdf" target="_blank">https://docs.nvidia.com/deploy/pdf/CUDA_Multi_Process_Service_Overview.pdf</a></p>
</section>
<section id="unified-memory">
<h3>Unified Memory<a class="headerlink" href="#unified-memory" title="Link to this heading"></a></h3>
<p>Unified memory is a single virtual address space that is accessible to
any processor in a system (within a node). This means that programmers
only need to allocate a single unified-memory pointer (e.g. using
cudaMallocManaged) that can be accessed by both the CPU and GPU, instead
of requiring separate allocations for each processor. This managed
memory is automatically migrated to the accessing processor, which
eliminates the need for explicit data transfers.</p>
<a class="reference internal image-reference" href="../_images/nv_um_1.png"><img alt="../_images/nv_um_1.png" class="align-center" src="../_images/nv_um_1.png" style="width: 60.0%;" /></a>
<p>On Pascal-generation GPUs and later, this automatic migration is
enhanced with hardware support. A page migration engine enables GPU page
faulting, which allows the desired pages to be migrated to the GPU on
demand instead of the entire managed allocation. In addition, 49-bit
virtual addressing allows programs using unified memory to access the
full system memory size. The combination of GPU page faulting and larger
virtual addressing allows programs to oversubscribe the system memory,
so very large data sets can be processed. In addition, new CUDA API
functions introduced in CUDA8 allow users to fine tune the use of
unified memory.</p>
<p>Unified memory is further improved on Volta GPUs through
the use of access counters that can be used to automatically tune
unified memory by determining where a page is most often accessed.</p>
<p>For more information, please see the following section of NVIDIAs
CUDA Programming Guide:
<a class="reference external" href="http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-unified-memory-programming-hd" target="_blank">http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-unified-memory-programming-hd</a></p>
</section>
<section id="independent-thread-scheduling">
<h3>Independent Thread Scheduling<a class="headerlink" href="#independent-thread-scheduling" title="Link to this heading"></a></h3>
<p>The V100 supports independent thread scheduling, which allows threads to
synchronize and cooperate at sub-warp scales. Pre-Volta GPUs implemented
warps (groups of 32 threads which execute instructions in
single-instruction, multiple thread - SIMT - mode) with a single call
stack and program counter for a warp as a whole.</p>
<img alt="../_images/nv_ind_threads_1.png" class="align-center" src="../_images/nv_ind_threads_1.png" />
<p>Within a warp, a mask is used to specify which threads are currently
active when divergent branches of code are encountered. The (active)
threads within each branch execute their statements serially before
threads in the next branch execute theirs. This means that programs on
pre-Volta GPUs should avoid sub-warp synchronization; a sync point in
the branches could cause a deadlock if all threads in a warp do not
reach the synchronization point.</p>
<img alt="../_images/nv_ind_threads_2.png" class="align-center" src="../_images/nv_ind_threads_2.png" />
<p>The Tesla V100 introduces warp-level synchronization by implementing warps with
a program counter and call stack for each individual thread (i.e.  independent
thread scheduling).</p>
<img alt="../_images/nv_ind_threads_3.png" class="align-center" src="../_images/nv_ind_threads_3.png" />
<p>This implementation allows threads to diverge and synchronize at the sub-warp
level using the __syncwarp() function. The independent thread scheduling
enables the thread scheduler to stall execution of any thread, allowing other
threads in the warp to execute different statements. This means that threads in
one branch can stall at a sync point and wait for the threads in the other
branch to reach their sync point.</p>
<img alt="../_images/nv_ind_threads_4.png" class="align-center" src="../_images/nv_ind_threads_4.png" />
<p>For more information, please see the following section of NVIDIAs CUDA
Programming Guide:
<a class="reference external" href="http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#independent-thread-scheduling-7-x" target="_blank">http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#independent-thread-scheduling-7-x</a></p>
</section>
<section id="tensor-cores">
<h3>Tensor Cores<a class="headerlink" href="#tensor-cores" title="Link to this heading"></a></h3>
<p>The Tesla V100 contains 640 tensor cores (8 per SM) intended to enable
faster training of large neural networks. Each tensor core performs a
<code class="docutils literal notranslate"><span class="pre">D</span> <span class="pre">=</span> <span class="pre">AB</span> <span class="pre">+</span> <span class="pre">C</span></code> operation on 4x4 matrices. A and B are FP16 matrices,
while C and D can be either FP16 or FP32:</p>
<a class="reference internal image-reference" href="../_images/nv_tensor_core_1.png"><img alt="../_images/nv_tensor_core_1.png" class="align-center" src="../_images/nv_tensor_core_1.png" style="width: 85.0%;" /></a>
<p>Each of the 16 elements that result from the AB matrix multiplication
come from 4 floating-point fused-multiply-add (FMA) operations
(basically a dot product between a row of A and a column of B). Each
FP16 multiply yields a full-precision product which is accumulated in a
FP32 result:</p>
<a class="reference internal image-reference" href="../_images/nv_tc_1.png"><img alt="../_images/nv_tc_1.png" class="align-center" src="../_images/nv_tc_1.png" style="width: 85.0%;" /></a>
<p>Each tensor core performs 64 of these FMA operations per clock. The 4x4
matrix operations outlined here can be combined to perform matrix
operations on larger (and higher dimensional) matrices.</p>
<section id="using-the-tensor-cores-on-summit">
<h4>Using the Tensor Cores on Summit<a class="headerlink" href="#using-the-tensor-cores-on-summit" title="Link to this heading"></a></h4>
<p>The NVIDIA Tesla V100 GPUs in Summit are capable of over 7TF/s of
double-precision and 15 TF/s of single-precision floating point performance.
Additionally, the V100 is capable of over 120 TF/s of half-precision floating
point performance when using its Tensor Core feature. The Tensor Cores are
purpose-built accelerators for half-precision matrix multiplication operations.
While they were designed especially to accelerate machine learning workflows,
they are exposed through several other APIs that are useful to other HPC
applications. This section provides information for using the V100 Tensor
Cores.</p>
<p>The V100 Tensor Cores perform a warp-synchronous multiply and accumulate of
16-bit matrices in the form of D = A * B + C. The operands of this matrix
multiplication are 16-bit A and B matrices, while the C and D accumulation
matrices may be 16 or 32-bit matrices with comparable performance for either
precision.</p>
<a class="reference internal image-reference" href="../_images/nv_tc_2.png"><img alt="../_images/nv_tc_2.png" class="align-center" src="../_images/nv_tc_2.png" style="width: 85.0%;" /></a>
<p>Half precision floating point representation has a dramatically lower range of
numbers than Double or Single precision. Half precision representation consists
of 1 sign bit, a 5-bit exponent, and a 10-bit mantissa. This results in a
dynamic range of 5.96e-8 to 65,504</p>
<section id="tensor-core-programming-models">
<h5>Tensor Core Programming Models<a class="headerlink" href="#tensor-core-programming-models" title="Link to this heading"></a></h5>
<p>This section details a variety of high and low-level Tensor Core programming
models. Which programming model is appropriate to a given application is highly
situational, so this document will present multiple programming models to allow
the reader to evaluate each for their merits within the needs of the
application.</p>
<section id="cublas-library">
<h6>cuBLAS Library<a class="headerlink" href="#cublas-library" title="Link to this heading"></a></h6>
<p>cuBLAS is NVIDIAs implementation of the Basic Linear Algebra Subroutines
library for GPUs. It contains not only the Level 1, 2, and 3 BLAS routines, but
several extensions to these routines that add important capabilities to the
library, such as the ability to batch operations and work with varying
precisions.</p>
<p>The cuBLAS libraries provides access to the TensorCores using 3 different
routines, depending on the application needs. The <a class="reference external" href="https://docs.nvidia.com/cuda/cublas/index.html#cublas-lt-t-gt-gemm" target="_blank">cublasHgemm</a> routine
performs a general matrix multiplication of half-precision matrices. The
numerical operands to this routine must be of type half and math mode must be
set to CUBLAS_TENSOR_OP_MATH to enable Tensor Core use. Additionally, if the
<a class="reference external" href="https://docs.nvidia.com/cuda/cublas/index.html#cublas-lt-t-gt-gemm" target="_blank">cublasSgemm</a> routine
will down-convert from single precision to half precision when the math mode is
set to CUBLAS_TENSOR_OP_MATH, enabling simple conversion from SGEMM to HGEMM
using Tensor Cores. For either of these two methods the <a class="reference external" href="https://docs.nvidia.com/cuda/cublas/index.html#cublassetmathmode" target="_blank">cublasSetMathMode</a> function
must be used to change from CUBLAS_DEFAULT_MATH to CUBLAS_TENSOR_OP_MATH mode.</p>
<p>cuBLAS provides a non-standard extension of GEMM with the <a class="reference external" href="https://docs.nvidia.com/cuda/cublas/index.html#cublas-GemmEx" target="_blank">cublasGemmEx</a> routine, which
provides additional flexibility about the data types of the operands. In
particular, the A, B, and C matrices can be of arbitrary and different types,
with the types of each declared using the Atype, Btype, and Ctype parameters.
The algo parameter works similar to the math mode above. If the math mode is
set to CUBLAS_TESNOR_OP_MATH and the algo parameter is set to
CUBLAS_GEMM_DEFAULT, then the Tensor Cores will be used. If algo is
CUBLAS_GEMM_DEFAULT_TENSOR_OP or CUBLAS_GEMM_ALGO{0-15}_TENSOR_OP, then the
Tensor Cores will be used regardless of the math setting. The table below
outlines the rules stated in the past two paragraphs.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">mathMode</span> <span class="pre">=</span> <span class="pre">CUBLAS_DEFAULT_MATH</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">mathMode</span> <span class="pre">=</span> <span class="pre">CUBLAS_TENSOR_OP_MATH</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cublasHgemm,</span> <span class="pre">cublasSgemm,</span> <span class="pre">cublasGemmEx(algo=DEFAULT)</span></code></p></td>
<td><p>Disallowed</p></td>
<td><p>Allowed</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cublasGemmEx(algo=*_TENSOR_OP)</span></code></p></td>
<td><p>Allowed</p></td>
<td><p>Allowed</p></td>
</tr>
</tbody>
</table>
<p>When using any of these methods to access the Tensor Cores, the M, N, K, LDA,
LDB, LDC, and A, B, and C pointers must all be aligned to 8 bytes due to the
high bandwidth necessary to utilize the Tensor Cores effective.</p>
<p>Many of the routines listed above are also available in batched form, see the
<a class="reference external" href="https://docs.nvidia.com/cuda/cublas/index.html" target="_blank">cuBLAS documentation</a> for
more information. Advanced users wishing to have increased control over the
specifics of data layout, type, and underlying algorithms may wish to use the
more advanced <a class="reference external" href="https://docs.nvidia.com/cuda/cublas/index.html#using-the-cublasLt-api" target="_blank">cuBLAS-Lt interface</a>. This
interface uses the same underlying GPU kernels, but provides developers with a
higher degree of control.</p>
</section>
<section id="iterative-refinement-of-linear-solvers">
<h6>Iterative Refinement of Linear Solvers<a class="headerlink" href="#iterative-refinement-of-linear-solvers" title="Link to this heading"></a></h6>
<p>Iterative Refinement is a technique for performing linear algebra solvers in a
reduced precision, then iterating to improve the results and return them to
full precision. This technique has been used for several years to use 32-bit
math operations and achieve 64-bit results, which often results in a speed-up
due to single precision math often have a 2X performance advantage on modern
CPUs and many GPUs. NVIDIA and the University of Tennessee have been working to
extend this technique to perform operations in half-precision and obtain higher
precision results. One such place where this technique has been applied is in
calculating an LU factorization of the linear system Ax = B. This operation is
dominated by a matrix multiplication operation, which is illustrated in green
in the image below. It is possible to perform the GEMM operations at a reduced
precision, while leaving the panel and trailing matrices in a higher precision.
This technique allows for the majority of the math operations to be done at the
higher FP16 throughput. The matrix used in the GEMM is generally not square,
which is often the best performing GEMM operation, but is referred to as rank-k
and generally still very fast when using matrix multiplication libraries.</p>
<a class="reference internal image-reference" href="../_images/nv_tc_3.png"><img alt="../_images/nv_tc_3.png" class="align-center" src="../_images/nv_tc_3.png" style="width: 85.0%;" /></a>
<p>A summary of the algorithm used for calculating in mixed precision is in the
following image.</p>
<a class="reference internal image-reference" href="../_images/nv_tc_4.png"><img alt="../_images/nv_tc_4.png" class="align-center" src="../_images/nv_tc_4.png" style="width: 85.0%;" /></a>
<p>We see in the graph below that it is possible to achieved a 3-4X performance
improvement over the double-precision solver, while achieving the same level of
accuracy. It has also been observed that the use of Tensor Cores makes the
problem more likely to converge than strict half-precision GEMMs due to the
ability to accumulate into 32-bit results.</p>
<a class="reference internal image-reference" href="../_images/nv_tc_5.png"><img alt="../_images/nv_tc_5.png" class="align-center" src="../_images/nv_tc_5.png" style="width: 85.0%;" /></a>
<p>NVIDIA will be shipping official support for IR solvers in their cuSOLVER
library in the latter half of 2019. The image below provides estimated release
dates, which are subject to change.</p>
<a class="reference internal image-reference" href="../_images/nv_tc_6.png"><img alt="../_images/nv_tc_6.png" class="align-center" src="../_images/nv_tc_6.png" style="width: 85.0%;" /></a>
</section>
<section id="automatic-mixed-precision-amp-in-machine-learning-frameworks">
<h6>Automatic Mixed Precision (AMP) in Machine Learning Frameworks<a class="headerlink" href="#automatic-mixed-precision-amp-in-machine-learning-frameworks" title="Link to this heading"></a></h6>
<p>NVIDIA has a Training With Mixed Precision guide available for developers
wishing to explicitly use mixed precision and Tensor Cores in their training of
neural networks. This is a good place to start when investigating Tensor Cores
for machine learning applications. Developers should specifically read the
Optimizing For Tensor Cores section.</p>
<p>NVIDIA has also integrated a technology called Automatic Mixed Precision (AMP)
into several common frameworks, TensorFlow, PyTorch, and MXNet at time of
writing. In most cases AMP can be enabled via a small code change or via
setting and environment variable. AMP does not strictly replace all matrix
multiplication operations with half precision, but uses graph optimization
techniques to determine whether a given layer is best run in full or half
precision.</p>
<p>Examples are provided for using AMP, but the following sections summarize the
usage in the three supported frameworks.</p>
<section id="tensorflow">
<h6 aria-level="7">TensorFlow<a class="headerlink" href="#tensorflow" title="Link to this heading"></a></h6>
<p>With TensorFlow AMP can be enabled using one of the following techniques.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TF_ENABLE_AUTO_MIXED_PRECISION&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
</pre></div>
</div>
<p>OR</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">TF_ENABLE_AUTO_MIXED_PRECISION</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>Explicit optimizer wrapper available in NVIDIA Container 19.07+, TF 1.14+, TF
2.0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">enable_mixed_precision_graph_rewrite</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="pytorch">
<h6 aria-level="7">PyTorch<a class="headerlink" href="#pytorch" title="Link to this heading"></a></h6>
<p>Adding the following to a PyTorch model will enable AMP:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span> <span class="o">=</span> <span class="n">amp</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">opt_level</span><span class="o">=</span><span class="s2">&quot;O1&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">amp</span><span class="o">.</span><span class="n">scale_loss</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">)</span> <span class="k">as</span> <span class="n">scaled_loss</span><span class="p">:</span>
  <span class="n">scaled_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="mxnet">
<h6 aria-level="7">MXNet<a class="headerlink" href="#mxnet" title="Link to this heading"></a></h6>
<p>The code below will enable AMP for MXNet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">amp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="n">amp</span><span class="o">.</span><span class="n">init_trainer</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
<span class="k">with</span> <span class="n">amp</span><span class="o">.</span><span class="n">scale_loss</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span> <span class="k">as</span> <span class="n">scaled_loss</span><span class="p">:</span>
  <span class="n">autograd</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">scaled_loss</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="wmma">
<h6>WMMA<a class="headerlink" href="#wmma" title="Link to this heading"></a></h6>
<p>The Warp Matrix Multiply and Accumulate (WMMA) API was introduced in CUDA 9
explicitly for programming the Tesla V100 Tensor Cores. This is a low-level API
that supports loading matrix data into fragments within the threads of a warp,
applying a Tensor Core multiplication on that data, and then restoring it to
the main GPU memory. This API is called within CUDA kernels and all WMMA
operations are warp-synchronous, meaning the threads in a warp will leave the
operation synchronously. Examples are available for using the WMMA instructions
in C++ and CUDA Fortran. The image below demonstrates the general pattern for
WMMA usage.</p>
<a class="reference internal image-reference" href="../_images/nv_tc_7.png"><img alt="../_images/nv_tc_7.png" class="align-center" src="../_images/nv_tc_7.png" style="width: 85.0%;" /></a>
<p>The example above performs a 16-bit accumulate operation, but 32-bit is also
supported. Please see the provided samples and the <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#wmma" target="_blank">WMMA documentation</a> for
more details.</p>
<p>CUDA 10 introduced a lower-level alternative to WMMA with the mma.sync()
instruction. This is a very low-level instruction that requires the programmer
handle the data movement provided by WMMA explicitly, but is capable of higher
performance. Details of <a class="reference external" href="https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#warp-level-matrix-instructions-wmma-mma" target="_blank">mma.sync</a>
can be found in the PTX documentation and examples for using this feature via
CUTLASS cane be found in the second half of this <a class="reference external" href="https://on-demand-gtc.gputechconf.com/gtcnew/sessionview.php?sessionName=s9593-cutensor%3a+high-performance+tensor+operations+in+cuda" target="_blank">GTC presentation</a>.</p>
</section>
<section id="cutlass">
<h6>CUTLASS<a class="headerlink" href="#cutlass" title="Link to this heading"></a></h6>
<p><a class="reference external" href="https://github.com/nvidia/cutlass/" target="_blank">CUTLASS</a> is an open-source library
provided by NVIDIA for building matrix multiplication operations using C++
templates. The goal is to provide performance that is nearly as good as the
hand-tuned cuBLAS library, but in a more expressive, composible manner.</p>
<p>The CUTLASS library provides a variety of primitives that are optimized for
proper data layout and movement to achieve the maximum possible performance of
a matrix multiplation on an NVIDIA GPU. These include iterators for blocking,
loading, and storing matrix tiles, plus optimized classes for transforming the
data and performing the actual multiplication. CUTLASS provides <a class="reference external" href="https://github.com/NVIDIA/cutlass/blob/master/CUTLASS.md" target="_blank">extensive
documentation</a> of
these features and examples have been provided. Interested developers are also
encouraged to watch the <a class="reference external" href="https://on-demand-gtc.gputechconf.com/gtcnew/sessionview.php?sessionName=s8854-cutlass%3a+software+primitives+for+dense+linear+algebra+at+all+levels+and+scales+within+cuda" target="_blank">CUTLASS introduction video</a>
from GTC2018.</p>
</section>
</section>
<section id="measuring-tensor-core-utilization">
<h5>Measuring Tensor Core Utilization<a class="headerlink" href="#measuring-tensor-core-utilization" title="Link to this heading"></a></h5>
<p>When attempting to use Tensor Cores it is useful to measure and confirm that
the Tensor Cores are being used within your code. For implicit use via a
library like cuBLAS, the Tensor Cores will only be used above a certain
threshold, so Tensor Core use should not be assumed. The NVIDIA Tools provide a
performance metric to measure Tensor Core utilization on a scale from 0 (Idle)
to 10 (Max) utilization.</p>
<p>When using NVIDIAs nvprof profiler, one should add the <cite>-m
tensor_precision_fu_utilization</cite> option to measure Tensor Core utilization.
Below is the output from measuring this metric on one of the example programs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ nvprof -m tensor_precision_fu_utilization ./simpleCUBLAS
==43727== NVPROF is profiling process 43727, command: ./simpleCUBLAS
GPU Device 0: &quot;Tesla V100-SXM2-16GB&quot; with compute capability 7.0

simpleCUBLAS test running..
simpleCUBLAS test passed.
==43727== Profiling application: ./simpleCUBLAS
==43727== Profiling result:
==43727== Metric result:
Invocations                               Metric Name                           Metric Description         Min         Max         Avg
Device &quot;Tesla V100-SXM2-16GB (0)&quot;
    Kernel: volta_h884gemm_128x64_ldg8_nn
          1           tensor_precision_fu_utilization   Tensor-Precision Function Unit Utilization     Low (3)     Low (3)     Low (3)
</pre></div>
</div>
<p>NVIDIAs Nsight Compute may also be used to measure tensor core utilization via
the sm__pipe_tensor_cycles_active.avg.pct_of_peak_sustained_active metric, as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ nv-nsight-cu-cli --metrics sm__pipe_tensor_cycles_active.avg.pct_of_peak_sustained_active ./cudaTensorCoreGemm

[  compute_gemm, 2019-Aug-08 12:48:39, Context 1, Stream 7
      Section: Command line profiler metrics
      ----------------------------------------------------------------------
      sm__pipe_tensor_cycles_active.avg.pct_of_peak_sustained_active                    %                       43.44
      ----------------------------------------------------------------------
</pre></div>
</div>
</section>
<section id="when-to-try-tensor-cores">
<h5>When to Try Tensor Cores<a class="headerlink" href="#when-to-try-tensor-cores" title="Link to this heading"></a></h5>
<p>Tensor Cores provide the potential for an enormous performance boost over
full-precision operations, but when their use is appropriate is highly
application and even problem independent. Iterative Refinement techniques can
suffer from slow or possible a complete lack of convergence if the condition
number of the matrix is very large. By using Tensor Cores, which support 32-bit
accumulation, rather than strict 16-bit math operations, iterative refinement
becomes a viable option in a much larger number of cases, so it should be
attempted when an application is already using a supported solver.</p>
<p>Even if iterative techniques are not available for an application, direct use
of Tensor Cores may be beneficial if at least the A and B matrices can be
constructed from the input data without significant loss of precision. Since
the C and D matrices may be 32-bit, the output may have a higher degree of
precision than the input. It may be possible to try these operations
automatically by setting the math mode in cuBLAS, as detailed above, to
determine whether the loss of precision is an acceptable trade-off for
increased performance in a given application. If it is, the cublasGemmEx API
allows the programmer to control when the conversion to 16-bit occurs, which
may result in higher throughput than allowing the cuBLAS library to do the
conversion at call time.</p>
<p>Some non-traditional uses of Tensor Cores can come from places where integers
that fall within the FP16 range are used in an application. For instance, in
Attacking the Opioid Epidemic: Determining the Epistatic and Pleiotropic
Genetic Architectures for Chronic Pain and Opioid Addiction, a 2018 Gordon
Bell Prize-winning paper, the authors used Tensor Cores in place of small
integers, allowing them very high performance over performing the same
calculation in integer space. This technique is certainly not applicable to all
applications, but does show that Tensor Cores may be used in algorithms that
might not have been represented by a floating point matrix multiplication
otherwise.</p>
<p>Lastly, when performing the training step of a deep learning application it is
often beneficial to do at least some of the layer calculations in reduced
precision. The AMP technique described above can be tried with little to know
code changes, making it highly advisable to attempt in any machine learning
application.</p>
</section>
<section id="tensor-core-examples-and-other-materials">
<h5>Tensor Core Examples and Other Materials<a class="headerlink" href="#tensor-core-examples-and-other-materials" title="Link to this heading"></a></h5>
<p>NVIDIA has provided several example codes for using Tensor Cores from a variety
of the APIs listed above. These examples can be found on <a class="reference external" href="https://github.com/olcf/NVIDIA-tensor-core-examples" target="_blank">GitHub</a>.</p>
<p>NVIDIA Tensor Core Workshop (August 2018): <a class="reference external" href="https://www.olcf.ornl.gov/wp-content/uploads/2019/11/ORNL_Tensor_Core_Training_Aug2019.pdf" target="_blank">slides</a>,
recording (coming soon)</p>
</section>
</section>
</section>
<section id="tesla-v100-specifications">
<h3>Tesla V100 Specifications<a class="headerlink" href="#tesla-v100-specifications" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Compute Capability</p></td>
<td><p>7.0</p></td>
</tr>
<tr class="row-even"><td><p>Peak double precision floating point performance</p></td>
<td><p>7.8 TFLOP/s</p></td>
</tr>
<tr class="row-odd"><td><p>Peak single precision floating point performance</p></td>
<td><p>15.7 TFLOP/s</p></td>
</tr>
<tr class="row-even"><td><p>Single precision CUDA cores</p></td>
<td><p>5120</p></td>
</tr>
<tr class="row-odd"><td><p>Double precision CUDA cores</p></td>
<td><p>2560</p></td>
</tr>
<tr class="row-even"><td><p>Tensor cores</p></td>
<td><p>640</p></td>
</tr>
<tr class="row-odd"><td><p>Clock frequency</p></td>
<td><p>1530 MHz</p></td>
</tr>
<tr class="row-even"><td><p>Memory Bandwidth</p></td>
<td><p>900 GB/s</p></td>
</tr>
<tr class="row-odd"><td><p>Memory size (HBM2)</p></td>
<td><p>16 or 32 GB</p></td>
</tr>
<tr class="row-even"><td><p>L2 cache</p></td>
<td><p>6 MB</p></td>
</tr>
<tr class="row-odd"><td><p>Shared memory size / SM</p></td>
<td><p>Configurable up to 96 KB</p></td>
</tr>
<tr class="row-even"><td><p>Constant memory</p></td>
<td><p>64 KB</p></td>
</tr>
<tr class="row-odd"><td><p>Register File Size</p></td>
<td><p>256 KB (per SM)</p></td>
</tr>
<tr class="row-even"><td><p>32-bit Registers</p></td>
<td><p>65536 (per SM)</p></td>
</tr>
<tr class="row-odd"><td><p>Max registers per thread</p></td>
<td><p>255</p></td>
</tr>
<tr class="row-even"><td><p>Number of multiprocessors (SMs)</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>Warp size</p></td>
<td><p>32 threads</p></td>
</tr>
<tr class="row-even"><td><p>Maximum resident warps per SM</p></td>
<td><p>64</p></td>
</tr>
<tr class="row-odd"><td><p>Maximum resident blocks per SM</p></td>
<td><p>32</p></td>
</tr>
<tr class="row-even"><td><p>Maximum resident threads per SM</p></td>
<td><p>2048</p></td>
</tr>
<tr class="row-odd"><td><p>Maximum threads per block</p></td>
<td><p>1024</p></td>
</tr>
<tr class="row-even"><td><p>Maximum block dimensions</p></td>
<td><p>1024, 1024, 64</p></td>
</tr>
<tr class="row-odd"><td><p>Maximum grid dimensions</p></td>
<td><p>2147483647, 65535, 65535</p></td>
</tr>
<tr class="row-even"><td><p>Maximum number of MPS clients</p></td>
<td><p>48</p></td>
</tr>
</tbody>
</table>
</section>
<section id="further-reading">
<h3>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading"></a></h3>
<p>For more information on the NVIDIA Volta architecture, please visit the
following (outside) links.</p>
<ul class="simple">
<li><p><a class="reference external" href="http://images.nvidia.com/content/volta-architecture/pdf/volta-architecture-whitepaper.pdf" target="_blank">NVIDIA Volta Architecture White Paper</a></p></li>
<li><p><a class="reference external" href="https://devblogs.nvidia.com/parallelforall/inside-volta/" target="_blank">NVIDIA PARALLEL FORALL blog article</a></p></li>
</ul>
</section>
</section>
<section id="burst-buffer">
<span id="id23"></span><h2>Burst Buffer<a class="headerlink" href="#burst-buffer" title="Link to this heading"></a></h2>
<section id="nvme-xfs">
<h3>NVMe (XFS)<a class="headerlink" href="#nvme-xfs" title="Link to this heading"></a></h3>
<p>Each compute node on Summit has a 1.6TB<strong>N</strong>on-<strong>V</strong>olatile <strong>Me</strong>mory (NVMe) storage device (high-memory nodes have a 6.4TB NVMe storage device), colloquially known as a Burst Buffer with
theoretical performance peak of 2.1 GB/s for writing and 5.5 GB/s for reading.
100GB of each NVMe is reserved for NFS cache to help speed access to common
libraries. When calculating maximum usable storage size, this cache and
formatting overhead should be considered; We recommend a maximum storage of
1.4TB (6TB for high-memory nodes). The NVMes could be used to reduce the time that applications wait for
I/O. Using an SSD drive per compute node, the burst buffer will be used to
transfer data to or from the drive before the application reads a file or
after it writes a file.  The result will be that the application benefits from
native SSD performance for a portion of its I/O requests. Users are not
required to use the NVMes.  Data can also be written directly to the parallel
filesystem.</p>
<figure class="align-center" id="id28">
<img alt="../_images/nvme_arch.jpg" src="../_images/nvme_arch.jpg" />
<figcaption>
<p><span class="caption-text">The NVMes on Summit are local to each node.</span><a class="headerlink" href="#id28" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="current-nvme-usage">
<h3>Current NVMe Usage<a class="headerlink" href="#current-nvme-usage" title="Link to this heading"></a></h3>
<p>Tools for using the burst buffers are still under development.  Currently, the
user will have access to a writeable directory on each nodes NVMe and then
explicitly move data to and from the NVMes with posix commands during a job.
This mode of usage only supports writingfile-per-process or file-per-node.
Itdoes not support automatic n to 1 file writing, writing from multiple nodes
to a single file.  After a job completes the NVMes are trimmed, a process
thatirreversiblydeletes data from thedevices, so all desired data from the
NVMes will need to be copied back to the parallel filesystem before the job
ends. This largely manual mode of usage will not be the recommended way to use
the burst buffer for most applications because tools are actively being
developed to automate and improve the NVMe transfer and data management process.
Here are the basic steps for using the BurstBuffers in their current limited
mode of usage:</p>
<ol class="arabic simple">
<li><p>Modify your application to write to /mnt/bb/$USER, a directory that will be
created on each NVMe.</p></li>
<li><p>Modify either your application or your job submission script to copy the
desired data from /mnt/bb/$USERback to the parallel filesystem before the
job ends.</p></li>
<li><p>Modify your job submission script to include the <code class="docutils literal notranslate"><span class="pre">-alloc_flags</span> <span class="pre">NVME</span></code> bsub
option. Then on each reserved Burst Buffer node will be available a directory
called /mnt/bb/$USER.</p></li>
<li><p>Submit your bash script or run the application.</p></li>
<li><p>Assemble the resulting data as needed.</p></li>
</ol>
</section>
<section id="interactive-jobs-using-the-nvme">
<h3>Interactive Jobs Using the NVMe<a class="headerlink" href="#interactive-jobs-using-the-nvme" title="Link to this heading"></a></h3>
<p>The NVMe can be setup for test usage within an interactive job as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bsub</span> <span class="o">-</span><span class="n">W</span> <span class="mi">30</span> <span class="o">-</span><span class="n">nnodes</span> <span class="mi">1</span> <span class="o">-</span><span class="n">alloc_flags</span> <span class="s2">&quot;NVME&quot;</span> <span class="o">-</span><span class="n">P</span> <span class="n">project123</span> <span class="o">-</span><span class="n">Is</span> <span class="n">bash</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-alloc_flags</span> <span class="pre">NVME</span></code> option will create a directory called/mnt/bb/$USER on
each requested nodes NVMe. The <code class="docutils literal notranslate"><span class="pre">/mnt/bb/$USER</span></code> directories will bewriteable
and readable until the interactive job ends. Outside of a job <code class="docutils literal notranslate"><span class="pre">/mnt/bb/</span></code> will
be empty and you will not be able to write to it.</p>
</section>
<section id="nvme-usage-example">
<h3>NVMe Usage Example<a class="headerlink" href="#nvme-usage-example" title="Link to this heading"></a></h3>
<p>The following example illustrates how to use the burst buffers (NVMes) by
default on Summit. This example uses a submission script, check_nvme.lsf. It is
assumed that the files are saved in the users GPFS scratch area,
/gpfs/alpine/scratch/$USER/projid, and that the user is operating from there as
well. Do not forget that for all the commands on NVMe, it is required to use
jsrun. This will submit a job to run on one node.</p>
<p><strong>Job submssion script: check_nvme.lsf.</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#BSUB -P project123
#BSUB -J name_test
#BSUB -o nvme_test.o%J
#BSUB -W 2
#BSUB -nnodes 1
#BSUB -alloc_flags NVME

#Declare your project in the variable
projid=xxxxx
cd /gpfs/alpine/scratch/$USER/$projid

#Save the hostname of the compute node in a file
jsrun -n 1 echo $HOSTNAME &gt; test_file

#Check what files are saved on the NVMe, always use jsrun to access the NVMe devices
jsrun -n 1 ls -l /mnt/bb/$USER/

#Copy the test_file in your NVMe
jsrun -n 1 cp test_file /mnt/bb/$USER/

#Delete the test_file from your local space
rm test_file

#Check again what the NVMe folder contains
jsrun -n 1 ls -l /mnt/bb/$USER/

#Output of the test_file contents
jsrun -n 1 cat /mnt/bb/$USER/test_file

#Copy the file from the NVMe to your local space
jsrun -n 1 cp /mnt/bb/$USER/test_file .

#Check the file locally
ls -l test_file
</pre></div>
</div>
<p>To run this example: <code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">./check_nvme.lsf</span></code>.  We could include all the
commands in a script and call this file as a jsrun argument in an interactive
job, in order to avoid changing numbers of processes for all the jsrun
calls. You can see in the table below an example of the differences in a
submission script for executing an application on GPFS and NVMe. In the example,
a binary <code class="docutils literal notranslate"><span class="pre">./btio</span></code> reads input from an input file and generates output files.
In this particular case we copy the binary and the input file onto the NVMe, but
this depends on the application as it is not always necessary, we can execute
the binary on the GPFS and write/read the data from NVMe if it is supported by
the application.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><em>Using GPFS</em></p></td>
<td colspan="3"><p><em>Using NVMe</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code></p></td>
<td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-P</span> <span class="pre">xxx</span></code></p></td>
<td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-P</span> <span class="pre">xxx</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-J</span> <span class="pre">NAS-BTIO</span></code></p></td>
<td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-J</span> <span class="pre">NAS-BTIO</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-o</span> <span class="pre">nasbtio.o%J</span></code></p></td>
<td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-o</span> <span class="pre">nasbtio.o%J</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-e</span> <span class="pre">nasbtio.e%J</span></code></p></td>
<td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-e</span> <span class="pre">nasbtio.e%J</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-W</span> <span class="pre">10</span></code></p></td>
<td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-W</span> <span class="pre">10</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-nnodes</span> <span class="pre">1</span></code></p></td>
<td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-nnodes</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td rowspan="7"><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">-a</span> <span class="pre">16</span> <span class="pre">-c</span> <span class="pre">16</span> <span class="pre">-r</span> <span class="pre">1</span> <span class="pre">./btio</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-l</span></code>             `</p>
</td>
<td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-alloc_flags</span> <span class="pre">nvme</span></code></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">BBPATH=/mnt/bb/$USER/</span></code></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">cp</span> <span class="pre">btio</span> <span class="pre">${BBPATH}</span></code></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">cp</span> <span class="pre">input*</span> <span class="pre">${BBPATH}</span></code></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">-a</span> <span class="pre">16</span> <span class="pre">-c</span> <span class="pre">16</span> <span class="pre">-r</span> <span class="pre">1</span> <span class="pre">${BBPATH}/btio</span></code></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">ls</span> <span class="pre">-l</span> <span class="pre">${BBPATH}/</span></code></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">cp</span> <span class="pre">${BBPATH}/*</span> <span class="pre">.</span></code></p></td>
</tr>
</tbody>
</table>
<p>When a user occupies more than one compute node, then they are using more NVMes
and the I/O can scale linearly. For example in the following plot you can observe
the scalability of the IOR benchmark on 2048 compute nodes on Summit where the
write performance achieves 4TB/s and the read 11.3 TB/s</p>
<img alt="../_images/nvme_ior_summit.png" class="align-center" src="../_images/nvme_ior_summit.png" />
<p>Remember that by default NVMe support one file per MPI process up to one file
per compute node. If users desire a single file as output from data staged on
the NVMe they will need to construct it.  Tools to save automatically checkpoint
files from NVMe to GPFS as also methods that allow automatic n to 1 file writing
with NVMe staging are under development.  Tutorials about NVME:  Burst Buffer
on Summit (<a class="reference external" href="https://www.olcf.ornl.gov/wp-content/uploads/2018/12/summit_workshop_BB_markomanolis.pdf" target="_blank">slides</a>,
<a class="reference external" href="https://vimeo.com/306890779" target="_blank">video</a>) Summit Burst Buffer Libraries (<a class="reference external" href="https://www.olcf.ornl.gov/wp-content/uploads/2018/12/summit_workshop_BB_zimmer.pdf" target="_blank">slides</a>,
<a class="reference external" href="https://vimeo.com/306891012" target="_blank">video</a>).</p>
</section>
<section id="spectral-library">
<span id="id24"></span><h3>Spectral Library<a class="headerlink" href="#spectral-library" title="Link to this heading"></a></h3>
<p>Spectral is a portable and transparent middleware library to enable use of the
node-local burst buffers for accelerated application output on Summit. It is
used to transfer files from node-local NVMe back to the parallel GPFS file
system without the need of the user to interact during the job execution.
Spectral runs on the isolated core of each reserved node, so it does not occupy
resources and based on some parameters the user could define which folder to be
copied to the GPFS. In order to use Spectral, the user has to do the following
steps in the submission script:</p>
<ol class="arabic simple">
<li><p>Request Spectral resources instead of NVMe</p></li>
<li><p>Declare the path where the files will be saved in the node-local NVMe
(PERSIST_DIR)</p></li>
<li><p>Declare the path on GPFS where the files will be copied (PFS_DIR)</p></li>
<li><p>Execute the script spectral_wait.py when the application is finished in order
to copy the files from NVMe to GPFS</p></li>
</ol>
<p>The following table shows the differences of executing an application on GPFS,
NVMe, and NVMe with Spectral. This example is using one compute node. We copy
the executable and input file for the NVMe cases but this is not always
necessary. Depending on the application, you could execute the binary from the
GPFS and save the output files on NVMe. Adjust your parameters to copy, if
necessary, the executable and input files onto all the NVMe devices.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><em>Using GPFS</em></p></td>
<td><p><em>Using NVMe</em></p></td>
<td><p><em>Using NVME with Spectral library</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-P</span> <span class="pre">xxx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-P</span> <span class="pre">xxx</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-P</span> <span class="pre">xxx</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-J</span> <span class="pre">NAS-BTIO</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-J</span> <span class="pre">NAS-BTIO</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-J</span> <span class="pre">NAS-BTIO</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-o</span> <span class="pre">nasbtio.o%J</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-o</span> <span class="pre">nasbtio.o%J</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-o</span> <span class="pre">nasbtio.o%J</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-e</span> <span class="pre">nasbtio.e%J</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-e</span> <span class="pre">nasbtio.e%J</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-e</span> <span class="pre">nasbtio.e%J</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-W</span> <span class="pre">10</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-W</span> <span class="pre">10</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-W</span> <span class="pre">10</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-nnodes</span> <span class="pre">1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-nnodes</span> <span class="pre">1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-nnodes</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-alloc_flags</span> <span class="pre">nvme</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">#BSUB</span> <span class="pre">-alloc_flags</span> <span class="pre">spectral</span></code></p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">spectral</span></code></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">BBPATH=/mnt/bb/$USER</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">BBPATH=/mnt/bb/$USER</span></code></p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">PERSIST_DIR=${BBPATH}</span></code></p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">PFS_DIR=$PWD/spect/</span></code></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">cp</span> <span class="pre">btio</span> <span class="pre">${BBPATH}</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">cp</span> <span class="pre">btio</span> <span class="pre">${BBPATH}</span></code></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">cp</span> <span class="pre">input*</span> <span class="pre">${BBPATH}</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">cp</span> <span class="pre">input*</span> <span class="pre">${BBPATH}</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">-a</span> <span class="pre">16</span> <span class="pre">-c</span> <span class="pre">16</span> <span class="pre">-r</span> <span class="pre">1</span> <span class="pre">./btio</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">-a</span> <span class="pre">16</span> <span class="pre">-c</span> <span class="pre">16</span> <span class="pre">-r</span> <span class="pre">1</span> <span class="pre">${BBPATH}/btio</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">-a</span> <span class="pre">16</span> <span class="pre">-c</span> <span class="pre">16</span> <span class="pre">-r</span> <span class="pre">1</span> <span class="pre">${BBPATH}/btio</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-l</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">ls</span> <span class="pre">-l</span> <span class="pre">${BBPATH}/</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">ls</span> <span class="pre">-l</span> <span class="pre">${BBPATH}/</span></code></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">cp</span> <span class="pre">${BBPATH}/*</span> <span class="pre">.</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">spectral_wait.py</span></code></p></td>
</tr>
</tbody>
</table>
<p>When the Spectral library is not used, any output data produced has to be copied
back from NVMe.  You can observe that with the Spectral library there is no reason
to explicitly ask for the data to be copied to GPFS as it is done automatically
through the spectral_wait.py script. Also a log file called spectral.log will be
created with information on the files that were copied.</p>
</section>
</section>
<section id="known-issues">
<span id="id25"></span><h2>Known Issues<a class="headerlink" href="#known-issues" title="Link to this heading"></a></h2>
<p>Last Updated: 07 February 2023</p>
<section id="open-issues">
<h3>Open Issues<a class="headerlink" href="#open-issues" title="Link to this heading"></a></h3>
<section id="hip-code-cannot-be-built-using-cmake-using-hip-host-device-or-hip-language-support">
<h4>HIP code cannot be built using CMake using hip::host/device or HIP language support<a class="headerlink" href="#hip-code-cannot-be-built-using-cmake-using-hip-host-device-or-hip-language-support" title="Link to this heading"></a></h4>
<p>Using the <code class="docutils literal notranslate"><span class="pre">hip-cuda/5.1.0</span></code> module on Summit, applications cannot build using a <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> that requires HIP language support or references the <code class="docutils literal notranslate"><span class="pre">hip::host</span></code> and <code class="docutils literal notranslate"><span class="pre">hip::device</span></code> identifiers. There is no known workaround for this issue. Applications wishing to compile HIP code with CMake need to avoid using HIP language support or <code class="docutils literal notranslate"><span class="pre">hip::host</span></code> and <code class="docutils literal notranslate"><span class="pre">hip::device</span></code> identifiers.</p>
</section>
<section id="unsupported-cuda-versions-do-not-work-with-gpu-aware-mpi">
<h4>Unsupported CUDA versions do not work with GPU-aware MPI<a class="headerlink" href="#unsupported-cuda-versions-do-not-work-with-gpu-aware-mpi" title="Link to this heading"></a></h4>
<p>Although there are newer CUDA modules on Summit, <code class="docutils literal notranslate"><span class="pre">cuda/11.0.3</span></code> is the latest version that is officially supported by the version of IBMs software stack installed on Summit. When loading the newer CUDA modules, a message is printed to the screen stating that the module is for testing purposes only. These newer unsupported CUDA versions might work with some users applications, but importantly, they are known <strong>not</strong> to work with GPU-aware MPI.</p>
</section>
<section id="hip-does-not-currently-work-with-gpu-aware-mpi">
<h4>HIP does not currently work with GPU-aware MPI<a class="headerlink" href="#hip-does-not-currently-work-with-gpu-aware-mpi" title="Link to this heading"></a></h4>
<p>Using the <code class="docutils literal notranslate"><span class="pre">hip-cuda/5.1.0</span></code> module on Summit requires CUDA v11.4.0 or later. However, only CUDA v11.0.3 and earlier currently support GPU-aware MPI, so GPU-aware MPI is currently not available when using HIP on Summit.</p>
</section>
<section id="mps-does-not-currently-work-with-codes-compiled-with-post-11-0-3-cuda">
<h4>MPS does not currently work with codes compiled with post 11.0.3 CUDA<a class="headerlink" href="#mps-does-not-currently-work-with-codes-compiled-with-post-11-0-3-cuda" title="Link to this heading"></a></h4>
<p>Any codes compiled with post 11.0.3 CUDA (<code class="docutils literal notranslate"><span class="pre">cuda/11.0.3</span></code>) will not work with MPS enabled (<code class="docutils literal notranslate"><span class="pre">-alloc_flags</span> <span class="pre">&quot;gpumps&quot;</span></code>) on Summit. The code will hang indefinitely. CUDA v11.0.3 is the latest version that is officially supported by IBMs software stack installed on Summit. We are continuing to look into this issue.</p>
</section>
<section id="system-not-sourcing-bashrc-profile-etc-files-as-expected">
<h4>System not sourcing <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>, <code class="docutils literal notranslate"><span class="pre">.profile</span></code>, etc. files as expected<a class="headerlink" href="#system-not-sourcing-bashrc-profile-etc-files-as-expected" title="Link to this heading"></a></h4>
<p>Some users have noticed that their login shells, batch jobs, etc. are not sourcing shell run control files as expected. This is related to the way bash is initialized. The initialization process is discussed in the INVOCATION section of the bash manpage, but is summarized here.</p>
<p>Bash sources different files based on two attributes of the shell: whether or not its a login shell, and whether or not its an interactive shell. These attributes are not mutually exclusive (so a shell can be interactive login, interactive non-login, etc.):</p>
<ol class="arabic simple">
<li><p>If a shell is an interactive login shell (i.e. an ssh to the system) or a non-interactive shell started with the <code class="docutils literal notranslate"><span class="pre">--login</span></code> option (say, a batch script with <code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span> <span class="pre">--login</span></code> as the first line), it will source <code class="docutils literal notranslate"><span class="pre">/etc/profile</span></code> and will then search your home directory for <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code>, <code class="docutils literal notranslate"><span class="pre">~/.bash_login</span></code>, and <code class="docutils literal notranslate"><span class="pre">~/.profile</span></code>. It will source the first of those that it finds (once it sources one, it stops looking for the others).</p></li>
<li><p>If a shell is an interactive, non-login shell (say, if you run bash in your login session to start a subshell), it will source <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code></p></li>
<li><p>If a shell is a non-interactive, non-login shell, it will source whatever file is defined by the <code class="docutils literal notranslate"><span class="pre">$BASH_ENV</span></code> variable in the shell from which it was invoked.</p></li>
</ol>
<p>In any case, if the files listed above that should be sourced in a particular situation do not exist, it is not an error.</p>
<p>On Summit and Andes, batch-interactive jobs using bash (i.e. those submitted with <code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-Is</span></code> or <code class="docutils literal notranslate"><span class="pre">salloc</span></code>) run as interactive, non-login shells (and therefore source <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code>, if it exists). Regular batch jobs using bash on those systems are non-interactive, non-login shells and source the file defined by the variable <code class="docutils literal notranslate"><span class="pre">$BASH_ENV</span></code> in the shell from which you submitted the job. This variable is not set by default, so this means that none of these files will be sourced for a regular batch job unless you explicitly set that variable.</p>
<p>Some systems are configured to have additional files in <code class="docutils literal notranslate"><span class="pre">/etc</span></code> sourced, and sometimes the files in <code class="docutils literal notranslate"><span class="pre">/etc</span></code> look for and source files in your home directory such as <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code>, so the behavior on any given system may seem to deviate a bit from the information above (which is from the bash manpage). This can explain why jobs (or other shells) on other systems youve used have sourced your <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> file on login.</p>
</section>
<section id="improper-permissions-on-ssh-config-cause-job-state-flip-flop-jobs-ending-in-suspended-state">
<h4>Improper permissions on <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code> cause job state flip-flop/jobs ending in suspended state<a class="headerlink" href="#improper-permissions-on-ssh-config-cause-job-state-flip-flop-jobs-ending-in-suspended-state" title="Link to this heading"></a></h4>
<p>Improper permissions on your SSH configuration file (<code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code>) will cause jobs to alternate between pending &amp; running states until the job ultimately ends up in a PSUSP state.</p>
<p>LSF uses SSH to communicate with nodes allocated to your job, and in this case the improper permissions (i.e. write permission for anyone other than the user) cause SSH to fail, which in turn causes the job launch to fail. Note that SSH only checks the permissions of the configuration file itself. Thus, even if the <code class="docutils literal notranslate"><span class="pre">~/.ssh/</span></code> directory itself grants no group or other permissions, SSH will fail due to permissions on the configuration file.</p>
<p>To fix this, use a more secure permission setting on the configuration file. An appropriate setting would be read and write permission for the user and no other permissions. You can set this with the command <code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">600</span> <span class="pre">~/.ssh/config</span></code>.</p>
</section>
<section id="setting-tmpdir-causes-jsm-jsrun-errors-job-state-flip-flop">
<h4>Setting <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code> causes JSM (<code class="docutils literal notranslate"><span class="pre">jsrun</span></code>) errors / job state flip-flop<a class="headerlink" href="#setting-tmpdir-causes-jsm-jsrun-errors-job-state-flip-flop" title="Link to this heading"></a></h4>
<p>Setting the <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code> environment variable causes jobs to fail with JSM
(<code class="docutils literal notranslate"><span class="pre">jsrun</span></code>) errors and can also cause jobs to bounce back and forth between
eligible and running states until a retry limit has been reached and the job is
placed in a blocked state (NOTE: This bouncing of job state can be caused for
multiple reasons. Please see the known issue <a class="reference internal" href="#jobs-suspended-due-to-retry-limit-queued-job-flip-flops-between-queued-running-states">Jobs suspended due to retry limit
/ Queued job flip-flops between queued/running states</a> if you are not setting
<code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code>). A bug has been filed with IBM to address this issue.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code> is set within a running job (i.e., in an interactive session or
within a batch script), any attempt to call <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> will lead to a job
failure with the following error message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span><span class="p">:</span> <span class="n">Remote</span> <span class="n">JSM</span> <span class="n">server</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">responding</span> <span class="n">on</span> <span class="n">host</span> <span class="n">batch503</span><span class="o">-</span><span class="mi">25</span><span class="o">-</span><span class="mi">2020</span> <span class="mi">15</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">920</span> <span class="mi">90012</span> <span class="n">main</span><span class="p">:</span> <span class="n">Error</span> <span class="n">initializing</span> <span class="n">RM</span> <span class="n">connection</span><span class="o">.</span> <span class="n">Exiting</span><span class="o">.</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code> is set before submitting a job (i.e., in the shell/environment
where a job is submitted from), the job will bounce back and forth between a
running and eligible state until its retry limit has been reached and the job
will end up in a blocked state. This is true for both interactive jobs and jobs
submitted with a batch script, but interactive jobs will hang without dropping
you into your interactive shell. In both cases, JSM log files (e.g.,
<code class="docutils literal notranslate"><span class="pre">jsm-lsf-wait.username.1004985.log</span></code>) will be created in the location set for
<code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code> containing the same error message as shown above.</p>
</section>
<section id="segfault-when-running-executables-on-login-nodes">
<h4>Segfault when running executables on login nodes<a class="headerlink" href="#segfault-when-running-executables-on-login-nodes" title="Link to this heading"></a></h4>
<p>Executing a parallel binary on the login node or a batch node without using the
job step launcher <code class="docutils literal notranslate"><span class="pre">jsrun</span></code> will result in a segfault.</p>
<p>This also can be encountered when importing parallel Python libraries like
<code class="docutils literal notranslate"><span class="pre">mpi4py</span></code> and <code class="docutils literal notranslate"><span class="pre">h5py</span></code> directly on these nodes.</p>
<p>The issue has been reported to IBM. The current workaround is to run the binary
inside an interactive or batch job via <code class="docutils literal notranslate"><span class="pre">jsrun</span></code>.</p>
</section>
<section id="nsight-compute-cannot-be-used-with-mpi-programs">
<h4>Nsight Compute cannot be used with MPI programs<a class="headerlink" href="#nsight-compute-cannot-be-used-with-mpi-programs" title="Link to this heading"></a></h4>
<p>When profiling an MPI application using NVIDIA Nsight Compute, like the following,
you may see an error message in Spectrum MPI that aborts the program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jsrun</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span> <span class="o">-</span><span class="n">a</span> <span class="mi">1</span> <span class="o">-</span><span class="n">g</span> <span class="mi">1</span> <span class="n">nv</span><span class="o">-</span><span class="n">nsight</span><span class="o">-</span><span class="n">cu</span><span class="o">-</span><span class="n">cli</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>

<span class="n">Error</span><span class="p">:</span> <span class="n">common_pami</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">1049</span> <span class="o">-</span> <span class="n">ompi_common_pami_init</span><span class="p">()</span> <span class="n">Unable</span> <span class="n">to</span> <span class="n">create</span> <span class="n">PAMI</span> <span class="n">client</span> <span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">--------------------------------------------------------------------------</span>
<span class="n">No</span> <span class="n">components</span> <span class="n">were</span> <span class="n">able</span> <span class="n">to</span> <span class="n">be</span> <span class="n">opened</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pml</span> <span class="n">framework</span><span class="o">.</span>

<span class="n">This</span> <span class="n">typically</span> <span class="n">means</span> <span class="n">that</span> <span class="n">either</span> <span class="n">no</span> <span class="n">components</span> <span class="n">of</span> <span class="n">this</span> <span class="nb">type</span> <span class="n">were</span>
<span class="n">installed</span><span class="p">,</span> <span class="ow">or</span> <span class="n">none</span> <span class="n">of</span> <span class="n">the</span> <span class="n">installed</span> <span class="n">components</span> <span class="n">can</span> <span class="n">be</span> <span class="n">loaded</span><span class="o">.</span>
<span class="n">Sometimes</span> <span class="n">this</span> <span class="n">means</span> <span class="n">that</span> <span class="n">shared</span> <span class="n">libraries</span> <span class="n">required</span> <span class="n">by</span> <span class="n">these</span>
<span class="n">components</span> <span class="n">are</span> <span class="n">unable</span> <span class="n">to</span> <span class="n">be</span> <span class="n">found</span><span class="o">/</span><span class="n">loaded</span><span class="o">.</span>

<span class="n">Host</span><span class="p">:</span>      <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
<span class="n">Framework</span><span class="p">:</span> <span class="n">pml</span>
<span class="o">--------------------------------------------------------------------------</span>
<span class="n">PML</span> <span class="n">pami</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">selected</span>
</pre></div>
</div>
<p>This is due to an incompatibility in the 2019.x versions of Nsight Compute with
Spectrum MPI. As a workaround, you can disable CUDA hooks in Spectrum MPI using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jsrun</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span> <span class="o">-</span><span class="n">a</span> <span class="mi">1</span> <span class="o">-</span><span class="n">g</span> <span class="mi">1</span> <span class="o">--</span><span class="n">smpiargs</span><span class="o">=</span><span class="s2">&quot;-disable_gpu_hooks&quot;</span> <span class="n">nv</span><span class="o">-</span><span class="n">nsight</span><span class="o">-</span><span class="n">cu</span><span class="o">-</span><span class="n">cli</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>Unfortunately, this is incompatible with using CUDA-aware MPI in your application.</p>
<p>This will be resolved in a future release of CUDA.</p>
</section>
<section id="cuda-hook-error-when-program-uses-cuda-without-first-calling-mpi-init">
<h4>CUDA hook error when program uses CUDA without first calling MPI_Init()<a class="headerlink" href="#cuda-hook-error-when-program-uses-cuda-without-first-calling-mpi-init" title="Link to this heading"></a></h4>
<p>Serial applications, that are not MPI enabled, often face the following
issue when compiled with Spectrum MPIs wrappers and run with jsrun:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CUDA</span> <span class="n">Hook</span> <span class="n">Library</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">find</span> <span class="n">symbol</span> <span class="n">mem_find_dreg_entries</span><span class="p">,</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span><span class="p">:</span> <span class="n">undefined</span> <span class="n">symbol</span><span class="p">:</span> <span class="n">__PAMI_Invalidate_region</span>
</pre></div>
</div>
<p>The same issue can occur if CUDA API calls that interact with the GPU
(e.g. allocating memory) are called before MPI_Init() in an MPI enabled
application. Depending on context, this error can either be harmless or
it can be fatal.</p>
<p>The reason this occurs is that the PAMI messaging backend, used by Spectrum
MPI by default, has a CUDA hook that records GPU memory allocations.
This record is used later during CUDA-aware MPI calls to efficiently detect
whether a given message is sent from the CPU or the GPU. This is done by
design in the IBM implementation and is unlikely to be changed.</p>
<p>There are two main ways to work around this problem. If CUDA-aware MPI is
not a relevant factor for your work (which is naturally true for serial
applications) then you can simply disable the CUDA hook with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">smpiargs</span><span class="o">=</span><span class="s2">&quot;-disable_gpu_hooks&quot;</span>
</pre></div>
</div>
<p>as an argument to jsrun. Note that this is not compatible with the <code class="docutils literal notranslate"><span class="pre">-gpu</span></code>
argument to <code class="docutils literal notranslate"><span class="pre">--smpiargs</span></code>, since that is what enables CUDA-aware MPI and
the CUDA-aware MPI functionality depends on the CUDA hook.</p>
<p>If you do need CUDA-aware MPI functionality, then the only known working
solution to this problem is to refactor your code so that no CUDA calls
occur before MPI_Init(). (This includes any libraries or programming models
such as OpenACC or OpenMP that would use CUDA behind the scenes.) While it
is not explicitly codified in the standard, it is worth noting that the major
MPI implementations all recommend doing as little as possible before MPI_Init(),
and this recommendation is consistent with that.</p>
</section>
<section id="spindle-is-not-currently-supported">
<h4>Spindle is not currently supported<a class="headerlink" href="#spindle-is-not-currently-supported" title="Link to this heading"></a></h4>
<p>Users should not use <code class="docutils literal notranslate"><span class="pre">USE_SPINDLE=1</span></code> or <code class="docutils literal notranslate"><span class="pre">LOAD_SPINDLE=1</span></code> in their
<code class="docutils literal notranslate"><span class="pre">~/.jsm.conf</span></code> file at this time. A bug has been filed with IBM to
address this issue.</p>
</section>
<section id="spectrum-mpi-tunings-needed-for-maximum-bandwidth">
<h4>Spectrum MPI tunings needed for maximum bandwidth<a class="headerlink" href="#spectrum-mpi-tunings-needed-for-maximum-bandwidth" title="Link to this heading"></a></h4>
<p>By default, Spectrum MPI is configured for minimum latency. If your
application needs maximum bandwidth, the following settings are
recommended:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export PAMI_ENABLE_STRIPING=1
$ export PAMI_IBV_ADAPTER_AFFINITY=1
$ export PAMI_IBV_DEVICE_NAME=&quot;mlx5_0:1,mlx5_3:1&quot;
$ export PAMI_IBV_DEVICE_NAME_1=&quot;mlx5_3:1,mlx5_0:1&quot;
</pre></div>
</div>
</section>
<section id="debugging-slow-application-startup-or-slow-performance">
<h4>Debugging slow application startup or slow performance<a class="headerlink" href="#debugging-slow-application-startup-or-slow-performance" title="Link to this heading"></a></h4>
<p>In order for debugging and profiling tools to work, you need to unload
Darshan</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ module unload darshan-runtime
</pre></div>
</div>
<p>Spectrum MPI provides a tracing library that can be helpful to gather
more detail information about the MPI communication of your job. To
gather MPI tracing data, you can set
<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">OMPI_LD_PRELOAD_POSTPEND=$OLCF_SPECTRUM_MPI_ROOT/lib/libmpitrace.so</span></code>
in your environment. This will generate profile files with timings for
the individual processes of your job.</p>
<p>In addition, to debug slow startup JSM provides the option to create a
progress file. The file will show information that can be helpful to
pinpoint if a specific node is hanging or slowing down the job step
launch. To enable it, you can use: <code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">--progress</span>
<span class="pre">./my_progress_file_output.txt</span></code>.</p>
</section>
<section id="a-flag-ignored-when-using-a-jsrun-resource-set-file-with-u">
<h4>-a flag ignored when using a jsrun resource set file with -U<a class="headerlink" href="#a-flag-ignored-when-using-a-jsrun-resource-set-file-with-u" title="Link to this heading"></a></h4>
<p>When using file-based specification of resource sets with <code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">-U</span></code>,
the <code class="docutils literal notranslate"><span class="pre">-a</span></code> flag (number of tasks per resource set) is ignored. This has
been reported to IBM and they are investigating. It is generally
recommended to use jsrun explicit resource files (ERF) with
<code class="docutils literal notranslate"><span class="pre">--erf_input</span></code> and <code class="docutils literal notranslate"><span class="pre">--erf_output</span></code> instead of <code class="docutils literal notranslate"><span class="pre">-U</span></code>.</p>
</section>
<section id="jobs-suspended-due-to-retry-limit-queued-job-flip-flops-between-queued-running-states">
<h4>Jobs suspended due to retry limit / Queued job flip-flops between queued/running states<a class="headerlink" href="#jobs-suspended-due-to-retry-limit-queued-job-flip-flops-between-queued-running-states" title="Link to this heading"></a></h4>
<p>Some users have reported seeing their jobs transition from the normal
queued state, into a running state, and then back again to queued.
Sometimes this can happen multiple times. Eventually, internal limits in
the LSF scheduler will be reached, at which point the job will no longer
be eligible for running. The <code class="docutils literal notranslate"><span class="pre">bhist</span></code> command can be used to see if a job
is cycling between running and eligible states. The pending reason given
by <code class="docutils literal notranslate"><span class="pre">bhist</span></code> can also be useful to debug. This can happen due to
modifications that the user has made to their environment on the system,
incorrect SSH key setup, attempting to load unavailable/broken modules.
or system problems with individual nodes. When jobs are observed to
flip-flop between running and queued, and/or become ineligible without
explanation, then deeper investigation is required and the user should
write to <a class="reference external" href="mailto:help&#37;&#52;&#48;olcf&#46;ornl&#46;gov" target="_blank">help<span>&#64;</span>olcf<span>&#46;</span>ornl<span>&#46;</span>gov</a>.</p>
</section>
<section id="jsrun-explicit-resource-file-erf-output-format-error">
<h4>jsrun explicit resource file (ERF) output format error<a class="headerlink" href="#jsrun-explicit-resource-file-erf-output-format-error" title="Link to this heading"></a></h4>
<p>jsruns option to create an explicit resource file (<code class="docutils literal notranslate"><span class="pre">--erf_output</span></code>) will
incorrectly create a file with one line per rank. When reading the file
in with (<code class="docutils literal notranslate"><span class="pre">--erf_input</span></code>) you will see warnings for overlapping resource
sets. This issue has been reported. The workaround is to manually
update the created ERF file to contain a single line per resource set
with multiple ranks per line.</p>
</section>
<section id="jsrun-latency-priority-capitalization-allocates-incorrect-resources">
<h4>jsrun latency priority capitalization allocates incorrect resources<a class="headerlink" href="#jsrun-latency-priority-capitalization-allocates-incorrect-resources" title="Link to this heading"></a></h4>
<p>jsruns latency priority (<code class="docutils literal notranslate"><span class="pre">-l</span></code>) flag can be given lowercase values
(i.e. gpu-cpu) or capitalized values (i.e. GPU-CPU).</p>
<p><strong>Expected behavior</strong>:</p>
<blockquote>
<div><p>When capitalized, jsrun should not compromise on the resource layout,
and will wait to begin the job step until the ideal resources are
available. When given a lowercase value, jsrun will not wait, but
initiate the job step with the most ideal layout as is available at the
time. This also means that when theres no resource contention, such as
running a single job step at a time, capitalization should not matter,
as they should both yield the same resources.</p>
</div></blockquote>
<p><strong>Actual behavior</strong>:</p>
<blockquote>
<div><p>Capitalizing the latency priority value may allocate incorrect
resources, or even cause the job step to fail entirely.</p>
</div></blockquote>
<p><strong>Recommendation</strong>:</p>
<blockquote>
<div><p>It is currently recommended to only use the lowercase values to (<code class="docutils literal notranslate"><span class="pre">-l</span></code> /
<code class="docutils literal notranslate"><span class="pre">--latency_priority</span></code>). The system default is: gpu-cpu,cpu-mem,cpu-cpu.
Since this ordering is used implicitly when the <code class="docutils literal notranslate"><span class="pre">-l</span></code> flag is omitted, this
issue only impacts submissions which explicitly include a latency
priority in the jsrun command.</p>
</div></blockquote>
</section>
<section id="error-when-using-complex-datatypes-with-mpi-collectives-and-gpudirect">
<h4>Error when using complex datatypes with MPI Collectives and GPUDirect<a class="headerlink" href="#error-when-using-complex-datatypes-with-mpi-collectives-and-gpudirect" title="Link to this heading"></a></h4>
<p>Users have reported errors when using complex datatypes with MPI
Collectives and GPUDirect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jsrun</span> <span class="o">--</span><span class="n">smpiargs</span><span class="o">=</span><span class="s2">&quot;-gpu&quot;</span> <span class="o">-</span><span class="n">n</span> <span class="mi">6</span> <span class="o">-</span><span class="n">a</span> <span class="mi">1</span> <span class="o">-</span><span class="n">g</span> <span class="mi">1</span>   <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
<span class="p">[</span><span class="n">h35n05</span><span class="p">:</span><span class="mi">113506</span><span class="p">]</span> <span class="n">coll</span><span class="p">:</span><span class="n">ibm</span><span class="p">:</span><span class="n">allreduce</span><span class="p">:</span> <span class="n">GPU</span> <span class="n">awareness</span> <span class="ow">in</span> <span class="n">PAMI</span> <span class="n">requested</span><span class="o">.</span> <span class="n">It</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">safe</span> <span class="n">to</span> <span class="n">defer</span> <span class="n">to</span> <span class="n">another</span> <span class="n">component</span><span class="o">.</span>
<span class="p">[</span><span class="n">h35n05</span><span class="p">:</span><span class="mi">113506</span><span class="p">]</span> <span class="o">***</span> <span class="n">An</span> <span class="n">error</span> <span class="n">occurred</span> <span class="ow">in</span> <span class="n">MPI_Allreduce</span>
<span class="p">[</span><span class="n">h35n05</span><span class="p">:</span><span class="mi">113506</span><span class="p">]</span> <span class="o">***</span> <span class="n">reported</span> <span class="n">by</span> <span class="n">process</span> <span class="p">[</span><span class="mi">3199551009</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="n">h35n05</span><span class="p">:</span><span class="mi">113506</span><span class="p">]</span> <span class="o">***</span> <span class="n">on</span> <span class="n">communicator</span> <span class="n">MPI_COMM_WORLD</span>
<span class="p">[</span><span class="n">h35n05</span><span class="p">:</span><span class="mi">113506</span><span class="p">]</span> <span class="o">***</span> <span class="n">MPI_ERR_UNSUPPORTED_OPERATION</span><span class="p">:</span> <span class="n">operation</span> <span class="ow">not</span> <span class="n">supported</span>
<span class="p">[</span><span class="n">h35n05</span><span class="p">:</span><span class="mi">113506</span><span class="p">]</span> <span class="o">***</span> <span class="n">MPI_ERRORS_ARE_FATAL</span> <span class="p">(</span><span class="n">processes</span> <span class="ow">in</span> <span class="n">this</span> <span class="n">communicator</span> <span class="n">will</span> <span class="n">now</span> <span class="n">abort</span><span class="p">,</span>
<span class="p">[</span><span class="n">h35n05</span><span class="p">:</span><span class="mi">113506</span><span class="p">]</span> <span class="o">***</span>    <span class="ow">and</span> <span class="n">potentially</span> <span class="n">your</span> <span class="n">MPI</span> <span class="n">job</span><span class="p">)</span>
<span class="p">[</span><span class="n">h35n05</span><span class="p">:</span><span class="mi">113509</span><span class="p">]</span> <span class="n">coll</span><span class="p">:</span><span class="n">ibm</span><span class="p">:</span><span class="n">allreduce</span><span class="p">:</span> <span class="n">GPU</span> <span class="n">awareness</span> <span class="ow">in</span> <span class="n">PAMI</span> <span class="n">requested</span><span class="o">.</span> <span class="n">It</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">safe</span> <span class="n">to</span> <span class="n">defer</span> <span class="n">to</span> <span class="n">another</span> <span class="n">component</span><span class="o">.</span>
</pre></div>
</div>
<p>This is a known issue with libcoll and the SMPI team is working to
resolve it. In the meantime, a workaround is to treat the complex array
as a real array with double the length if the operation is not
MPI_Prod. Note: This requires code modification. An alternative
workaround is to disable IBM optimized collectives. This will impact
performance however but requires no code changes and should be correct
for all MPI_Allreduce operations. You can do this by adding the
following option to your jsrun command line:
<code class="docutils literal notranslate"><span class="pre">--smpiargs=&quot;-HCOLL</span> <span class="pre">-FCA</span> <span class="pre">-mca</span> <span class="pre">coll_hcoll_enable</span> <span class="pre">1</span> <span class="pre">-mca</span> <span class="pre">coll_hcoll_np</span> <span class="pre">0</span>
<span class="pre">-mca</span> <span class="pre">coll</span> <span class="pre">^basic</span> <span class="pre">-mca</span> <span class="pre">coll</span> <span class="pre">^ibm</span> <span class="pre">-async&quot;</span></code></p>
</section>
<section id="error-when-using-erf">
<h4>Error when using ERF<a class="headerlink" href="#error-when-using-erf" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://www.ibm.com/support/knowledgecenter/en/SSWRJV_10.1.0/jsm/10.3/base/erf_format.html" target="_blank">Explicit Resource Files</a>
provide even more fine-granied control over how processes are mapped onto
compute nodes.
Users have reported errors when using ERF on Summit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Failed</span> <span class="n">to</span> <span class="n">bind</span> <span class="n">process</span> <span class="n">to</span> <span class="n">ERF</span> <span class="n">smt</span> <span class="n">array</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span> <span class="n">Invalid</span> <span class="n">argument</span>
</pre></div>
</div>
<p>This is a known issue with the current version of jsrun.</p>
</section>
</section>
<section id="resolved-issues">
<h3>Resolved Issues<a class="headerlink" href="#resolved-issues" title="Link to this heading"></a></h3>
<section id="received-msg-header-indicates-a-size-that-is-too-large-error-message-from-spectrum-mpi">
<h4>Received msg header indicates a size that is too large error message from Spectrum MPI<a class="headerlink" href="#received-msg-header-indicates-a-size-that-is-too-large-error-message-from-spectrum-mpi" title="Link to this heading"></a></h4>
<p>If you get an error message that looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="n">received</span> <span class="n">msg</span> <span class="n">header</span> <span class="n">indicates</span> <span class="n">a</span> <span class="n">size</span> <span class="n">that</span> <span class="ow">is</span> <span class="n">too</span> <span class="n">large</span><span class="p">:</span>
 <span class="n">Requested</span> <span class="n">size</span><span class="p">:</span> <span class="mi">25836785</span>
 <span class="n">Size</span> <span class="n">limit</span><span class="p">:</span> <span class="mi">16777216</span>
<span class="n">If</span> <span class="n">you</span> <span class="n">believe</span> <span class="n">this</span> <span class="n">msg</span> <span class="ow">is</span> <span class="n">legitimate</span><span class="p">,</span> <span class="n">please</span> <span class="n">increase</span> <span class="n">the</span>
<span class="nb">max</span> <span class="n">msg</span> <span class="n">size</span> <span class="n">via</span> <span class="n">the</span> <span class="n">ptl_base_max_msg_size</span> <span class="n">parameter</span><span class="o">.</span>
</pre></div>
</div>
<p>This can be resolved by setting <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">PMIX_MCA_ptl_base_max_msg_size=18</span></code> where the value is size in MB. Setting it to 18 or higher usually works. The default if its not explicitly set is around 16 MB.</p>
</section>
<section id="jsm-fault-tolerance-causes-jobs-to-fail-to-start">
<h4>JSM Fault Tolerance causes jobs to fail to start<a class="headerlink" href="#jsm-fault-tolerance-causes-jobs-to-fail-to-start" title="Link to this heading"></a></h4>
<p>Adding <code class="docutils literal notranslate"><span class="pre">FAULT_TOLERANCE=1</span></code> in your individual <code class="docutils literal notranslate"><span class="pre">~/.jsm.conf</span></code> file,
will result in LSF jobs failing to successfully start.</p>
<p>The following issues were resolved with the July 16, 2019 software upgrade:</p>
</section>
<section id="default-nvprof-setting-clobbers-ld-preload-interfering-with-spectrummpi-resolved-july-16-2019">
<h4>Default nvprof setting clobbers <code class="docutils literal notranslate"><span class="pre">LD_PRELOAD</span></code>, interfering with SpectrumMPI (Resolved: July 16, 2019)<a class="headerlink" href="#default-nvprof-setting-clobbers-ld-preload-interfering-with-spectrummpi-resolved-july-16-2019" title="Link to this heading"></a></h4>
<p>CUDA 10 adds a new feature to profile CPU side OpenMP constructs (see
<a class="reference external" href="https://docs.nvidia.com/cuda/profiler-users-guide/index.html#openmp" target="_blank">https://docs.nvidia.com/cuda/profiler-users-guide/index.html#openmp</a>).
This feature is enabled by default and has a bug which will cause it to
overwrite the contents of <code class="docutils literal notranslate"><span class="pre">LD_PRELOAD</span></code>. SpectrumMPI requires a library
(<code class="docutils literal notranslate"><span class="pre">libpami_cuda_hook.so</span></code>) to be preloaded in order to function. All MPI
applications on Summit will break when run in nvprof with default
settings. The workaround is to disable the new OpenMP profiling feature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ jsrun  nvprof --openmp-profiling off
</pre></div>
</div>
</section>
<section id="csm-based-launch-is-not-currently-supported-resolved-july-16-2019">
<h4>CSM-based launch is not currently supported (Resolved: July 16, 2019)<a class="headerlink" href="#csm-based-launch-is-not-currently-supported-resolved-july-16-2019" title="Link to this heading"></a></h4>
<p>Users should not use <code class="docutils literal notranslate"><span class="pre">JSMD_LAUNCH_MODE=csm</span></code> in their <code class="docutils literal notranslate"><span class="pre">~/.jsm.conf</span></code>
file at this time. A bug has been filed with IBM to address this issue.</p>
</section>
<hr class="docutils" />
<section id="parallel-i-o-crash-on-gpfs-with-latest-mpi-romio">
<h4>Parallel I/O crash on GPFS with latest MPI ROMIO<a class="headerlink" href="#parallel-i-o-crash-on-gpfs-with-latest-mpi-romio" title="Link to this heading"></a></h4>
<p>In some cases with large number of MPI processes when there is not
enough memory available on the compute node, the Abstract-Device
Interface for I/O (ADIO) driver can break with this error:</p>
<p>Out of memory
in file
../../../../../../../opensrc/ompi/ompi/mca/io/romio321/romio/adio/ad_gpfs/ad_gpfs_rdcoll.c,
line 1178</p>
<p>The solution is to declare in your submission script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">GPFSMPIO_COMM</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>This command will use non-blocking MPI calls and not MPI_Alltoallv for
exchange of data between the MPI I/O aggregators which requires
significant more amount of memory.</p>
<hr class="docutils" />
<p>The following issues were resolved
with the May 21, 2019 upgrade:</p>
</section>
<section id="g-flag-causes-internal-compiler-error-with-xl-compiler-resolved-may-21-2019">
<h4>-g flag causes internal compiler error with XL compiler (Resolved: May 21, 2019)<a class="headerlink" href="#g-flag-causes-internal-compiler-error-with-xl-compiler-resolved-may-21-2019" title="Link to this heading"></a></h4>
<p>Some users have reported an internal compiler error when compiling their
code with XL with the `-g` flag. This has been reported to IBM and
they are investigating.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This bug was fixed in xl/16.1.1-3</p>
</div>
</section>
<section id="issue-with-cuda-aware-mpi-with-1-resource-set-per-node-resolved-may-21-2019">
<h4>Issue with CUDA Aware MPI with &gt;1 resource set per node (Resolved: May 21, 2019)<a class="headerlink" href="#issue-with-cuda-aware-mpi-with-1-resource-set-per-node-resolved-may-21-2019" title="Link to this heading"></a></h4>
<p>Attempting to run an application with CUDA-aware MPI using more than one
resource set per node with produce the following error on each MPI rank:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">__SMPI_build_dir__________________________________________</span><span class="o">/</span><span class="n">ibmsrc</span><span class="o">/</span><span class="n">pami</span><span class="o">/</span><span class="n">ibm</span><span class="o">-</span><span class="n">pami</span><span class="o">/</span><span class="n">buildtools</span><span class="o">/</span><span class="n">pami_build_port</span><span class="o">/../</span><span class="n">pami</span><span class="o">/</span><span class="n">components</span><span class="o">/</span><span class="n">devices</span><span class="o">/</span><span class="n">ibvdevice</span><span class="o">/</span><span class="n">CudaIPCPool</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">300</span><span class="p">:</span>
<span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="n">Error</span> <span class="n">opening</span> <span class="n">IPC</span> <span class="n">Memhandle</span> <span class="kn">from</span> <span class="nn">peer</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">invalid</span> <span class="n">argument</span>
<span class="n">CUDA</span> <span class="n">level</span> <span class="n">IPC</span> <span class="n">failure</span><span class="p">:</span> <span class="n">this</span> <span class="n">has</span> <span class="n">been</span> <span class="n">observed</span> <span class="ow">in</span> <span class="n">environments</span> <span class="n">where</span> <span class="n">cgroups</span> <span class="n">separate</span> <span class="n">the</span> <span class="n">visible</span> <span class="n">GPUs</span> <span class="n">between</span> <span class="n">ranks</span><span class="o">.</span> <span class="n">The</span> <span class="n">option</span> <span class="o">-</span><span class="n">x</span> <span class="n">PAMI_DISABLE_IPC</span><span class="o">=</span><span class="mi">1</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">disable</span> <span class="n">CUDA</span> <span class="n">level</span> <span class="n">IPC</span><span class="o">.</span><span class="p">[:]</span> <span class="o">***</span> <span class="n">Process</span> <span class="n">received</span> <span class="n">signal</span> <span class="o">***</span>
</pre></div>
</div>
<p>Spectrum MPI relies on CUDA Inter-process Communication (CUDA IPC) to
provide fast on-node between GPUs. At present this capability cannot
function with more than one resource set per node.</p>
<ol class="arabic simple">
<li><p>Set the environment variable <code class="docutils literal notranslate"><span class="pre">PAMI_DISABLE_IPC=1</span></code> to force Spectrum
MPI to not use fast GPU Peer-to-peer communication. This option will
allow your code to run with more than one resource set per host, but
you may see slower GPU to GPU communication.</p></li>
<li><p>Run in a single resource set per host, i.e. with
<code class="docutils literal notranslate"><span class="pre">jsrun</span> <span class="pre">--gpu_per_rs</span> <span class="pre">6</span></code></p></li>
</ol>
<p>If on-node MPI communication between GPUs is critical to your
application performance, option B is recommended but youll need to set
the GPU affinity manually. This could be done with an API call in your
code (e.g. <code class="docutils literal notranslate"><span class="pre">cudaSetDevice</span></code>), or by using a wrapper script.</p>
</section>
<section id="simultaneous-backgrounded-jsruns-resolved-may-21-2019">
<h4>Simultaneous backgrounded jsruns (Resolved: May 21, 2019)<a class="headerlink" href="#simultaneous-backgrounded-jsruns-resolved-may-21-2019" title="Link to this heading"></a></h4>
<p>We have seen occasional errors from batch jobs with multiple
simultaneous backgrounded jsrun commands. Jobs may see pmix errors
during the noted failures.</p>
<hr class="docutils" />
<p>The following issue was resolved with the software default changes from
March 12, 2019 that set Spectrum MPI 10.2.0.11 (20190201) as default and
moved ROMIO to version 3.2.1:</p>
</section>
<section id="slow-performance-using-parallel-hdf5-resolved-march-12-2019">
<h4>Slow performance using parallel HDF5 (Resolved: March 12, 2019)<a class="headerlink" href="#slow-performance-using-parallel-hdf5-resolved-march-12-2019" title="Link to this heading"></a></h4>
<p>A performance issue has been identified using parallel HDF5 with the
default version of ROMIO provided in
<code class="docutils literal notranslate"><span class="pre">spectrum-mpi/10.2.0.10-20181214</span></code>. To fully take advantage of parallel
HDF5, users need to switch to the newer version of ROMIO and use ROMIO
hints. The following shows recommended variables and hints for a 2 node
job. Please note that hints must be tuned for a specific job.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ module unload darshan-runtime
$ export OMPI_MCA_io=romio321
$ export ROMIO_HINTS=./my_romio_hints
$ cat $ROMIO_HINTS
romio_cb_write enable
romio_ds_write enable
cb_buffer_size 16777216
cb_nodes 2
</pre></div>
</div>
</section>
<section id="job-hangs-in-mpi-finalize-resolved-march-12-2019">
<h4>Job hangs in MPI_Finalize (Resolved: March 12, 2019)<a class="headerlink" href="#job-hangs-in-mpi-finalize-resolved-march-12-2019" title="Link to this heading"></a></h4>
<p>There is a known issue in Spectrum MPI 10.2.0.10 provided by the
<code class="docutils literal notranslate"><span class="pre">spectrum-mpi/10.2.0.10-20181214</span></code> modulefile that causes a hang in
<code class="docutils literal notranslate"><span class="pre">MPI_Finalize</span></code> when ROMIO 3.2.1 is being used and the
<code class="docutils literal notranslate"><span class="pre">darshan-runtime</span></code> modulefile is loaded. The recommended and default
Spectrum MPI version as of March 3, 2019 is Spectrum MPI 10.2.0.11
provided by the <code class="docutils literal notranslate"><span class="pre">spectrum-mpi/10.2.0.11-20190201</span></code> modulefile. If you
are seeing this issue, please make sure that you are using the latest
version of Spectrum MPI. If you need to use a previous version of
Spectrum MPI, your options are:</p>
<ul class="simple">
<li><p>Unload the <code class="docutils literal notranslate"><span class="pre">darshan-runtime</span></code> modulefile.</p></li>
<li><p>Alternatively, set <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">OMPI_MCA_io=romio314</span></code> in your
environment to use the previous version of ROMIO. Please note that
this version has known performance issues with parallel HDF5 (see
Slow performance using parallel HDF5 issue below).</p></li>
</ul>
<hr class="docutils" />
<p>The following issues were resolved with the February 19, 2019 upgrade:</p>
</section>
<section id="job-step-cgroups-are-not-currently-supported-resolved-february-19-2019">
<h4>Job step cgroups are not currently supported (Resolved: February 19, 2019)<a class="headerlink" href="#job-step-cgroups-are-not-currently-supported-resolved-february-19-2019" title="Link to this heading"></a></h4>
<p>A regression was introduced in JSM 10.02.00.10rtm2 that prevents job
step cgroups from being created as a result, JSM, is defaulting to
setting <code class="docutils literal notranslate"><span class="pre">CUDA_VISIBLE_DEVICES</span></code> in order to allocate GPUs to specific
resource sets. Because of this issue, even if using <code class="docutils literal notranslate"><span class="pre">--gpu_per_rs</span> <span class="pre">0</span></code>
or <code class="docutils literal notranslate"><span class="pre">-g</span> <span class="pre">0</span></code>, every resource set in the step will be able to see all 6
GPUs in a node.</p>
</section>
<section id="jsm-stdio-options-do-not-create-files-resolved-february-19-2019">
<h4>JSM stdio options do not create files (Resolved: February 19, 2019)<a class="headerlink" href="#jsm-stdio-options-do-not-create-files-resolved-february-19-2019" title="Link to this heading"></a></h4>
<p>When using <code class="docutils literal notranslate"><span class="pre">--stdio_stdout</span></code> or <code class="docutils literal notranslate"><span class="pre">--stdio_stderr</span></code> users must use
absolute paths. Using relative paths (e.g. <code class="docutils literal notranslate"><span class="pre">./my_stdout</span></code>) will not
successfully create the file in the users current working directory. An
bug has been filed with IBM to fix this issue and allow relative paths.</p>
</section>
<section id="jsm-crash-when-using-different-number-of-resource-sets-per-host-resolved-february-19-2019">
<h4>JSM crash when using different number of resource sets per host (Resolved: February 19, 2019)<a class="headerlink" href="#jsm-crash-when-using-different-number-of-resource-sets-per-host-resolved-february-19-2019" title="Link to this heading"></a></h4>
<p>In some cases users will encounter a segmentation fault when running job
steps that have uneven number of resource sets per node. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ jsrun --nrs 41 -c 21 -a 1 --bind rs ./a.out
[a03n07:74208] *** Process received signal ***
[a03n07:74208] Signal: Segmentation fault (11)
[a03n07:74208] Signal code: Address not mapped (1)
[a03n07:74208] Failing at address: (nil)
...
</pre></div>
</div>
<p>As a workaround, two environment variables are set as default in the
user environment <code class="docutils literal notranslate"><span class="pre">PAMI_PMIX_USE_OLD_MAPCACHE=1</span></code> and
<code class="docutils literal notranslate"><span class="pre">OMPI_MCA_coll_ibm_xml_disable_cache=1</span></code>.</p>
</section>
</section>
<section id="cuda-10-1-known-issues">
<h3>CUDA 10.1 Known Issues<a class="headerlink" href="#cuda-10-1-known-issues" title="Link to this heading"></a></h3>
<section id="intermittent-failures-with-nvprof-identified-july-11-2019">
<h4>Intermittent failures with `nvprof` (Identified: July 11, 2019)<a class="headerlink" href="#intermittent-failures-with-nvprof-identified-july-11-2019" title="Link to this heading"></a></h4>
<p>We are seeing an intermittent issue that causes an error when
profiling a code using <cite>nvprof</cite> from CUDA 10.1.168. We have filed
a bug with NVIDIA (NV bug 2645669) and they have reproduced the
problem. An update will be posted when a fix becomes available.</p>
<p>When this issue is encountered, the profiler will exit with the
following error message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==</span><span class="mi">99756</span><span class="o">==</span> <span class="n">NVPROF</span> <span class="ow">is</span> <span class="n">profiling</span> <span class="n">process</span> <span class="mi">99756</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
<span class="o">==</span><span class="mi">99756</span><span class="o">==</span> <span class="n">Error</span><span class="p">:</span> <span class="n">Internal</span> <span class="n">profiling</span> <span class="n">error</span> <span class="mi">4306</span><span class="p">:</span><span class="mf">999.</span>
<span class="o">========</span> <span class="n">Profiling</span> <span class="n">result</span><span class="p">:</span>
<span class="o">========</span> <span class="n">Metric</span> <span class="n">result</span><span class="p">:</span>
</pre></div>
</div>
</section>
<section id="mpi-annotation-may-cause-segfaults-with-applications-using-mpi-init-thread">
<h4>MPI annotation may cause segfaults with applications using MPI_Init_thread<a class="headerlink" href="#mpi-annotation-may-cause-segfaults-with-applications-using-mpi-init-thread" title="Link to this heading"></a></h4>
<p>Users on Summit can have MPI calls automatically annotated in <code class="docutils literal notranslate"><span class="pre">nvprof</span></code>
timelines using the <code class="docutils literal notranslate"><span class="pre">nvprof</span> <span class="pre">--annotate-mpi</span> <span class="pre">openmpi</span></code> option. If the
user calls <code class="docutils literal notranslate"><span class="pre">MPI_Init_thread</span></code> instead of <code class="docutils literal notranslate"><span class="pre">MPI_Init</span></code>, <code class="docutils literal notranslate"><span class="pre">nvprof</span></code> may
segfault, as <code class="docutils literal notranslate"><span class="pre">MPI_Init_thread</span></code> is currently not being wrapped by
<code class="docutils literal notranslate"><span class="pre">nvprof</span></code>. The current alternative is to build and follow the
instructions from
<a class="reference external" href="https://github.com/NVIDIA/cuda-profiler/tree/mpi_init_thread" target="_blank">https://github.com/NVIDIA/cuda-profiler/tree/mpi_init_thread</a>.</p>
</section>
<section id="cudamemadvise-before-context-creation-leads-to-a-kernel-panic">
<h4>cudaMemAdvise before context creation leads to a kernel panic<a class="headerlink" href="#cudamemadvise-before-context-creation-leads-to-a-kernel-panic" title="Link to this heading"></a></h4>
<p>There is a (very rare) driver bug involving cudaManagedMemory that can
cause a kernel panic. If you encounter this bug, please contact the
<a class="reference external" href="mailto:help&#37;&#52;&#48;olcf&#46;ornl&#46;gov" target="_blank">OLCF User Support</a> team. The easiest
mitigation is for the user code to initialize a context on every GPU
with which it intends to interact (for example by calling
<code class="docutils literal notranslate"><span class="pre">cudaFree(0)</span></code> while each device is active).</p>
</section>
<section id="some-uses-of-thrust-complex-vectors-fail-at-compile-time-with-warnings-of-identifiers-being-undefined-in-device-code">
<h4>Some uses of Thrust complex vectors fail at compile time with warnings of identifiers being <code class="docutils literal notranslate"><span class="pre">undefined</span> <span class="pre">in</span> <span class="pre">device</span> <span class="pre">code</span></code><a class="headerlink" href="#some-uses-of-thrust-complex-vectors-fail-at-compile-time-with-warnings-of-identifiers-being-undefined-in-device-code" title="Link to this heading"></a></h4>
<p>This issue comes from the fact that <code class="docutils literal notranslate"><span class="pre">std::complex</span></code> is not
<code class="docutils literal notranslate"><span class="pre">__host__</span></code>/<code class="docutils literal notranslate"><span class="pre">__device__</span></code> annotated, so all its functions are
implicitly <code class="docutils literal notranslate"><span class="pre">__host__</span></code>. There is a mostly simple workaround, assuming
this is compiled as C++11: in <code class="docutils literal notranslate"><span class="pre">complex.h</span></code> and <code class="docutils literal notranslate"><span class="pre">complex.inl</span></code>,
annotate the functions that deal with <code class="docutils literal notranslate"><span class="pre">std::complex</span></code> as
<code class="docutils literal notranslate"><span class="pre">__host__</span> <span class="pre">__device__</span></code> (they are the ones that are annotated only as
<code class="docutils literal notranslate"><span class="pre">__host__</span></code> right now), and then compile with
<code class="docutils literal notranslate"><span class="pre">--expt-relaxed-constexpr</span></code>.</p>
<p>Users that encounter this issue, can use
the following workaround. copy the entirety of
<code class="docutils literal notranslate"><span class="pre">${OLCF_CUDA_ROOT}/include/thrust</span></code> to a private location, make the
above edits to <code class="docutils literal notranslate"><span class="pre">thrust/complex.h</span></code> and
<code class="docutils literal notranslate"><span class="pre">thrust/detail/complex/complex.inl</span></code>, and then add that to your include
path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ nvcc -ccbin=g++ --expt-relaxed-constexpr assignment.cu -I./
</pre></div>
</div>
<p>A permanent fix of this issue is expected in the version of Thrust
packed with CUDA 10.1 update 1</p>
</section>
<section id="breakpoints-in-cuda-kernels-recommendation">
<h4>Breakpoints in CUDA kernels recommendation<a class="headerlink" href="#breakpoints-in-cuda-kernels-recommendation" title="Link to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">cuda-gdb</span></code> allows for breakpoints to be set inside CUDA kernels to
inspect the program state on the GPU. This can be a valuable debugging
tool but breaking inside kernels does incur significant overhead that
should be included in your expected runtime.</p>
<p>The time required to hit a breakpoint inside a CUDA kernel depends on
how many CUDA threads are used to execute the kernel. It may take
several seconds to stop at kernel breakpoints for very large numbers
of threads. For this reason, it is recommended to choose breakpoints
judiciously, especially when running the debugger in batch or
offline mode where this overhead may be misperceived as the code
hanging. If possible, debugging a smaller problem size with fewer
active threads can be more pleasant.</p>
<hr class="docutils" />
</section>
</section>
</section>
<section id="scalable-protected-infrastructure-spi">
<span id="scalable-protected-infrastructure"></span><h2>Scalable Protected Infrastructure (SPI)<a class="headerlink" href="#scalable-protected-infrastructure-spi" title="Link to this heading"></a></h2>
<p>The OLCFs Scalable Protected Infrastructure (SPI) provides resources and protocols that enable researchers to process protected data at scale. The SPI is built around a framework of security protocols that allows researchers to process large datasets containing private information. Using this framework researchers can use the centers large HPC resources to compute data containing protected health information (PHI), personally identifiable information (PII), data protected under International Traffic in Arms Regulations, and other types of data that require privacy.</p>
<p>The SPI utilizes a mixture of existing resources combined with specialized resources targeted at SPI workloads. Because of this, many processes used within the SPI are very similar to those used for standard non-SPI. This page lists the differences you may see when using OLCF resources to execute SPI resources.</p>
<p>The SPI provides access to the OLCFs Summit resource for compute.  To safely separate SPI and non-SPI workflows, SPI workflows must use a separate login node named <a class="reference internal" href="../spi/index.html#spi-compute-citadel"><span class="std std-ref">Citadel</span></a>. Because Citadel is largely a front end for Summit, you can use the Summit documentation when using Citadel. The <a class="reference internal" href="../spi/index.html#spi-compute-citadel"><span class="std std-ref">SPI</span></a> page can be used to see notable differences when using the Citadel resource.</p>
<hr class="docutils" />
</section>
<section id="training-system-ascent">
<span id="id26"></span><h2>Training System (Ascent)<a class="headerlink" href="#training-system-ascent" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ascent is a training system that is not intended to be used as
an OLCF user resource. Access to the system is only obtained through
OLCF training events.</p>
</div>
<p>Ascent is an 18-node stand-alone system with the same architecture as
Summit (see <a class="reference internal" href="#summit-nodes"><span class="std std-ref">Summit Nodes</span></a> section above), so most of this Summit User Guide can be referenced for
Ascent as well. However, aside from the number of compute nodes, there
are other differences between the two systems. Most notably, Ascent sits
in the NCCS Open Security Enclave, which is subject to fewer
restrictions than the Moderate Security Enclave that systems such as
Summit belong to. This means that participants in OLCF training events
can go through a streamlined version of the approval process before
gaining access to the system. The remainder of this section of the user
guide describes Ascent-specific information intended for participants
of OLCF training events.</p>
<section id="id27">
<h3>File Systems<a class="headerlink" href="#id27" title="Link to this heading"></a></h3>
<p>It is important to note that because Ascent sits in the NCCS Open
Security Enclave, it also mounts different file systems than Summit.
These file systems provide both user-affiliated and project-affiliated
storage areas for each user.</p>
<section id="nfs-directories">
<h4>NFS Directories<a class="headerlink" href="#nfs-directories" title="Link to this heading"></a></h4>
<p>Upon logging into Ascent, users will be placed in their own personal
home (NFS) directory, <code class="docutils literal notranslate"><span class="pre">/ccsopen/home/[userid]</span></code>, which can only be
accessed by that user. Users also have access to an NFS project
directory, <code class="docutils literal notranslate"><span class="pre">/ccsopen/proj/[projid]</span></code>, which is visible to all members
of a project. Both of these NFS directories are commonly used to store
source code and build applications.</p>
</section>
<section id="gpfs-directories">
<h4>GPFS Directories<a class="headerlink" href="#gpfs-directories" title="Link to this heading"></a></h4>
<p>Users also have access to a (GPFS) parallel file system, called wolf,
which is where data should be written when running on Ascents compute
nodes. Under <code class="docutils literal notranslate"><span class="pre">/gpfs/wolf/[projid]</span></code>, there are 3 directories:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls /gpfs/wolf/[projid]
proj-shared  scratch  world-shared
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proj-shared</span></code> can be accessed by all members of a project.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scratch</span></code> contains directories for each user of a project and only
that user can access their own directory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">world-shared</span></code> can be accessed by any users on the system in any
project.</p></li>
</ul>
</section>
</section>
<section id="obtaining-access-to-ascent">
<h3>Obtaining Access to Ascent<a class="headerlink" href="#obtaining-access-to-ascent" title="Link to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ascent is a training system that is not intended to be used as
an OLCF user resource. Access to the system is only obtained through
OLCF training events.</p>
</div>
<p>This sub-section describes the process of obtaining access to Ascent for
an OLCF training event. Please follow the steps below to request access.</p>
<section id="step-1-go-to-the-myolcf-account-application-form">
<h4>Step 1: Go to the <a class="reference external" href="https://my.olcf.ornl.gov/account-application-new" target="_blank">myOLCF Account Application Form</a><a class="headerlink" href="#step-1-go-to-the-myolcf-account-application-form" title="Link to this heading"></a></h4>
<ol class="arabic simple">
<li><p>Once on the form, linked above, fill in the project ID in the Enter the Project ID of the project you wish to join field and click Next.</p></li>
</ol>
<img alt="../_images/ascent_start.png" class="align-center" src="../_images/ascent_start.png" />
<ol class="arabic simple" start="2">
<li><p>After you enter the Project ID, use the sliders to select Yes for OLCF as the Project Organization and select Yes for Open as the Security Enclave.</p></li>
</ol>
<img alt="../_images/ascent_start2.png" class="align-center" src="../_images/ascent_start2.png" />
<ol class="arabic simple" start="3">
<li><p>The next screen will show you some information about the project, you dont need to change anything, just click Next.</p></li>
<li><p>Fill in your personal information and then click Next.</p></li>
<li><p>Fill in your shipping information and then click Next.</p></li>
<li><p>Fill in your Employment/Institution Information. If you are student please use your school affiliation for both Employer and Funding Source. If you are a student and you do not see your school listed, choose other for both Employer and Funding Source and then manually enter your school affiliation in the adjacent fields.  Click Next when you are done.</p></li>
<li><p>On the Project information screen fill the Proposed Contribution to Project with Participating in OLCF training. Leave all the questions about the project set to no and click Next.</p></li>
</ol>
<img alt="../_images/ascent_project.png" class="align-center" src="../_images/ascent_project.png" />
<ol class="arabic simple" start="8">
<li><p>On the user account page, selected yes or no for the questions asking about any pre-existing account names. If this is your first account with us, leave those questions set to no. Also enter your preferred shell. If you do not know which shell to use, select /bin/bash. We can change this later if needed. Click Next.</p></li>
<li><p>On the Policies &amp; Agreements page click the links to read the polices and then answer Yes to affirm you have read each. Certify your application by selecting Yes as well. Then Click Submit.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After submitting your application, it will need to pass
through the approval process. Depending on when you submit, approval
might not occur until the next business day.</p>
</div>
</section>
<section id="step-2-set-your-xcams-ucams-password">
<h4>Step 2: Set Your XCAMS/UCAMS Password<a class="headerlink" href="#step-2-set-your-xcams-ucams-password" title="Link to this heading"></a></h4>
<p>Once approved, if you are a new user, your account will be created and
an email will be sent asking you to set up a password. If you already
had an XCAMS/UCAMS account, you will not be sent the email asking you to
setup a new password (simply use your existing credentials). Once
passwords are known, users can log in to Ascent using their XCAMS/UCAMS
username and password (see the next section)</p>
</section>
</section>
<section id="logging-in-to-ascent">
<h3>Logging In to Ascent<a class="headerlink" href="#logging-in-to-ascent" title="Link to this heading"></a></h3>
<p>To log in to Ascent, please use your XCAMS/UCAMS username and password:</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">ssh</span> <span class="pre">USERNAME&#64;login1.ascent.olcf.ornl.gov</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You do not need to use an RSA token to log in to Ascent.
Please use your XCAMS/UCAMS username and password (which is different
from the username and PIN + RSA token code used to log in to other OLCF
systems such as Summit).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It will take ~5 minutes for your directories to be created, so
if your account was just created and you log in and you do not have a
home directory, this is likely the reason.</p>
</div>
</section>
</section>
<section id="preparing-for-frontier">
<h2>Preparing For Frontier<a class="headerlink" href="#preparing-for-frontier" title="Link to this heading"></a></h2>
<p>This section of the Summit User Guide is intended to show current OLCF
users how to start preparing their applications to run on the upcoming
Frontier system. We will continue to add more topics to this section in
the coming months. Please see the topics below to get started.</p>
<section id="hip">
<h3>HIP<a class="headerlink" href="#hip" title="Link to this heading"></a></h3>
<p>HIP (Heterogeneous-Compute Interface for Portability) is a C++ runtime
API that allows developers to write portable code to run on AMD and NVIDIA
GPUs. It is an interface that uses the underlying Radeon Open Compute (ROCm)
or CUDA platform that is installed on a system. The API is similar to CUDA
so porting existing codes from CUDA to HIP should be fairly straightforward
in most cases. In addition, HIP provides porting tools which can be used to
help port CUDA codes to the HIP layer, with no overhead compared to the
original CUDA application. HIP is not intended to be a drop-in replacement
for CUDA, so some manual coding and performance tuning work should be
expected to complete the port.</p>
<p>Key features include:</p>
<ul class="simple">
<li><p>HIP is a thin layer and has little or no performance impact over
coding directly in CUDA.</p></li>
<li><p>HIP allows coding in a single-source C++ programming language including
features such as templates, C++11 lambdas, classes, namespaces, and more.</p></li>
<li><p>The hipify tools automatically convert source from CUDA to HIP.</p></li>
<li><p>Developers can specialize for the platform (CUDA or HIP) to tune for
performance or handle tricky cases.</p></li>
</ul>
</section>
<section id="using-hip-on-summit">
<h3>Using HIP on Summit<a class="headerlink" href="#using-hip-on-summit" title="Link to this heading"></a></h3>
<p>As mentioned above, HIP can be used on systems running on either the ROCm
or CUDA platform, so OLCF users can start preparing their applications for
Frontier today on Summit. To use HIP on Summit, you must load the HIP module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ module load hip-cuda
</pre></div>
</div>
<p>CUDA 11.4.0 or later must be loaded in order to load the hip-cuda module.
hipBLAS, hipFFT, hipSOLVER, hipSPARSE, and hipRAND have also been added
to hip-cuda.</p>
</section>
<section id="learning-to-program-with-hip">
<h3>Learning to Program with HIP<a class="headerlink" href="#learning-to-program-with-hip" title="Link to this heading"></a></h3>
<p>The HIP API is very similar to CUDA, so if you are already familiar with
using CUDA, the transition to using HIP should be fairly straightforward.
Whether you are already familiar with CUDA or not, the best place to start
learning about HIP is this Introduction to HIP webinar that was recently
given by AMD:</p>
<ul class="simple">
<li><p><strong>Introduction to AMD GPU Programming with HIP</strong>:
(<a class="reference external" href="https://www.exascaleproject.org/wp-content/uploads/2017/05/ORNL_HIP_webinar_20190606_final.pdf" target="_blank">slides</a> | <a class="reference external" href="https://youtu.be/3ZXbRJVvgJs" target="_blank">recording</a>)</p></li>
</ul>
<p>More useful resources, provided by AMD, can be found here:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://rocm-documentation.readthedocs.io/en/latest/Programming_Guides/HIP-GUIDE.html" target="_blank">HIP Programming Guide</a></p></li>
<li><p><a class="reference external" href="https://rocm-documentation.readthedocs.io/en/latest/ROCm_API_References/HIP-API.html" target="_blank">HIP API Documentation</a></p></li>
<li><p><a class="reference external" href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/docs/markdown/hip_porting_guide.md" target="_blank">HIP Porting Guide</a></p></li>
</ul>
<p>The OLCF is currently adding some simple HIP tutorials here as well:</p>
<ul class="simple">
<li><p>OLCF Tutorials  <a class="reference external" href="https://github.com/olcf-tutorials/simple_HIP_examples" target="_blank">Simple HIP Examples</a></p></li>
</ul>
</section>
<section id="previous-frontier-training-events">
<h3>Previous Frontier Training Events<a class="headerlink" href="#previous-frontier-training-events" title="Link to this heading"></a></h3>
<p>The links below point to event pages from previous Frontier training events. Under the Presentations tab on each event page, you will find the presentations given during the event.</p>
<p><a class="reference external" href="https://www.olcf.ornl.gov/frontier-application-readiness-kick-off-workshop/" target="_blank">Frontier Application Readiness Kick-Off Workshop (October 2019)</a></p>
<p>Please check back to this section regularly as we will continue
to add new content for our users.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="frontier_user_guide.html" class="btn btn-neutral float-left" title="Frontier User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="citadel_user_guide.html" class="btn btn-neutral float-right" title="Citadel User Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, OLCF.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  



</body>
</html>